/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/
(function(){
var e=["require","exports","vs/base/common/lifecycle","vs/base/common/path","vs/platform/instantiation/common/instantiation","vs/nls!vs/code/node/cliProcessMain","vs/nls","vs/platform/log/common/log","vs/base/common/types","vs/base/common/network","vs/base/node/pfs","vs/base/common/event","vs/base/common/async","vs/base/common/uri","vs/base/common/platform","vs/base/common/buffer","vs/base/common/strings","vs/base/common/objects","vs/base/common/arrays","vs/platform/environment/common/environment","vs/base/common/errors","vs/base/common/resources","vs/platform/registry/common/platform","fs","vs/platform/extensionManagement/common/extensionManagement","vs/platform/extensionManagement/common/extensionManagementUtil","vs/platform/files/common/files","vs/platform/configuration/common/configuration","vs/base/common/cancellation","vs/platform/configuration/common/configurationRegistry","vs/base/common/stream","vs/base/parts/ipc/common/ipc","vs/base/common/errorMessage","child_process","vs/platform/extensions/common/extensions","vs/base/common/uuid","vs/platform/product/common/productService","vs/platform/telemetry/common/telemetry","vs/base/node/zip","vs/base/common/labels","vs/base/node/decoder","util","vs/base/parts/ipc/node/ipc.cp","vs/platform/extensions/common/extensionValidator","vs/platform/instantiation/common/descriptors","vs/platform/files/common/io","vs/platform/files/node/watcher/watcher","vs/platform/instantiation/common/serviceCollection","semver-umd","vs/platform/product/common/product","vs/platform/request/common/request","vs/platform/telemetry/common/telemetryUtils","vs/platform/extensionManagement/node/extensionManagementUtil","vs/base/common/assert","vs/base/common/decorators","vs/base/common/json","vs/base/common/console","vs/base/common/marshalling","vs/base/node/paths","vs/base/node/extpath","vs/base/node/watcher","vs/nls!vs/base/common/date","vs/base/common/date","vs/nls!vs/base/common/errorMessage","vs/nls!vs/base/node/processes","vs/base/node/processes","vs/base/common/extpath","vs/nls!vs/base/node/zip","vs/nls!vs/platform/configuration/common/configurationRegistry","vs/nls!vs/platform/extensionManagement/common/extensionManagement","vs/nls!vs/platform/extensionManagement/node/extensionManagementService","vs/nls!vs/platform/extensionManagement/node/extensionManagementUtil","vs/nls!vs/platform/extensionManagement/node/extensionsScanner","vs/nls!vs/platform/extensions/common/extensionValidator","vs/nls!vs/platform/files/common/fileService","vs/nls!vs/platform/files/common/io","vs/nls!vs/platform/files/node/diskFileSystemProvider","vs/nls!vs/platform/request/common/request","vs/nls!vs/platform/telemetry/common/telemetryService","vs/platform/extensionManagement/common/extensionNls","vs/platform/files/node/watcher/nsfw/watcherService","vs/platform/files/node/watcher/unix/watcherService","vs/platform/files/node/watcher/win32/csharpWatcherService","vs/platform/files/node/watcher/win32/watcherService","vs/platform/instantiation/common/graph","vs/platform/download/common/download","vs/platform/extensionManagement/node/extensionsManifestCache","vs/platform/files/node/watcher/nodejs/watcherService","vs/platform/instantiation/common/instantiationService","vs/platform/localizations/common/localizations","vs/platform/extensionManagement/node/extensionDownloader","vs/platform/extensionManagement/node/extensionLifecycle","vs/platform/files/common/fileService","vs/base/common/map","vs/platform/files/node/diskFileSystemProvider","vs/platform/localizations/node/localizations","crypto","vs/platform/log/node/spdlogService","vs/platform/environment/node/environmentService","os","vs/platform/jsonschemas/common/jsonContributionRegistry","vs/platform/configuration/common/configurationModels","vs/platform/configuration/common/configurationService","vs/platform/request/node/proxy","url","vs/platform/serviceMachineId/common/serviceMachineId","vs/platform/state/node/state","vs/platform/state/node/stateService","vs/platform/storage/common/storage","vs/platform/extensionManagement/common/extensionGalleryService","vs/platform/telemetry/common/telemetryService","vs/platform/telemetry/node/appInsightsAppender","vs/platform/telemetry/node/commonProperties","vs/platform/telemetry/node/telemetry","vs/platform/extensionManagement/node/extensionsScanner","vs/platform/extensionManagement/node/extensionManagementService","vs/platform/request/node/requestService","string_decoder","vs/base/common/normalization","vs/base/common/glob","vs/base/common/iterator","applicationinsights","yauzl","yazl","zlib","vs/code/node/cliProcessMain"],t=function(t){
for(var i=[],n=0,r=t.length;n<r;n++)i[n]=e[t[n]];return i};define(e[53],t([0,1]),(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ok=void 0,t.ok=function(e,t){if(!e)throw new Error(t?`Assertion failed (${t})`:"Assertion Failed")}})),define(e[54],t([0,1]),(function(e,t){"use strict";function i(e){return(t,i,n)=>{let r=null,s=null;if("function"==typeof n.value?(r="value",s=n.value):"function"==typeof n.get&&(r="get",s=n.get),!s)throw new Error("not supported");n[r]=e(s,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=t.debounce=t.memoize=t.createMemoizer=t.createDecorator=void 0,t.createDecorator=i;let n=0;function r(){const e=`$memoize${n++}`;let t=void 0;const i=function(i,n,r){let s=null,o=null;if("function"==typeof r.value?(s="value",0!==(o=r.value).length&&console.warn("Memoize should only be used in functions with zero parameters")):"function"==typeof r.get&&(s="get",o=r.get),!o)throw new Error("not supported");const a=`${e}:${n}`;r[s]=function(...e){
return t=this,this.hasOwnProperty(a)||Object.defineProperty(this,a,{configurable:!0,enumerable:!1,writable:!0,value:o.apply(this,e)}),this[a]}};return i.clear=()=>{void 0!==t&&Object.getOwnPropertyNames(t).forEach(i=>{0===i.indexOf(e)&&delete t[i]})},i}t.createMemoizer=r,t.memoize=function(e,t,i){return r()(e,t,i)},t.debounce=function(e,t,n){return i((i,r)=>{const s=`$debounce$${r}`,o=`$debounce$result$${r}`;return function(...r){this[o]||(this[o]=n?n():void 0),clearTimeout(this[s]),t&&(this[o]=t(this[o],...r),r=[this[o]]),this[s]=setTimeout(()=>{i.apply(this,r),this[o]=n?n():void 0},e)}})},t.throttle=function(e,t,n){return i((i,r)=>{const s=`$throttle$timer$${r}`,o=`$throttle$result$${r}`,a=`$throttle$lastRun$${r}`,l=`$throttle$pending$${r}`;return function(...r){if(this[o]||(this[o]=n?n():void 0),null!==this[a]&&void 0!==this[a]||(this[a]=-Number.MAX_VALUE),t&&(this[o]=t(this[o],...r)),this[l])return;const c=this[a]+e;c<=Date.now()?(this[a]=Date.now(),i.apply(this,[this[o]]),
this[o]=n?n():void 0):(this[l]=!0,this[s]=setTimeout(()=>{this[l]=!1,this[a]=Date.now(),i.apply(this,[this[o]]),this[o]=n?n():void 0},c-Date.now()))}})}})),define(e[18],t([0,1,20]),(function(e,t,i){"use strict";function n(e,t){let i=0,n=e.length;if(0===n)return 0;for(;i<n;){const r=Math.floor((i+n)/2);t(e[r])?n=r:i=r+1}return i}function r(e,t){return function e(t,i,n,r,s){if(r<=n)return;const o=n+(r-n)/2|0;e(t,i,n,o,s);e(t,i,o+1,r,s);if(i(t[o],t[o+1])<=0)return;!function(e,t,i,n,r,s){let o=i,a=n+1;for(let t=i;t<=r;t++)s[t]=e[t];for(let l=i;l<=r;l++)o>n?e[l]=s[a++]:a>r?e[l]=s[o++]:t(s[a],s[o])<0?e[l]=s[a++]:e[l]=s[o++]}(t,i,n,o,r,s)}(e,t,0,e.length-1,[]),e}function s(e,t,i){const n=[];function r(e,t,i){if(0===t&&0===i.length)return;const r=n[n.length-1];r&&r.start+r.deleteCount===e?(r.deleteCount+=t,r.toInsert.push(...i)):n.push({start:e,deleteCount:t,toInsert:i})}let s=0,o=0;for(;;){if(s===e.length){r(s,0,t.slice(o));break}if(o===t.length){r(s,e.length-s,[]);break}const n=e[s],a=t[o],l=i(n,a);0===l?(s+=1,
o+=1):l<0?(r(s,1,[]),s+=1):l>0&&(r(s,0,[a]),o+=1)}return n}function o(e,t,i,r,s){for(const o=i.length;r<s;r++){const s=e[r];if(t(s,i[o-1])<0){i.pop();const e=n(i,e=>t(s,e)<0);i.splice(e,0,s)}}}function a(e,t){const i=e.indexOf(t);if(i>-1)return e.splice(i,1),t}Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomElement=t.asArray=t.mapArrayOrNot=t.pushToEnd=t.pushToStart=t.shuffle=t.arrayInsert=t.remove=t.insert=t.index=t.range=t.flatten=t.commonPrefixLength=t.firstOrDefault=t.lastIndex=t.uniqueFilter=t.distinctES6=t.distinct=t.isNonEmptyArray=t.isFalsyOrEmpty=t.move=t.coalesceInPlace=t.coalesce=t.topAsync=t.top=t.delta=t.sortedDiff=t.groupBy=t.mergeSort=t.findFirstInSorted=t.binarySearch=t.equals=t.tail2=t.tail=void 0,t.tail=function(e,t=0){return e[e.length-(1+t)]},t.tail2=function(e){if(0===e.length)throw new Error("Invalid tail call");return[e.slice(0,e.length-1),e[e.length-1]]},t.equals=function(e,t,i=((e,t)=>e===t)){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1
;for(let n=0,r=e.length;n<r;n++)if(!i(e[n],t[n]))return!1;return!0},t.binarySearch=function(e,t,i){let n=0,r=e.length-1;for(;n<=r;){const s=(n+r)/2|0,o=i(e[s],t);if(o<0)n=s+1;else{if(!(o>0))return s;r=s-1}}return-(n+1)},t.findFirstInSorted=n,t.mergeSort=r,t.groupBy=function(e,t){const i=[];let n=void 0;for(const s of r(e.slice(0),t))n&&0===t(n[0],s)?n.push(s):(n=[s],i.push(n));return i},t.sortedDiff=s,t.delta=function(e,t,i){const n=s(e,t,i),r=[],o=[];for(const t of n)r.push(...e.slice(t.start,t.start+t.deleteCount)),o.push(...t.toInsert);return{removed:r,added:o}},t.top=function(e,t,i){if(0===i)return[];const n=e.slice(0,i).sort(t);return o(e,t,n,i,e.length),n},t.topAsync=function(e,t,n,r,s){return 0===n?Promise.resolve([]):new Promise((a,l)=>{(async()=>{const a=e.length,l=e.slice(0,n).sort(t);for(let c=n,u=Math.min(n+r,a);c<a;c=u,u=Math.min(u+r,a)){if(c>n&&await new Promise(e=>setTimeout(e)),s&&s.isCancellationRequested)throw i.canceled();o(e,t,l,c,u)}return l})().then(a,l)})},t.coalesce=function(e){
return e.filter(e=>!!e)},t.coalesceInPlace=function(e){let t=0;for(let i=0;i<e.length;i++)e[i]&&(e[t]=e[i],t+=1);e.length=t},t.move=function(e,t,i){e.splice(i,0,e.splice(t,1)[0])},t.isFalsyOrEmpty=function(e){return!Array.isArray(e)||0===e.length},t.isNonEmptyArray=function(e){return Array.isArray(e)&&e.length>0},t.distinct=function(e,t){if(!t)return e.filter((t,i)=>e.indexOf(t)===i);const i=Object.create(null);return e.filter(e=>{const n=t(e);return!i[n]&&(i[n]=!0,!0)})},t.distinctES6=function(e){const t=new Set;return e.filter(e=>!t.has(e)&&(t.add(e),!0))},t.uniqueFilter=function(e){const t=Object.create(null);return i=>{const n=e(i);return!t[n]&&(t[n]=!0,!0)}},t.lastIndex=function(e,t){for(let i=e.length-1;i>=0;i--){if(t(e[i]))return i}return-1},t.firstOrDefault=function(e,t){return e.length>0?e[0]:t},t.commonPrefixLength=function(e,t,i=((e,t)=>e===t)){let n=0;for(let r=0,s=Math.min(e.length,t.length);r<s&&i(e[r],t[r]);r++)n++;return n},t.flatten=function(e){return[].concat(...e)},t.range=function(e,t){
let i="number"==typeof t?e:0;"number"==typeof t?i=e:(i=0,t=e);const n=[];if(i<=t)for(let e=i;e<t;e++)n.push(e);else for(let e=i;e>t;e--)n.push(e);return n},t.index=function(e,t,i){return e.reduce((e,n)=>(e[t(n)]=i?i(n):n,e),Object.create(null))},t.insert=function(e,t){return e.push(t),()=>a(e,t)},t.remove=a,t.arrayInsert=function(e,t,i){const n=e.slice(0,t),r=e.slice(t);return n.concat(i,r)},t.shuffle=function(e,t){let i;if("number"==typeof t){let e=t;i=()=>{const t=179426549*Math.sin(e++);return t-Math.floor(t)}}else i=Math.random;for(let t=e.length-1;t>0;t-=1){const n=Math.floor(i()*(t+1)),r=e[t];e[t]=e[n],e[n]=r}},t.pushToStart=function(e,t){const i=e.indexOf(t);i>-1&&(e.splice(i,1),e.unshift(t))},t.pushToEnd=function(e,t){const i=e.indexOf(t);i>-1&&(e.splice(i,1),e.push(t))},t.mapArrayOrNot=function(e,t){return Array.isArray(e)?e.map(t):t(e)},t.asArray=function(e){return Array.isArray(e)?e:[e]},t.getRandomElement=function(e){return e[Math.floor(Math.random()*e.length)]}})),
define(e[55],t([0,1]),(function(e,t){"use strict";var i,n;function r(e,t=!1){let i=0,n=e.length,r="",l=0,c=16,u=0;function d(t){let n=0,r=0;for(;n<t;){const t=e.charCodeAt(i);if(t>=48&&t<=57)r=16*r+t-48;else if(t>=65&&t<=70)r=16*r+t-65+10;else{if(!(t>=97&&t<=102))break;r=16*r+t-97+10}i++,n++}return n<t&&(r=-1),r}function h(){if(r="",u=0,l=i,i>=n)return l=n,c=17;let t=e.charCodeAt(i);if(s(t)){do{i++,r+=String.fromCharCode(t),t=e.charCodeAt(i)}while(s(t));return c=15}if(o(t))return i++,r+=String.fromCharCode(t),13===t&&10===e.charCodeAt(i)&&(i++,r+="\n"),c=14;switch(t){case 123:return i++,c=1;case 125:return i++,c=2;case 91:return i++,c=3;case 93:return i++,c=4;case 58:return i++,c=6;case 44:return i++,c=5;case 34:return i++,r=function(){let t="",r=i;for(;;){if(i>=n){t+=e.substring(r,i),u=2;break}const s=e.charCodeAt(i);if(34===s){t+=e.substring(r,i),i++;break}if(92!==s){if(s>=0&&s<=31){if(o(s)){t+=e.substring(r,i),u=2;break}u=6}i++}else{if(t+=e.substring(r,i),++i>=n){u=2;break}switch(e.charCodeAt(i++)){
case 34:t+='"';break;case 92:t+="\\";break;case 47:t+="/";break;case 98:t+="\b";break;case 102:t+="\f";break;case 110:t+="\n";break;case 114:t+="\r";break;case 116:t+="\t";break;case 117:const e=d(4);e>=0?t+=String.fromCharCode(e):u=4;break;default:u=5}r=i}}return t}(),c=10;case 47:const s=i-1;if(47===e.charCodeAt(i+1)){for(i+=2;i<n&&!o(e.charCodeAt(i));)i++;return r=e.substring(s,i),c=12}if(42===e.charCodeAt(i+1)){i+=2;const t=n-1;let o=!1;for(;i<t;){if(42===e.charCodeAt(i)&&47===e.charCodeAt(i+1)){i+=2,o=!0;break}i++}return o||(i++,u=1),r=e.substring(s,i),c=13}return r+=String.fromCharCode(t),i++,c=16;case 45:if(r+=String.fromCharCode(t),++i===n||!a(e.charCodeAt(i)))return c=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return r+=function(){const t=i;if(48===e.charCodeAt(i))i++;else for(i++;i<e.length&&a(e.charCodeAt(i));)i++;if(i<e.length&&46===e.charCodeAt(i)){if(!(++i<e.length&&a(e.charCodeAt(i))))return u=3,e.substring(t,i);for(i++;i<e.length&&a(e.charCodeAt(i));)i++
}let n=i;if(i<e.length&&(69===e.charCodeAt(i)||101===e.charCodeAt(i)))if((++i<e.length&&43===e.charCodeAt(i)||45===e.charCodeAt(i))&&i++,i<e.length&&a(e.charCodeAt(i))){for(i++;i<e.length&&a(e.charCodeAt(i));)i++;n=i}else u=3;return e.substring(t,n)}(),c=11;default:for(;i<n&&f(t);)i++,t=e.charCodeAt(i);if(l!==i){switch(r=e.substring(l,i)){case"true":return c=8;case"false":return c=9;case"null":return c=7}return c=16}return r+=String.fromCharCode(t),i++,c=16}}function f(e){if(s(e)||o(e))return!1;switch(e){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}return{setPosition:function(e){i=e,r="",l=0,c=16,u=0},getPosition:()=>i,scan:t?function(){let e;do{e=h()}while(e>=12&&e<=15);return e}:h,getToken:()=>c,getTokenValue:()=>r,getTokenOffset:()=>l,getTokenLength:()=>i-l,getTokenError:()=>u}}function s(e){return 32===e||9===e||11===e||12===e||160===e||5760===e||e>=8192&&e<=8203||8239===e||8287===e||12288===e||65279===e}function o(e){return 10===e||13===e||8232===e||8233===e}
function a(e){return e>=48&&e<=57}function l(e,t,i=!1){return t>=e.offset&&t<e.offset+e.length||i&&t===e.offset+e.length}function c(e,t,n=i.DEFAULT){const s=r(e,!1);function o(e){return e?()=>e(s.getTokenOffset(),s.getTokenLength()):()=>!0}function a(e){return e?t=>e(t,s.getTokenOffset(),s.getTokenLength()):()=>!0}const l=o(t.onObjectBegin),c=a(t.onObjectProperty),u=o(t.onObjectEnd),d=o(t.onArrayBegin),h=o(t.onArrayEnd),f=a(t.onLiteralValue),g=a(t.onSeparator),p=o(t.onComment),m=a(t.onError),v=n&&n.disallowComments,y=n&&n.allowTrailingComma;function S(){for(;;){const e=s.scan();switch(s.getTokenError()){case 4:E(14);break;case 5:E(15);break;case 3:E(13);break;case 1:v||E(11);break;case 2:E(12);break;case 6:E(16)}switch(e){case 12:case 13:v?E(10):p();break;case 16:E(1);break;case 15:case 14:break;default:return e}}}function E(e,t=[],i=[]){if(m(e),t.length+i.length>0){let e=s.getToken();for(;17!==e;){if(-1!==t.indexOf(e)){S();break}if(-1!==i.indexOf(e))break;e=S()}}}function w(e){const t=s.getTokenValue()
;return e?f(t):c(t),S(),!0}function b(){switch(s.getToken()){case 3:return function(){d(),S();let e=!1;for(;4!==s.getToken()&&17!==s.getToken();){if(5===s.getToken()){if(e||E(4,[],[]),g(","),S(),4===s.getToken()&&y)break}else e&&E(6,[],[]);b()||E(4,[],[4,5]),e=!0}return h(),4!==s.getToken()?E(8,[4],[]):S(),!0}();case 1:return function(){l(),S();let e=!1;for(;2!==s.getToken()&&17!==s.getToken();){if(5===s.getToken()){if(e||E(4,[],[]),g(","),S(),2===s.getToken()&&y)break}else e&&E(6,[],[]);(10!==s.getToken()?(E(3,[],[2,5]),0):(w(!1),6===s.getToken()?(g(":"),S(),b()||E(4,[],[2,5])):E(5,[],[2,5]),1))||E(4,[],[2,5]),e=!0}return u(),2!==s.getToken()?E(7,[2],[]):S(),!0}();case 10:return w(!0);default:return function(){switch(s.getToken()){case 11:let e=0;try{"number"!=typeof(e=JSON.parse(s.getTokenValue()))&&(E(2),e=0)}catch(e){E(2)}f(e);break;case 7:f(null);break;case 8:f(!0);break;case 9:f(!1);break;default:return!1}return S(),!0}()}}return S(),17===s.getToken()?!!n.allowEmptyContent||(E(4,[],[]),
!1):b()?(17!==s.getToken()&&E(9,[],[]),!0):(E(4,[],[]),!1)}function u(e){switch(typeof e){case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"object":return e?Array.isArray(e)?"array":"object":"null";default:return"null"}}Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeType=t.stripComments=t.visit=t.findNodeAtOffset=t.contains=t.getNodeValue=t.getNodePath=t.findNodeAtLocation=t.parseTree=t.parse=t.getLocation=t.createScanner=t.ParseOptions=t.ParseErrorCode=t.SyntaxKind=t.ScanError=void 0,function(e){e[e.None=0]="None",e[e.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=2]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",e[e.InvalidUnicode=4]="InvalidUnicode",e[e.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",e[e.InvalidCharacter=6]="InvalidCharacter"}(t.ScanError||(t.ScanError={})),function(e){e[e.OpenBraceToken=1]="OpenBraceToken",e[e.CloseBraceToken=2]="CloseBraceToken",
e[e.OpenBracketToken=3]="OpenBracketToken",e[e.CloseBracketToken=4]="CloseBracketToken",e[e.CommaToken=5]="CommaToken",e[e.ColonToken=6]="ColonToken",e[e.NullKeyword=7]="NullKeyword",e[e.TrueKeyword=8]="TrueKeyword",e[e.FalseKeyword=9]="FalseKeyword",e[e.StringLiteral=10]="StringLiteral",e[e.NumericLiteral=11]="NumericLiteral",e[e.LineCommentTrivia=12]="LineCommentTrivia",e[e.BlockCommentTrivia=13]="BlockCommentTrivia",e[e.LineBreakTrivia=14]="LineBreakTrivia",e[e.Trivia=15]="Trivia",e[e.Unknown=16]="Unknown",e[e.EOF=17]="EOF"}(t.SyntaxKind||(t.SyntaxKind={})),function(e){e[e.InvalidSymbol=1]="InvalidSymbol",e[e.InvalidNumberFormat=2]="InvalidNumberFormat",e[e.PropertyNameExpected=3]="PropertyNameExpected",e[e.ValueExpected=4]="ValueExpected",e[e.ColonExpected=5]="ColonExpected",e[e.CommaExpected=6]="CommaExpected",e[e.CloseBraceExpected=7]="CloseBraceExpected",e[e.CloseBracketExpected=8]="CloseBracketExpected",e[e.EndOfFileExpected=9]="EndOfFileExpected",e[e.InvalidCommentToken=10]="InvalidCommentToken",
e[e.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",e[e.UnexpectedEndOfString=12]="UnexpectedEndOfString",e[e.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",e[e.InvalidUnicode=14]="InvalidUnicode",e[e.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",e[e.InvalidCharacter=16]="InvalidCharacter"}(t.ParseErrorCode||(t.ParseErrorCode={})),function(e){e.DEFAULT={allowTrailingComma:!0}}(i=t.ParseOptions||(t.ParseOptions={})),t.createScanner=r,function(e){e[e.nullCharacter=0]="nullCharacter",e[e.maxAsciiCharacter=127]="maxAsciiCharacter",e[e.lineFeed=10]="lineFeed",e[e.carriageReturn=13]="carriageReturn",e[e.lineSeparator=8232]="lineSeparator",e[e.paragraphSeparator=8233]="paragraphSeparator",e[e.nextLine=133]="nextLine",e[e.space=32]="space",e[e.nonBreakingSpace=160]="nonBreakingSpace",e[e.enQuad=8192]="enQuad",e[e.emQuad=8193]="emQuad",e[e.enSpace=8194]="enSpace",e[e.emSpace=8195]="emSpace",e[e.threePerEmSpace=8196]="threePerEmSpace",e[e.fourPerEmSpace=8197]="fourPerEmSpace",
e[e.sixPerEmSpace=8198]="sixPerEmSpace",e[e.figureSpace=8199]="figureSpace",e[e.punctuationSpace=8200]="punctuationSpace",e[e.thinSpace=8201]="thinSpace",e[e.hairSpace=8202]="hairSpace",e[e.zeroWidthSpace=8203]="zeroWidthSpace",e[e.narrowNoBreakSpace=8239]="narrowNoBreakSpace",e[e.ideographicSpace=12288]="ideographicSpace",e[e.mathematicalSpace=8287]="mathematicalSpace",e[e.ogham=5760]="ogham",e[e._=95]="_",e[e.$=36]="$",e[e._0=48]="_0",e[e._1=49]="_1",e[e._2=50]="_2",e[e._3=51]="_3",e[e._4=52]="_4",e[e._5=53]="_5",e[e._6=54]="_6",e[e._7=55]="_7",e[e._8=56]="_8",e[e._9=57]="_9",e[e.a=97]="a",e[e.b=98]="b",e[e.c=99]="c",e[e.d=100]="d",e[e.e=101]="e",e[e.f=102]="f",e[e.g=103]="g",e[e.h=104]="h",e[e.i=105]="i",e[e.j=106]="j",e[e.k=107]="k",e[e.l=108]="l",e[e.m=109]="m",e[e.n=110]="n",e[e.o=111]="o",e[e.p=112]="p",e[e.q=113]="q",e[e.r=114]="r",e[e.s=115]="s",e[e.t=116]="t",e[e.u=117]="u",e[e.v=118]="v",e[e.w=119]="w",e[e.x=120]="x",e[e.y=121]="y",e[e.z=122]="z",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",
e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.ampersand=38]="ampersand",e[e.asterisk=42]="asterisk",e[e.at=64]="at",e[e.backslash=92]="backslash",e[e.bar=124]="bar",e[e.caret=94]="caret",e[e.closeBrace=125]="closeBrace",e[e.closeBracket=93]="closeBracket",e[e.closeParen=41]="closeParen",e[e.colon=58]="colon",e[e.comma=44]="comma",e[e.dot=46]="dot",e[e.doubleQuote=34]="doubleQuote",e[e.equals=61]="equals",e[e.exclamation=33]="exclamation",e[e.greaterThan=62]="greaterThan",e[e.lessThan=60]="lessThan",e[e.minus=45]="minus",e[e.openBrace=123]="openBrace",e[e.openBracket=91]="openBracket",e[e.openParen=40]="openParen",e[e.percent=37]="percent",e[e.plus=43]="plus",e[e.question=63]="question",e[e.semicolon=59]="semicolon",
e[e.singleQuote=39]="singleQuote",e[e.slash=47]="slash",e[e.tilde=126]="tilde",e[e.backspace=8]="backspace",e[e.formFeed=12]="formFeed",e[e.byteOrderMark=65279]="byteOrderMark",e[e.tab=9]="tab",e[e.verticalTab=11]="verticalTab"}(n||(n={})),t.getLocation=function(e,t){const i=[],n=new Object;let r=void 0;const s={value:{},offset:0,length:0,type:"object",parent:void 0};let o=!1;function a(e,t,i,n){s.value=e,s.offset=t,s.length=i,s.type=n,s.colonOffset=void 0,r=s}try{c(e,{onObjectBegin:(e,s)=>{if(t<=e)throw n;r=void 0,o=t>e,i.push("")},onObjectProperty:(e,r,s)=>{if(t<r)throw n;if(a(e,r,s,"property"),i[i.length-1]=e,t<=r+s)throw n},onObjectEnd:(e,s)=>{if(t<=e)throw n;r=void 0,i.pop()},onArrayBegin:(e,s)=>{if(t<=e)throw n;r=void 0,i.push(0)},onArrayEnd:(e,s)=>{if(t<=e)throw n;r=void 0,i.pop()},onLiteralValue:(e,i,r)=>{if(t<i)throw n;if(a(e,i,r,u(e)),t<=i+r)throw n},onSeparator:(e,s,a)=>{if(t<=s)throw n;if(":"===e&&r&&"property"===r.type)r.colonOffset=s,o=!1,r=void 0;else if(","===e){const e=i[i.length-1]
;"number"==typeof e?i[i.length-1]=e+1:(o=!0,i[i.length-1]=""),r=void 0}}})}catch(e){if(e!==n)throw e}return{path:i,previousNode:r,isAtPropertyKey:o,matches:e=>{let t=0;for(let n=0;t<e.length&&n<i.length;n++)if(e[t]===i[n]||"*"===e[t])t++;else if("**"!==e[t])return!1;return t===e.length}}},t.parse=function(e,t=[],n=i.DEFAULT){let r=null,s=[];const o=[];function a(e){Array.isArray(s)?s.push(e):null!==r&&(s[r]=e)}return c(e,{onObjectBegin:()=>{const e={};a(e),o.push(s),s=e,r=null},onObjectProperty:e=>{r=e},onObjectEnd:()=>{s=o.pop()},onArrayBegin:()=>{const e=[];a(e),o.push(s),s=e,r=null},onArrayEnd:()=>{s=o.pop()},onLiteralValue:a,onError:(e,i,n)=>{t.push({error:e,offset:i,length:n})}},n),s[0]},t.parseTree=function(e,t=[],n=i.DEFAULT){let r={type:"array",offset:-1,length:-1,children:[],parent:void 0};function s(e){"property"===r.type&&(r.length=e-r.offset,r=r.parent)}function o(e){return r.children.push(e),e}c(e,{onObjectBegin:e=>{r=o({type:"object",offset:e,length:-1,parent:r,children:[]})},
onObjectProperty:(e,t,i)=>{(r=o({type:"property",offset:t,length:-1,parent:r,children:[]})).children.push({type:"string",value:e,offset:t,length:i,parent:r})},onObjectEnd:(e,t)=>{r.length=e+t-r.offset,r=r.parent,s(e+t)},onArrayBegin:(e,t)=>{r=o({type:"array",offset:e,length:-1,parent:r,children:[]})},onArrayEnd:(e,t)=>{r.length=e+t-r.offset,r=r.parent,s(e+t)},onLiteralValue:(e,t,i)=>{o({type:u(e),offset:t,length:i,parent:r,value:e}),s(t+i)},onSeparator:(e,t,i)=>{"property"===r.type&&(":"===e?r.colonOffset=t:","===e&&s(t))},onError:(e,i,n)=>{t.push({error:e,offset:i,length:n})}},n);const a=r.children[0];return a&&delete a.parent,a},t.findNodeAtLocation=function(e,t){if(!e)return;let i=e;for(let e of t)if("string"==typeof e){if("object"!==i.type||!Array.isArray(i.children))return;let t=!1;for(const n of i.children)if(Array.isArray(n.children)&&n.children[0].value===e){i=n.children[1],t=!0;break}if(!t)return}else{const t=e;if("array"!==i.type||t<0||!Array.isArray(i.children)||t>=i.children.length)return
;i=i.children[t]}return i},t.getNodePath=function e(t){if(!t.parent||!t.parent.children)return[];const i=e(t.parent);if("property"===t.parent.type){const e=t.parent.children[0].value;i.push(e)}else if("array"===t.parent.type){const e=t.parent.children.indexOf(t);-1!==e&&i.push(e)}return i},t.getNodeValue=function e(t){switch(t.type){case"array":return t.children.map(e);case"object":const i=Object.create(null);for(let n of t.children){const t=n.children[1];t&&(i[n.children[0].value]=e(t))}return i;case"null":case"string":case"number":case"boolean":return t.value;default:return}},t.contains=l,t.findNodeAtOffset=function e(t,i,n=!1){if(l(t,i,n)){const r=t.children;if(Array.isArray(r))for(let t=0;t<r.length&&r[t].offset<=i;t++){const s=e(r[t],i,n);if(s)return s}return t}},t.visit=c,t.stripComments=function(e,t){let i,n,s=r(e),o=[],a=0;do{switch(n=s.getPosition(),i=s.scan()){case 12:case 13:case 17:a!==n&&o.push(e.substring(a,n)),void 0!==t&&o.push(s.getTokenValue().replace(/[^\r\n]/g,t)),a=s.getPosition()}
}while(17!==i);return o.join("")},t.getNodeType=u})),define(e[30],t([0,1,2]),(function(e,t,i){"use strict";function n(e){const t=e;return t&&[t.on,t.pause,t.resume,t.destroy].every(e=>"function"==typeof e)}function r(e,t){return new s(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.transform=t.toReadable=t.toStream=t.peekStream=t.consumeStream=t.peekReadable=t.consumeReadable=t.newWriteableStream=t.isReadableBufferedStream=t.isReadableStream=void 0,t.isReadableStream=n,t.isReadableBufferedStream=function(e){const t=e;return t&&n(t.stream)&&Array.isArray(t.buffer)&&"boolean"==typeof t.ended},t.newWriteableStream=r;class s{constructor(e,t){this.reducer=e,this.options=t,this.state={flowing:!1,ended:!1,destroyed:!1},this.buffer={data:[],error:[]},this.listeners={data:[],error:[],end:[]},this.pendingWritePromises=[]}pause(){this.state.destroyed||(this.state.flowing=!1)}resume(){this.state.destroyed||this.state.flowing||(this.state.flowing=!0,this.flowData(),this.flowErrors(),this.flowEnd())}write(e){var t
;if(!this.state.destroyed)if(this.state.flowing)this.listeners.data.forEach(t=>t(e));else if(this.buffer.data.push(e),"number"==typeof(null===(t=this.options)||void 0===t?void 0:t.highWaterMark)&&this.buffer.data.length>this.options.highWaterMark)return new Promise(e=>this.pendingWritePromises.push(e))}error(e){this.state.destroyed||(this.state.flowing?this.listeners.error.forEach(t=>t(e)):this.buffer.error.push(e))}end(e){this.state.destroyed||(e instanceof Error?this.error(e):e&&this.write(e),this.state.flowing?(this.listeners.end.forEach(e=>e()),this.destroy()):this.state.ended=!0)}on(e,t){if(!this.state.destroyed)switch(e){case"data":this.listeners.data.push(t),this.resume();break;case"end":this.listeners.end.push(t),this.state.flowing&&this.flowEnd()&&this.destroy();break;case"error":this.listeners.error.push(t),this.state.flowing&&this.flowErrors()}}removeListener(e,t){if(this.state.destroyed)return;let i=void 0;switch(e){case"data":i=this.listeners.data;break;case"end":i=this.listeners.end;break
;case"error":i=this.listeners.error}if(i){const e=i.indexOf(t);e>=0&&i.splice(e,1)}}flowData(){if(this.buffer.data.length>0){const e=this.reducer(this.buffer.data);this.listeners.data.forEach(t=>t(e)),this.buffer.data.length=0;const t=[...this.pendingWritePromises];this.pendingWritePromises.length=0,t.forEach(e=>e())}}flowErrors(){if(this.listeners.error.length>0){for(const e of this.buffer.error)this.listeners.error.forEach(t=>t(e));this.buffer.error.length=0}}flowEnd(){return!!this.state.ended&&(this.listeners.end.forEach(e=>e()),this.listeners.end.length>0)}destroy(){this.state.destroyed||(this.state.destroyed=!0,this.state.ended=!0,this.buffer.data.length=0,this.buffer.error.length=0,this.listeners.data.length=0,this.listeners.error.length=0,this.listeners.end.length=0,this.pendingWritePromises.length=0)}}t.consumeReadable=function(e,t){const i=[];let n;for(;null!==(n=e.read());)i.push(n);return t(i)},t.peekReadable=function(e,t,i){const n=[];let r=void 0;for(;null!==(r=e.read())&&n.length<i;)n.push(r)
;return null===r&&n.length>0?t(n):{read:()=>{if(n.length>0)return n.shift();if(void 0!==r){const e=r;return r=void 0,e}return e.read()}}},t.consumeStream=function(e,t){return new Promise((i,n)=>{const r=[];e.on("data",e=>r.push(e)),e.on("error",e=>n(e)),e.on("end",()=>i(t(r)))})},t.peekStream=function(e,t){return new Promise((n,r)=>{const s=new i.DisposableStore,o=[],a=i=>{if(o.push(i),o.length>t)return s.dispose(),e.pause(),n({stream:e,buffer:o,ended:!1})};s.add(i.toDisposable(()=>e.removeListener("data",a))),e.on("data",a);const l=e=>r(e);s.add(i.toDisposable(()=>e.removeListener("error",l))),e.on("error",l);const c=()=>n({stream:e,buffer:o,ended:!0});s.add(i.toDisposable(()=>e.removeListener("end",c))),e.on("end",c)})},t.toStream=function(e,t){const i=r(t);return i.end(e),i},t.toReadable=function(e){let t=!1;return{read:()=>t?null:(t=!0,e)}},t.transform=function(e,t,i){const n=r(i);return e.on("data",e=>n.write(t.data(e))),e.on("end",()=>n.end()),e.on("error",e=>n.error(t.error?t.error(e):e)),n}})),
define(e[15],t([0,1,16,30]),(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newWriteableBufferStream=t.streamToBufferReadableStream=t.bufferToStream=t.bufferedStreamToBuffer=t.streamToBuffer=t.bufferToReadable=t.readableToBuffer=t.writeUInt8=t.readUInt8=t.writeUInt32LE=t.readUInt32LE=t.writeUInt32BE=t.readUInt32BE=t.writeUInt16LE=t.readUInt16LE=t.VSBuffer=void 0;const r="undefined"!=typeof Buffer,s="undefined"!=typeof TextEncoder,o="undefined"!=typeof TextDecoder;let a,l;class c{constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}static alloc(e){return new c(r?Buffer.allocUnsafe(e):new Uint8Array(e))}static wrap(e){return r&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new c(e)}static fromString(e){return r?new c(Buffer.from(e)):s?(a||(a=new TextEncoder),new c(a.encode(e))):new c(i.encodeUTF8(e))}static concat(e,t){if(void 0===t){t=0;for(let i=0,n=e.length;i<n;i++)t+=e[i].byteLength}const i=c.alloc(t);let n=0
;for(let t=0,r=e.length;t<r;t++){const r=e[t];i.set(r,n),n+=r.byteLength}return i}toString(){return r?this.buffer.toString():o?(l||(l=new TextDecoder),l.decode(this.buffer)):i.decodeUTF8(this.buffer)}slice(e,t){return new c(this.buffer.subarray(e,t))}set(e,t){e instanceof c?this.buffer.set(e.buffer,t):this.buffer.set(e,t)}readUInt32BE(e){return u(this.buffer,e)}writeUInt32BE(e,t){d(this.buffer,e,t)}readUInt32LE(e){return h(this.buffer,e)}writeUInt32LE(e,t){f(this.buffer,e,t)}readUInt8(e){return g(this.buffer,e)}writeUInt8(e,t){p(this.buffer,e,t)}}function u(e,t){return e[t]*2**24+65536*e[t+1]+256*e[t+2]+e[t+3]}function d(e,t,i){e[i+3]=t,t>>>=8,e[i+2]=t,t>>>=8,e[i+1]=t,t>>>=8,e[i]=t}function h(e,t){return e[t+0]<<0>>>0|e[t+1]<<8>>>0|e[t+2]<<16>>>0|e[t+3]<<24>>>0}function f(e,t,i){e[i+0]=255&t,t>>>=8,e[i+1]=255&t,t>>>=8,e[i+2]=255&t,t>>>=8,e[i+3]=255&t}function g(e,t){return e[t]}function p(e,t,i){e[i]=t}function m(e){return n.consumeStream(e,e=>c.concat(e))}t.VSBuffer=c,t.readUInt16LE=function(e,t){
return e[t+0]<<0>>>0|e[t+1]<<8>>>0},t.writeUInt16LE=function(e,t,i){e[i+0]=255&t,t>>>=8,e[i+1]=255&t},t.readUInt32BE=u,t.writeUInt32BE=d,t.readUInt32LE=h,t.writeUInt32LE=f,t.readUInt8=g,t.writeUInt8=p,t.readableToBuffer=function(e){return n.consumeReadable(e,e=>c.concat(e))},t.bufferToReadable=function(e){return n.toReadable(e)},t.streamToBuffer=m,t.bufferedStreamToBuffer=async function(e){return e.ended?c.concat(e.buffer):c.concat([...e.buffer,await m(e.stream)])},t.bufferToStream=function(e){return n.toStream(e,e=>c.concat(e))},t.streamToBufferReadableStream=function(e){return n.transform(e,{data:e=>"string"==typeof e?c.fromString(e):c.wrap(e)},e=>c.concat(e))},t.newWriteableBufferStream=function(e){return n.newWriteableStream(e=>c.concat(e),e)}})),define(e[17],t([0,1,8]),(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.distinct=t.getOrDefault=t.safeStringify=t.equals=t.mixin=t.cloneAndChange=t.deepFreeze=t.deepClone=void 0,t.deepClone=function e(t){
if(!t||"object"!=typeof t)return t;if(t instanceof RegExp)return t;const i=Array.isArray(t)?[]:{};return Object.keys(t).forEach(n=>{t[n]&&"object"==typeof t[n]?i[n]=e(t[n]):i[n]=t[n]}),i},t.deepFreeze=function(e){if(!e||"object"!=typeof e)return e;const t=[e];for(;t.length>0;){const e=t.shift();Object.freeze(e);for(const i in e)if(n.call(e,i)){const n=e[i];"object"!=typeof n||Object.isFrozen(n)||t.push(n)}}return e};const n=Object.prototype.hasOwnProperty;function r(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(typeof e!=typeof t)return!1;if("object"!=typeof e)return!1;if(Array.isArray(e)!==Array.isArray(t))return!1;let i,n;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(!r(e[i],t[i]))return!1}else{const s=[];for(n in e)s.push(n);s.sort();const o=[];for(n in t)o.push(n);if(o.sort(),!r(s,o))return!1;for(i=0;i<s.length;i++)if(!r(e[s[i]],t[s[i]]))return!1}return!0}t.cloneAndChange=function(e,t){return function e(t,r,s){if(i.isUndefinedOrNull(t))return t;const o=r(t)
;if(void 0!==o)return o;if(i.isArray(t)){const i=[];for(const n of t)i.push(e(n,r,s));return i}if(i.isObject(t)){if(s.has(t))throw new Error("Cannot clone recursive data-structure");s.add(t);const i={};for(let o in t)n.call(t,o)&&(i[o]=e(t[o],r,s));return s.delete(t),i}return t}(e,t,new Set)},t.mixin=function e(t,n,r=!0){return i.isObject(t)?(i.isObject(n)&&Object.keys(n).forEach(s=>{s in t?r&&(i.isObject(t[s])&&i.isObject(n[s])?e(t[s],n[s],r):t[s]=n[s]):t[s]=n[s]}),t):n},t.equals=r,t.safeStringify=function(e){const t=new Set;return JSON.stringify(e,(e,n)=>{if(i.isObject(n)||Array.isArray(n)){if(t.has(n))return"[Circular]";t.add(n)}return n})},t.getOrDefault=function(e,t,i){const n=t(e);return void 0===n?i:n},t.distinct=function(e,t){const i=Object.create(null);return e&&t?(Object.keys(t).forEach(n=>{const s=e[n],o=t[n];r(s,o)||(i[n]=o)}),i):i}})),define(e[56],t([0,1,13]),(function(e,t,i){"use strict";function n(e){const t=[];let i;try{const n=JSON.parse(e.arguments),r=n[n.length-1];r&&r.__$stack&&(n.pop(),
i=r.__$stack),t.push(...n)}catch(i){t.push("Unable to log remote console arguments",e.arguments)}return{args:t,stack:i}}function r(e){if(!e)return e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function s(e){return`color: ${e}`}Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.getFirstFrame=t.parse=t.isRemoteConsoleLog=void 0,t.isRemoteConsoleLog=function(e){const t=e;return t&&"string"==typeof t.type&&"string"==typeof t.severity},t.parse=n,t.getFirstFrame=function e(t){if("string"!=typeof t)return e(n(t).stack);if(t){const e=r(t),n=/at [^\/]*((?:(?:[a-zA-Z]+:)|(?:[\/])|(?:\\\\))(?:.+)):(\d+):(\d+)/.exec(e||"");if(n&&4===n.length)return{uri:i.URI.file(n[1]),line:Number(n[2]),column:Number(n[3])}}},t.log=function(e,t){const{args:i,stack:o}=n(e),a="string"==typeof i[0]&&1===i.length;let l=r(o);l&&(l=`(${l.trim()})`);let c=[];if(c="string"==typeof i[0]?l&&a?[`%c[${t}] %c${i[0]} %c${l}`,s("blue"),s(""),s("grey")]:[`%c[${t}] %c${i[0]}`,s("blue"),s(""),...i.slice(1)]:[`%c[${t}]%`,s("blue"),...i],
l&&!a&&c.push(l),"function"!=typeof console[e.severity])throw new Error("Unknown console method");console[e.severity].apply(console,c)}})),define(e[57],t([0,1,15,16,13]),(function(e,t,i,n,r){"use strict";function s(e,t){return t instanceof RegExp?{$mid:2,source:t.source,flags:n.regExpFlags(t)}:t}function o(e,t=0){if(!e||t>200)return e;if("object"==typeof e){switch(e.$mid){case 1:return r.URI.revive(e);case 2:return new RegExp(e.source,e.flags)}if(e instanceof i.VSBuffer||e instanceof Uint8Array)return e;if(Array.isArray(e))for(let i=0;i<e.length;++i)e[i]=o(e[i],t+1);else for(const i in e)Object.hasOwnProperty.call(e,i)&&(e[i]=o(e[i],t+1))}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.revive=t.parse=t.stringify=void 0,t.stringify=function(e){return JSON.stringify(e,s)},t.parse=function(e){let t=JSON.parse(e);return t=o(t)},t.revive=o})),define(e[39],t([0,1,13,3,16,9,14,21]),(function(e,t,i,n,r,s,o,a){"use strict";function l(e){return!(!o.isWindows||!e||":"!==e[1])}function c(e){
return l(e)?e.charAt(0).toUpperCase()+e.slice(1):e}Object.defineProperty(t,"__esModule",{value:!0}),t.splitName=t.unmnemonicLabel=t.mnemonicButtonLabel=t.mnemonicMenuLabel=t.template=t.shorten=t.untildify=t.tildify=t.normalizeDriveLetter=t.getBaseLabel=t.getPathLabel=void 0,t.getPathLabel=function(e,t,r){if("string"==typeof e&&(e=i.URI.file(e)),r){const t=r.getWorkspaceFolder(e);if(t){const i=r.getWorkspace().folders.length>1;let n;if(n=a.isEqual(t.uri,e)?"":a.relativePath(t.uri,e),i){const e=t.name?t.name:a.basename(t.uri);n=n?e+" • "+n:e}return n}}if(e.scheme!==s.Schemas.file&&e.scheme!==s.Schemas.untitled)return e.with({query:null,fragment:null}).toString(!0);if(l(e.fsPath))return n.normalize(c(e.fsPath));let u=n.normalize(e.fsPath);return!o.isWindows&&(null==t?void 0:t.userHome)&&(u=d(u,t.userHome.fsPath)),u},t.getBaseLabel=function(e){if(!e)return;"string"==typeof e&&(e=i.URI.file(e));const t=a.basename(e)||(e.scheme===s.Schemas.file?e.fsPath:e.path);return l(t)?c(t):t},t.normalizeDriveLetter=c
;let u=Object.create(null);function d(e,t){if(o.isWindows||!e||!t)return e;let i=u.original===t?u.normalized:void 0;return i||(i=`${r.rtrim(t,n.posix.sep)}${n.posix.sep}`,u={original:t,normalized:i}),(o.isLinux?e.startsWith(i):r.startsWithIgnoreCase(e,i))&&(e=`~/${e.substr(i.length)}`),e}t.tildify=d,t.untildify=function(e,t){return e.replace(/^~($|\/|\\)/,`${t}$1`)};const h="…",f="\\\\",g="~";var p;t.shorten=function(e,t=n.sep){const i=new Array(e.length);let r=!1;for(let n=0;n<e.length;n++){let s=e[n];if(""===s){i[n]=`.${t}`;continue}if(!s){i[n]=s;continue}r=!0;let o="";0===s.indexOf(f)?(o=s.substr(0,s.indexOf(f)+f.length),s=s.substr(s.indexOf(f)+f.length)):0===s.indexOf(t)?(o=s.substr(0,s.indexOf(t)+t.length),s=s.substr(s.indexOf(t)+t.length)):0===s.indexOf(g)&&(o=s.substr(0,s.indexOf(g)+g.length),s=s.substr(s.indexOf(g)+g.length));const a=s.split(t);for(let s=1;r&&s<=a.length;s++)for(let l=a.length-s;r&&l>=0;l--){r=!1;let c=a.slice(l,l+s).join(t)
;for(let i=0;!r&&i<e.length;i++)if(i!==n&&e[i]&&e[i].indexOf(c)>-1){const n=l+s===a.length,o=l>0&&e[i].indexOf(t)>-1?t+c:c,u=e[i].endsWith(o);r=!n||u}if(!r){let e="";(a[0].endsWith(":")||""!==o)&&(1===l&&(l=0,s++,c=a[0]+t+c),l>0&&(e=a[0]+t),e=o+e),l>0&&(e=e+h+t),e+=c,l+s<a.length&&(e=e+t+h),i[n]=e}}r&&(i[n]=s)}return i},function(e){e[e.TEXT=0]="TEXT",e[e.VARIABLE=1]="VARIABLE",e[e.SEPARATOR=2]="SEPARATOR"}(p||(p={})),t.template=function(e,t=Object.create(null)){const i=[];let n=!1,r="";for(const s of e)if("$"===s||n&&"{"===s)r&&i.push({value:r,type:p.TEXT}),r="",n=!0;else if("}"===s&&n){const e=t[r];if("string"==typeof e)e.length&&i.push({value:e,type:p.VARIABLE});else if(e){const t=i[i.length-1];t&&t.type===p.SEPARATOR||i.push({value:e.label,type:p.SEPARATOR})}r="",n=!1}else r+=s;return r&&!n&&i.push({value:r,type:p.TEXT}),i.filter((e,t)=>{if(e.type===p.SEPARATOR){return[i[t-1],i[t+1]].every(e=>e&&(e.type===p.VARIABLE||e.type===p.TEXT)&&e.value.length>0)}return!0}).map(e=>e.value).join("")},
t.mnemonicMenuLabel=function(e,t){return o.isMacintosh||t?e.replace(/\(&&\w\)|&&/g,"").replace(/&/g,o.isMacintosh?"&":"&&"):e.replace(/&&|&/g,e=>"&"===e?"&&":"&")},t.mnemonicButtonLabel=function(e,t){return o.isMacintosh||t?e.replace(/\(&&\w\)|&&/g,""):o.isWindows?e.replace(/&&|&/g,e=>"&"===e?"&&":"&"):e.replace(/&&/g,"_")},t.unmnemonicLabel=function(e){return e.replace(/&/g,"&&")},t.splitName=function(e){const t=-1!==e.indexOf("/")?n.posix:n.win32,i=t.basename(e),r=t.dirname(e);return i.length?{name:i,parentPath:r}:{name:r,parentPath:""}}})),define(e[40],t([0,1,117]),(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LineDecoder=void 0;t.LineDecoder=class{constructor(e="utf8"){this.stringDecoder=new i.StringDecoder(e),this.remaining=null}write(e){const t=[],i=this.remaining?this.remaining+this.stringDecoder.write(e):this.stringDecoder.write(e);if(i.length<1)return t;let n,r=0,s=r;for(;s<i.length;)if(13===(n=i.charCodeAt(s))||10===n){if(t.push(i.substring(r,s)),++s<i.length){
const e=n;n=i.charCodeAt(s),(13===e&&10===n||10===e&&13===n)&&s++}r=s}else s++;return this.remaining=r<i.length?i.substr(r):null,t}end(){return this.remaining}}})),define(e[58],t([0,1,9]),(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultUserDataPath=t.getAppDataPath=void 0;const n=i.FileAccess.asFileUri("paths",e).fsPath,r=e.__$__nodeRequire(n);t.getAppDataPath=r.getAppDataPath,t.getDefaultUserDataPath=r.getDefaultUserDataPath})),define(e[59],t([0,1,23,16,3,10,41]),(function(e,t,i,n,r,s,o){"use strict";function a(e){return n.rtrim(r.normalize(e),r.sep)}Object.defineProperty(t,"__esModule",{value:!0}),t.realpathSync=t.realpath=t.realcaseSync=void 0,t.realcaseSync=function e(t){const i=r.dirname(t);if(t===i)return t;const n=(r.basename(t)||t).toLowerCase();try{const t=s.readdirSync(i).filter(e=>e.toLowerCase()===n);if(1===t.length){const n=e(i);if(n)return r.join(n,t[0])}else if(t.length>1){const s=t.indexOf(n);if(s>=0){const n=e(i);if(n)return r.join(n,t[s])}}
}catch(e){}return null},t.realpath=async function(e){try{return await o.promisify(i.realpath)(e)}catch(t){const n=a(e);return await o.promisify(i.access)(n,i.constants.R_OK),n}},t.realpathSync=function(e){try{return i.realpathSync(e)}catch(t){const n=a(e);return i.accessSync(n,i.constants.R_OK),n}}})),define(e[60],t([0,1,3,23,14,118,2,10]),(function(e,t,i,n,r,s,o,a){"use strict";function l(e,c,u){const d=i.basename(e.path),h=new Map;let f=!1,g=[o.toDisposable(()=>{h.forEach(e=>o.dispose(e)),h.clear()})];try{const p=n.watch(e.path);g.push(o.toDisposable(()=>{p.removeAllListeners(),p.close()}));const m=new Set;e.isDirectory&&a.readdir(e.path).then(e=>e.forEach(e=>m.add(e))),p.on("error",(t,i)=>{f||u(`Failed to watch ${e.path} for changes using fs.watch() (${t}, ${i})`)}),p.on("change",(n,p)=>{if(f)return;let v="";if(p&&(v=p.toString(),r.isMacintosh&&(v=s.normalizeNFC(v))),!v||"change"!==n&&"rename"!==n)return;const y=e.isDirectory?i.join(e.path,v):e.path;if(e.isDirectory)if("rename"===n){const e=h.get(y)
;e&&o.dispose(e);const i=setTimeout(async()=>{h.delete(y);const e=await a.exists(y);if(f)return;let t;e?m.has(v)?t="changed":(t="added",m.add(v)):(m.delete(v),t="deleted"),c(t,y)},t.CHANGE_BUFFER_DELAY);h.set(y,o.toDisposable(()=>clearTimeout(i)))}else{let e;m.has(v)?e="changed":(e="added",m.add(v)),c(e,y)}else if("rename"===n||v!==d){const i=setTimeout(async()=>{const t=await a.exists(y);f||(t?(c("changed",y),g=[l(e,c,u)]):c("deleted",y))},t.CHANGE_BUFFER_DELAY);o.dispose(g),g=[o.toDisposable(()=>clearTimeout(i))]}else c("changed",y)})}catch(t){a.exists(e.path).then(i=>{i&&!f&&u(`Failed to watch ${e.path} for changes using fs.watch() (${t.toString()})`)})}return o.toDisposable(()=>{f=!0,g=o.dispose(g)})}Object.defineProperty(t,"__esModule",{value:!0}),t.CHANGE_BUFFER_DELAY=t.watchFolder=t.watchFile=void 0,t.watchFile=function(e,t,i){return l({path:e,isDirectory:!1},t,i)},t.watchFolder=function(e,t,i){return l({path:e,isDirectory:!0},t,i)},t.CHANGE_BUFFER_DELAY=100})),
define(e[31],t([0,1,11,2,12,28,20,15,18,8,57,16]),(function(e,t,i,n,r,s,o,a,l,c,u,d){"use strict";var h,f;function g(e){switch(e){case 100:return"req";case 101:return"cancel";case 102:return"subscribe";case 103:return"unsubscribe"}}function p(e){switch(e){case 200:return"init";case 201:return"reply:";case 202:case 203:return"replyErr:";case 204:return"event:"}}Object.defineProperty(t,"__esModule",{value:!0}),t.IPCLogger=t.logWithColors=t.createChannelSender=t.createChannelReceiver=t.StaticRouter=t.getNextTickChannel=t.getDelayedChannel=t.IPCClient=t.IPCServer=t.ChannelClient=t.RequestInitiator=t.ChannelServer=t.ResponseType=t.RequestType=void 0,function(e){e[e.Promise=100]="Promise",e[e.PromiseCancel=101]="PromiseCancel",e[e.EventListen=102]="EventListen",e[e.EventDispose=103]="EventDispose"}(t.RequestType||(t.RequestType={})),function(e){e[e.Initialize=200]="Initialize",e[e.PromiseSuccess=201]="PromiseSuccess",e[e.PromiseError=202]="PromiseError",e[e.PromiseErrorObj=203]="PromiseErrorObj",
e[e.EventFire=204]="EventFire"}(t.ResponseType||(t.ResponseType={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Idle=1]="Idle"}(h||(h={}));class m{constructor(e){this.buffer=e,this.pos=0}read(e){const t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=t.byteLength,t}}class v{constructor(){this.buffers=[]}get buffer(){return a.VSBuffer.concat(this.buffers)}write(e){this.buffers.push(e)}}function y(e){const t=a.VSBuffer.alloc(4);return t.writeUInt32BE(e,0),t}function S(e){return e.read(4).readUInt32BE(0)}function E(e){const t=a.VSBuffer.alloc(1);return t.writeUInt8(e,0),t}!function(e){e[e.Undefined=0]="Undefined",e[e.String=1]="String",e[e.Buffer=2]="Buffer",e[e.VSBuffer=3]="VSBuffer",e[e.Array=4]="Array",e[e.Object=5]="Object"}(f||(f={}));const w={Undefined:E(f.Undefined),String:E(f.String),Buffer:E(f.Buffer),VSBuffer:E(f.VSBuffer),Array:E(f.Array),Object:E(f.Object)},b="undefined"!=typeof Buffer;function C(e,t){if(void 0===t)e.write(w.Undefined);else if("string"==typeof t){
const i=a.VSBuffer.fromString(t);e.write(w.String),e.write(y(i.byteLength)),e.write(i)}else if(b&&Buffer.isBuffer(t)){const i=a.VSBuffer.wrap(t);e.write(w.Buffer),e.write(y(i.byteLength)),e.write(i)}else if(t instanceof a.VSBuffer)e.write(w.VSBuffer),e.write(y(t.byteLength)),e.write(t);else if(Array.isArray(t)){e.write(w.Array),e.write(y(t.length));for(const i of t)C(e,i)}else{const i=a.VSBuffer.fromString(JSON.stringify(t));e.write(w.Object),e.write(y(i.byteLength)),e.write(i)}}function x(e){switch(e.read(1).readUInt8(0)){case f.Undefined:return;case f.String:return e.read(S(e)).toString();case f.Buffer:return e.read(S(e)).buffer;case f.VSBuffer:return e.read(S(e));case f.Array:{const t=S(e),i=[];for(let n=0;n<t;n++)i.push(x(e));return i}case f.Object:return JSON.parse(e.read(S(e)).toString())}}class P{constructor(e,t,i=null,n=1e3){this.protocol=e,this.ctx=t,this.logger=i,this.timeoutDelay=n,this.channels=new Map,this.activeRequests=new Map,this.pendingRequests=new Map,
this.protocolListener=this.protocol.onMessage(e=>this.onRawMessage(e)),this.sendResponse({type:200})}registerChannel(e,t){this.channels.set(e,t),setTimeout(()=>this.flushPendingRequests(e),0)}sendResponse(e){switch(e.type){case 200:{const t=this.send([e.type]);return void(this.logger&&this.logger.logOutgoing(t,0,1,p(e.type)))}case 201:case 202:case 204:case 203:{const t=this.send([e.type,e.id],e.data);return void(this.logger&&this.logger.logOutgoing(t,e.id,1,p(e.type),e.data))}}}send(e,t){const i=new v;return C(i,e),C(i,t),this.sendBuffer(i.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch(e){return 0}}onRawMessage(e){const t=new m(e),i=x(t),n=x(t),r=i[0];switch(r){case 100:return this.logger&&this.logger.logIncoming(e.byteLength,i[1],1,`${g(r)}: ${i[2]}.${i[3]}`,n),this.onPromise({type:r,id:i[1],channelName:i[2],name:i[3],arg:n});case 102:return this.logger&&this.logger.logIncoming(e.byteLength,i[1],1,`${g(r)}: ${i[2]}.${i[3]}`,n),this.onEventListen({type:r,id:i[1],channelName:i[2],
name:i[3],arg:n});case 101:case 103:return this.logger&&this.logger.logIncoming(e.byteLength,i[1],1,`${g(r)}`),this.disposeActiveRequest({type:r,id:i[1]})}}onPromise(e){const t=this.channels.get(e.channelName);if(!t)return void this.collectPendingRequest(e);const i=new s.CancellationTokenSource;let r;try{r=t.call(this.ctx,e.name,e.arg,i.token)}catch(e){r=Promise.reject(e)}const o=e.id;r.then(t=>{this.sendResponse({id:o,data:t,type:201}),this.activeRequests.delete(e.id)},t=>{t instanceof Error?this.sendResponse({id:o,data:{message:t.message,name:t.name,stack:t.stack?t.stack.split?t.stack.split("\n"):t.stack:void 0},type:202}):this.sendResponse({id:o,data:t,type:203}),this.activeRequests.delete(e.id)});const a=n.toDisposable(()=>i.cancel());this.activeRequests.set(e.id,a)}onEventListen(e){const t=this.channels.get(e.channelName);if(!t)return void this.collectPendingRequest(e);const i=e.id,n=t.listen(this.ctx,e.name,e.arg)(e=>this.sendResponse({id:i,data:e,type:204}));this.activeRequests.set(e.id,n)}
disposeActiveRequest(e){const t=this.activeRequests.get(e.id);t&&(t.dispose(),this.activeRequests.delete(e.id))}collectPendingRequest(e){let t=this.pendingRequests.get(e.channelName);t||(t=[],this.pendingRequests.set(e.channelName,t));const i=setTimeout(()=>{console.error(`Unknown channel: ${e.channelName}`),100===e.type&&this.sendResponse({id:e.id,data:{name:"Unknown channel",message:`Channel name '${e.channelName}' timed out after ${this.timeoutDelay}ms`,stack:void 0},type:202})},this.timeoutDelay);t.push({request:e,timeoutTimer:i})}flushPendingRequests(e){const t=this.pendingRequests.get(e);if(t){for(const e of t)switch(clearTimeout(e.timeoutTimer),e.request.type){case 100:this.onPromise(e.request);break;case 102:this.onEventListen(e.request)}this.pendingRequests.delete(e)}}dispose(){this.protocolListener&&(this.protocolListener.dispose(),this.protocolListener=null),this.activeRequests.forEach(e=>e.dispose()),this.activeRequests.clear()}}t.ChannelServer=P,function(e){e[e.LocalSide=0]="LocalSide",
e[e.OtherSide=1]="OtherSide"}(t.RequestInitiator||(t.RequestInitiator={}));class _{constructor(e,t=null){this.protocol=e,this.state=h.Uninitialized,this.activeRequests=new Set,this.handlers=new Map,this.lastRequestId=0,this._onDidInitialize=new i.Emitter,this.onDidInitialize=this._onDidInitialize.event,this.protocolListener=this.protocol.onMessage(e=>this.onBuffer(e)),this.logger=t}getChannel(e){const t=this;return{call:(i,n,r)=>t.requestPromise(e,i,n,r),listen:(i,n)=>t.requestEvent(e,i,n)}}requestPromise(e,t,i,a=s.CancellationToken.None){const l=this.lastRequestId++,c={id:l,type:100,channelName:e,name:t,arg:i};if(a.isCancellationRequested)return Promise.reject(o.canceled());let u;return new Promise((e,t)=>{if(a.isCancellationRequested)return t(o.canceled());const i=()=>{this.handlers.set(l,i=>{switch(i.type){case 201:this.handlers.delete(l),e(i.data);break;case 202:this.handlers.delete(l);const n=new Error(i.data.message);n.stack=i.data.stack,n.name=i.data.name,t(n);break;case 203:this.handlers.delete(l),
t(i.data)}}),this.sendRequest(c)};let s=null;this.state===h.Idle?i():(s=r.createCancelablePromise(e=>this.whenInitialized())).then(()=>{s=null,i()});const d=()=>{s?(s.cancel(),s=null):this.sendRequest({id:l,type:101}),t(o.canceled())},f=a.onCancellationRequested(d);u=n.combinedDisposable(n.toDisposable(d),f),this.activeRequests.add(u)}).finally(()=>{this.activeRequests.delete(u)})}requestEvent(e,t,n){const s=this.lastRequestId++,o={id:s,type:102,channelName:e,name:t,arg:n};let a=null;const l=new i.Emitter({onFirstListenerAdd:()=>{(a=r.createCancelablePromise(e=>this.whenInitialized())).then(()=>{a=null,this.activeRequests.add(l),this.sendRequest(o)})},onLastListenerRemove:()=>{a?(a.cancel(),a=null):(this.activeRequests.delete(l),this.sendRequest({id:s,type:103}))}});return this.handlers.set(s,e=>l.fire(e.data)),l.event}sendRequest(e){switch(e.type){case 100:case 102:{const t=this.send([e.type,e.id,e.channelName,e.name],e.arg)
;return void(this.logger&&this.logger.logOutgoing(t,e.id,0,`${g(e.type)}: ${e.channelName}.${e.name}`,e.arg))}case 101:case 103:{const t=this.send([e.type,e.id]);return void(this.logger&&this.logger.logOutgoing(t,e.id,0,g(e.type)))}}}send(e,t){const i=new v;return C(i,e),C(i,t),this.sendBuffer(i.buffer)}sendBuffer(e){try{return this.protocol.send(e),e.byteLength}catch(e){return 0}}onBuffer(e){const t=new m(e),i=x(t),n=x(t),r=i[0];switch(r){case 200:return this.logger&&this.logger.logIncoming(e.byteLength,0,0,p(r)),this.onResponse({type:i[0]});case 201:case 202:case 204:case 203:return this.logger&&this.logger.logIncoming(e.byteLength,i[1],0,p(r),n),this.onResponse({type:i[0],id:i[1],data:n})}}onResponse(e){if(200===e.type)return this.state=h.Idle,void this._onDidInitialize.fire();const t=this.handlers.get(e.id);t&&t(e)}whenInitialized(){return this.state===h.Idle?Promise.resolve():i.Event.toPromise(this.onDidInitialize)}dispose(){this.protocolListener&&(this.protocolListener.dispose(),
this.protocolListener=null),this.activeRequests.forEach(e=>e.dispose()),this.activeRequests.clear()}}t.ChannelClient=_;t.IPCServer=class{constructor(e){this.channels=new Map,this._connections=new Set,this._onDidAddConnection=new i.Emitter,this.onDidAddConnection=this._onDidAddConnection.event,this._onDidRemoveConnection=new i.Emitter,this.onDidRemoveConnection=this._onDidRemoveConnection.event,e(({protocol:e,onDidClientDisconnect:t})=>{i.Event.once(e.onMessage)(i=>{const n=x(new m(i)),r=new P(e,n),s=new _(e);this.channels.forEach((e,t)=>r.registerChannel(t,e));const o={channelServer:r,channelClient:s,ctx:n};this._connections.add(o),this._onDidAddConnection.fire(o),t(()=>{r.dispose(),s.dispose(),this._connections.delete(o),this._onDidRemoveConnection.fire(o)})})})}get connections(){const e=[];return this._connections.forEach(t=>e.push(t)),e}getChannel(e,t){const n=this;return{call(r,s,o){let a;if(c.isFunction(t)){let e=l.getRandomElement(n.connections.filter(t))
;a=e?Promise.resolve(e):i.Event.toPromise(i.Event.filter(n.onDidAddConnection,t))}else a=t.routeCall(n,r,s);return I(a.then(t=>t.channelClient.getChannel(e))).call(r,s,o)},listen(i,r){if(c.isFunction(t))return n.getMulticastEvent(e,t,i,r);return I(t.routeEvent(n,i,r).then(t=>t.channelClient.getChannel(e))).listen(i,r)}}}getMulticastEvent(e,t,r,s){const o=this;let a=new n.DisposableStore;const l=new i.Emitter({onFirstListenerAdd:()=>{a=new n.DisposableStore;const c=new i.EventMultiplexer,u=new Map,d=t=>{const i=t.channelClient.getChannel(e).listen(r,s),n=c.add(i);u.set(t,n)};o.connections.filter(t).forEach(d),i.Event.filter(o.onDidAddConnection,t)(d,void 0,a),o.onDidRemoveConnection(e=>{const t=u.get(e);t&&(t.dispose(),u.delete(e))},void 0,a),c.event(l.fire,l,a),a.add(c)},onLastListenerRemove:()=>{a.dispose()}});return l.event}registerChannel(e,t){this.channels.set(e,t),this._connections.forEach(i=>{i.channelServer.registerChannel(e,t)})}dispose(){this.channels.clear(),this._connections.clear(),
this._onDidAddConnection.dispose(),this._onDidRemoveConnection.dispose()}};function I(e){return{call:(t,i,n)=>e.then(e=>e.call(t,i,n)),listen(t,n){const r=new i.Relay;return e.then(e=>r.input=e.listen(t,n)),r.event}}}t.IPCClient=class{constructor(e,t,i=null){const n=new v;C(n,t),e.send(n.buffer),this.channelClient=new _(e,i),this.channelServer=new P(e,t,i)}getChannel(e){return this.channelClient.getChannel(e)}registerChannel(e,t){this.channelServer.registerChannel(e,t)}dispose(){this.channelClient.dispose(),this.channelServer.dispose()}},t.getDelayedChannel=I,t.getNextTickChannel=function(e){let t=!1;return{call:(i,n,s)=>t?e.call(i,n,s):r.timeout(0).then(()=>t=!0).then(()=>e.call(i,n,s)),listen(n,s){if(t)return e.listen(n,s);const o=new i.Relay;return r.timeout(0).then(()=>t=!0).then(()=>o.input=e.listen(n,s)),o.event}}};function D(e){return"o"===e[0]&&"n"===e[1]&&d.isUpperAsciiLetter(e.charCodeAt(2))}t.StaticRouter=class{constructor(e){this.fn=e}routeCall(e){return this.route(e)}routeEvent(e){
return this.route(e)}async route(e){for(const t of e.connections)if(await Promise.resolve(this.fn(t.ctx)))return Promise.resolve(t);return await i.Event.toPromise(e.onDidAddConnection),await this.route(e)}},t.createChannelReceiver=function(e,t){const n=e,r=t&&t.disableMarshalling,s=new Map;for(const e in n)D(e)&&s.set(e,i.Event.buffer(n[e],!0));return new class{listen(e,t){const i=s.get(t);if(i)return i;throw new Error(`Event not found: ${t}`)}call(e,t,i){const s=n[t];if("function"==typeof s){if(!r&&Array.isArray(i))for(let e=0;e<i.length;e++)i[e]=u.revive(i[e]);return s.apply(n,i)}throw new Error(`Method not found: ${t}`)}}},t.createChannelSender=function(e,t){const i=t&&t.disableMarshalling;return new Proxy({},{get(n,r){var s;if("string"==typeof r)return(null===(s=null==t?void 0:t.properties)||void 0===s?void 0:s.has(r))?t.properties.get(r):D(r)?e.listen(r):async function(...n){let s;s=t&&!c.isUndefinedOrNull(t.context)?[t.context,...n]:n;const o=await e.call(r,s);return i?o:u.revive(o)}
;throw new Error(`Property not found: ${String(r)}`)}})};const O=[["#2977B1","#FC802D","#34A13A","#D3282F","#9366BA"],["#8B564C","#E177C0","#7F7F7F","#BBBE3D","#2EBECD"]];function L(e){if(Array.isArray(e))return e;if(e&&"object"==typeof e&&"function"==typeof e.toString){let t=e.toString();if("[object Object]"!==t)return t}return e}function R(e,t,i,n,r,s,o){o=function(e){return Array.isArray(e)?e.map(L):L(e)}(o);const a=O[r],l=a[n%a.length];let c=[`%c[${e}]%c[${String(t).padStart(7," ")}]%c[len: ${String(i).padStart(5," ")}]%c${String(n).padStart(5," ")} - ${s}`,"color: darkgreen","color: grey","color: grey",`color: ${l}`];/\($/.test(s)?(c=c.concat(o)).push(")"):c.push(o),console.log.apply(console,c)}t.logWithColors=R;t.IPCLogger=class{constructor(e,t){this._outgoingPrefix=e,this._incomingPrefix=t,this._totalIncoming=0,this._totalOutgoing=0}logOutgoing(e,t,i,n,r){this._totalOutgoing+=e,R(this._outgoingPrefix,this._totalOutgoing,e,t,i,n,r)}logIncoming(e,t,i,n,r){this._totalIncoming+=e,
R(this._incomingPrefix,this._totalIncoming,e,t,i,n,r)}}})),define(e[61],t([6,5]),(function(e,t){return e.create("vs/base/common/date",t)})),define(e[62],t([0,1,16,61]),(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toLocalISOString=t.fromNow=void 0;const r=60,s=60*r,o=24*s,a=7*o,l=30*o,c=365*o;t.fromNow=function e(t,i){"number"!=typeof t&&(t=t.getTime());const u=Math.round(((new Date).getTime()-t)/1e3);if(u<-30)return n.localize(0,null,e((new Date).getTime()+1e3*u,!1));if(u<30)return n.localize(1,null);let d;return u<r?(d=u,i?1===d?n.localize(2,null,d):n.localize(3,null,d):1===d?n.localize(4,null,d):n.localize(5,null,d)):u<s?(d=Math.floor(u/r),i?1===d?n.localize(6,null,d):n.localize(7,null,d):1===d?n.localize(8,null,d):n.localize(9,null,d)):u<o?(d=Math.floor(u/s),i?1===d?n.localize(10,null,d):n.localize(11,null,d):1===d?n.localize(12,null,d):n.localize(13,null,d)):u<a?(d=Math.floor(u/o),
i?1===d?n.localize(14,null,d):n.localize(15,null,d):1===d?n.localize(16,null,d):n.localize(17,null,d)):u<l?(d=Math.floor(u/a),i?1===d?n.localize(18,null,d):n.localize(19,null,d):1===d?n.localize(20,null,d):n.localize(21,null,d)):u<c?(d=Math.floor(u/l),i?1===d?n.localize(22,null,d):n.localize(23,null,d):1===d?n.localize(24,null,d):n.localize(25,null,d)):(d=Math.floor(u/c),i?1===d?n.localize(26,null,d):n.localize(27,null,d):1===d?n.localize(28,null,d):n.localize(29,null,d))},t.toLocalISOString=function(e){return e.getFullYear()+"-"+i.pad(e.getMonth()+1,2)+"-"+i.pad(e.getDate(),2)+"T"+i.pad(e.getHours(),2)+":"+i.pad(e.getMinutes(),2)+":"+i.pad(e.getSeconds(),2)+"."+(e.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}})),define(e[63],t([6,5]),(function(e,t){return e.create("vs/base/common/errorMessage",t)})),define(e[32],t([0,1,63,8,18]),(function(e,t,i,n,r){"use strict";function s(e,t){return t&&(e.stack||e.stacktrace)?i.localize(0,null,a(e),o(e.stack)||o(e.stacktrace)):a(e)}function o(e){
return Array.isArray(e)?e.join("\n"):e}function a(e){return"string"==typeof e.code&&"number"==typeof e.errno&&"string"==typeof e.syscall?i.localize(1,null,e.message):e.message||i.localize(2,null)}Object.defineProperty(t,"__esModule",{value:!0}),t.toErrorMessage=void 0,t.toErrorMessage=function e(t=null,o=!1){if(!t)return i.localize(3,null);if(Array.isArray(t)){const n=r.coalesce(t),s=e(n[0],o);return n.length>1?i.localize(4,null,s,n.length):s}if(n.isString(t))return t;if(t.detail){const e=t.detail;if(e.error)return s(e.error,o);if(e.exception)return s(e.exception,o)}return t.stack?s(t,o):t.message?t.message:i.localize(5,null)}})),define(e[64],t([6,5]),(function(e,t){return e.create("vs/base/node/processes",t)})),define(e[65],t([0,1,3,23,41,33,64,8,17,66,14,40,9]),(function(e,t,i,n,r,s,o,a,l,c,u,d,h){"use strict";function f(e){switch(e){case 0:return 0;case 1:return 2;case 128:return 3;default:return 1}}function g(){return process.env.comspec||"cmd.exe"}Object.defineProperty(t,"__esModule",{value:!0}),
t.win32=t.createQueuedSender=t.LineProcess=t.AbstractProcess=t.getWindowsShell=t.TerminateResponseCode=t.Source=void 0,t.getWindowsShell=g;class p{constructor(e,t,i,n){if(void 0!==t&&void 0!==i&&void 0!==n)this.cmd=e,this.args=t,this.shell=i,this.options=n;else{const t=e;this.cmd=t.command,this.shell=t.isShellCommand,this.args=t.args.slice(0),this.options=t.options||{}}if(this.childProcess=null,this.childProcessPromise=null,this.terminateRequested=!1,this.options.env){const e=Object.create(null);Object.keys(process.env).forEach(t=>{e[t]=process.env[t]}),Object.keys(this.options.env).forEach(t=>{e[t]=this.options.env[t]}),this.options.env=e}}getSanitizedCommand(){let e=this.cmd.toLowerCase();const t=e.lastIndexOf(i.sep);return-1!==t&&(e=e.substring(t+1)),p.WellKnowCommands[e]?e:"other"}start(e){return u.isWindows&&(this.options&&this.options.cwd&&c.isUNC(this.options.cwd)||!this.options&&c.isUNC(process.cwd()))?Promise.reject(new Error(o.localize(0,null))):this.useExec().then(t=>{let i,n
;const r=new Promise((e,t)=>{i=e,n=t});if(t){let t=this.cmd;this.args&&(t=t+" "+this.args.join(" ")),this.childProcess=s.exec(t,this.options,(t,r,s)=>{this.childProcess=null;t&&t.killed?n({killed:this.terminateRequested,stdout:r.toString(),stderr:s.toString()}):this.handleExec(i,e,t,r,s)})}else{let t=null;const r=t=>{this.childProcess=null,this.childProcessPromise=null,this.handleClose(t,i,e,n);const r={terminated:this.terminateRequested};a.isNumber(t)&&(r.cmdCode=t),i(r)};if(this.shell&&u.isWindows){const e=l.deepClone(this.options);e.windowsVerbatimArguments=!0,e.detached=!1;let i=!1,n=!1;const r=[];let o=this.ensureQuotes(this.cmd);r.push(o.value),i=o.quoted,this.args&&this.args.forEach(e=>{o=this.ensureQuotes(e),r.push(o.value),n=n&&o.quoted});const a=["/s","/c"];i?n?a.push('"'+r.join(" ")+'"'):r.length>1?a.push('"'+r[0]+'" '+r.slice(1).join(" ")):a.push('"'+r[0]+'"'):a.push(r.join(" ")),t=s.spawn(g(),a,e)}else this.cmd&&(t=s.spawn(this.cmd,this.args,this.options));t&&(this.childProcess=t,
this.childProcessPromise=Promise.resolve(t),this.pidResolve&&(this.pidResolve(a.isNumber(t.pid)?t.pid:-1),this.pidResolve=void 0),t.on("error",e=>{this.childProcess=null,n({terminated:this.terminateRequested,error:e})}),t.pid&&(this.childProcess.on("close",r),this.handleSpawn(t,i,e,n,!0)))}return r})}handleClose(e,t,i,n){}ensureQuotes(e){return p.regexp.test(e)?{value:'"'+e+'"',quoted:!0}:{value:e,quoted:e.length>0&&'"'===e[0]&&'"'===e[e.length-1]}}get pid(){return this.childProcessPromise?this.childProcessPromise.then(e=>e.pid,e=>-1):new Promise(e=>{this.pidResolve=e})}terminate(){return this.childProcessPromise?this.childProcessPromise.then(t=>(this.terminateRequested=!0,function(t,i){if(u.isWindows)try{const e={stdio:["pipe","pipe","ignore"]};i&&(e.cwd=i);const n=s.execFile("taskkill",["/T","/F","/PID",t.pid.toString()],e);return new Promise((e,t)=>{n.once("error",t=>{e({success:!1,error:t})}),n.once("exit",(t,i)=>{e(0===t?{success:!0}:{success:!1,code:null!==t?t:1})})})}catch(e){return Promise.resolve({
success:!1,error:e,code:e.status?f(e.status):1})}else if(u.isLinux||u.isMacintosh)try{const i=h.FileAccess.asFileUri("vs/base/node/terminateProcess.sh",e).fsPath;return new Promise((e,n)=>{s.execFile(i,[t.pid.toString()],{encoding:"utf8",shell:!0},(t,i,n)=>{e(t?{success:!1,error:t}:{success:!0})})})}catch(e){return Promise.resolve({success:!1,error:e})}else t.kill("SIGKILL");return Promise.resolve({success:!0})}(t,this.options.cwd).then(e=>(e.success&&(this.childProcess=null),e))),e=>({success:!0})):Promise.resolve({success:!0})}useExec(){return new Promise((e,t)=>{if(!this.shell||!u.isWindows)return e(!1);const i=s.spawn(g(),["/s","/c"]);i.on("error",t=>e(!0)),i.on("exit",t=>e(!1))})}}t.AbstractProcess=p,p.WellKnowCommands={ant:!0,cmake:!0,eslint:!0,gradle:!0,grunt:!0,gulp:!0,jake:!0,jenkins:!0,jshint:!0,make:!0,maven:!0,msbuild:!0,msc:!0,nmake:!0,npm:!0,rake:!0,tsc:!0,xbuild:!0},p.regexp=/^[^"].* .*[^"]/;t.LineProcess=class extends p{constructor(e,t,i,n){super(e,t,i,n),this.stdoutLineDecoder=null,
this.stderrLineDecoder=null}handleExec(e,t,i,n,r){[n,r].forEach((e,i)=>{const n=new d.LineDecoder;n.write(e).forEach(e=>{t({line:e,source:0===i?0:1})});const r=n.end();r&&t({line:r,source:0===i?0:1})}),e({terminated:this.terminateRequested,error:i})}handleSpawn(e,t,i,n,r){const s=new d.LineDecoder,o=new d.LineDecoder;e.stdout.on("data",e=>{s.write(e).forEach(e=>i({line:e,source:0}))}),e.stderr.on("data",e=>{o.write(e).forEach(e=>i({line:e,source:1}))}),this.stdoutLineDecoder=s,this.stderrLineDecoder=o}handleClose(e,t,i,n){const r=this.stdoutLineDecoder?this.stdoutLineDecoder.end():null;r&&i({line:r,source:0});const s=this.stderrLineDecoder?this.stderrLineDecoder.end():null;s&&i({line:s,source:1})}},t.createQueuedSender=function(e){let t=[],i=!1;const n=function(r){if(i)return void t.push(r);e.send(r,e=>{if(e&&console.error(e),i=!1,t.length>0){const e=t.slice(0);t=[],e.forEach(e=>n(e))}})&&!u.isWindows||(i=!0)};return{send:n}},function(e){e.findExecutable=async function(e,t,s){if(i.isAbsolute(e))return e
;if(void 0===t&&(t=process.cwd()),"."!==i.dirname(e))return i.join(t,e);if(void 0===s&&a.isString(process.env.PATH)&&(s=process.env.PATH.split(i.delimiter)),void 0===s||0===s.length)return i.join(t,e);async function o(e){return!!await r.promisify(n.exists)(e)&&!(await r.promisify(n.stat)(e)).isDirectory()}for(let n of s){let r;if(r=i.isAbsolute(n)?i.join(n,e):i.join(t,n,e),await o(r))return r;let s=r+".com";if(await o(s))return s;if(s=r+".exe",await o(s))return s}return i.join(t,e)}}(t.win32||(t.win32={}))})),define(e[42],t([0,1,33,2,12,17,11,65,31,56,28,20,15,14]),(function(e,t,i,n,r,s,o,a,l,c,u,d,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=t.Server=void 0;class g extends l.ChannelServer{constructor(e){super({send:e=>{try{process.send&&process.send(e.buffer.toString("base64"))}catch(e){}},onMessage:o.Event.fromNodeEventEmitter(process,"message",e=>h.VSBuffer.wrap(Buffer.from(e,"base64")))},e),process.once("disconnect",()=>this.dispose())}}t.Server=g;t.Client=class{
constructor(e,t){this.modulePath=e,this.options=t,this.activeRequests=new Set,this.channels=new Map,this._onDidProcessExit=new o.Emitter,this.onDidProcessExit=this._onDidProcessExit.event;const i=t&&t.timeout?t.timeout:6e4;this.disposeDelayer=new r.Delayer(i),this.child=null,this._client=null}getChannel(e){const t=this;return{call:(i,n,r)=>t.requestPromise(e,i,n,r),listen:(i,n)=>t.requestEvent(e,i,n)}}requestPromise(e,t,i,s=u.CancellationToken.None){if(!this.disposeDelayer)return Promise.reject(new Error("disposed"));if(s.isCancellationRequested)return Promise.reject(d.canceled());this.disposeDelayer.cancel();const o=this.getCachedChannel(e),a=r.createCancelablePromise(e=>o.call(t,i,e)),l=s.onCancellationRequested(()=>a.cancel()),c=n.toDisposable(()=>a.cancel());return this.activeRequests.add(c),a.finally(()=>{l.dispose(),this.activeRequests.delete(c),0===this.activeRequests.size&&this.disposeDelayer&&this.disposeDelayer.trigger(()=>this.disposeClient())}),a}requestEvent(e,t,i){
if(!this.disposeDelayer)return o.Event.None;let n;this.disposeDelayer.cancel();const r=new o.Emitter({onFirstListenerAdd:()=>{const s=this.getCachedChannel(e).listen(t,i);n=s(r.fire,r),this.activeRequests.add(n)},onLastListenerRemove:()=>{this.activeRequests.delete(n),n.dispose(),0===this.activeRequests.size&&this.disposeDelayer&&this.disposeDelayer.trigger(()=>this.disposeClient())}});return r.event}get client(){if(!this._client){const e=this.options&&this.options.args?this.options.args:[],t=Object.create(null);t.env=Object.assign(Object.assign({},s.deepClone(process.env)),{VSCODE_PARENT_PID:String(process.pid)}),this.options&&this.options.env&&(t.env=Object.assign(Object.assign({},t.env),this.options.env)),this.options&&this.options.freshExecArgv&&(t.execArgv=[]),this.options&&"number"==typeof this.options.debug&&(t.execArgv=["--nolazy","--inspect="+this.options.debug]),this.options&&"number"==typeof this.options.debugBrk&&(t.execArgv=["--nolazy","--inspect-brk="+this.options.debugBrk]),
f.isMacintosh&&t.env&&delete t.env.DYLD_LIBRARY_PATH,this.child=i.fork(this.modulePath,e,t);const r=new o.Emitter;o.Event.fromNodeEventEmitter(this.child,"message",e=>e)(e=>{c.isRemoteConsoleLog(e)?c.log(e,`IPC Library: ${this.options.serverName}`):r.fire(h.VSBuffer.wrap(Buffer.from(e,"base64")))});const u=this.options.useQueue?a.createQueuedSender(this.child):this.child,d={send:e=>this.child&&this.child.connected&&u.send(e.buffer.toString("base64")),onMessage:r.event};this._client=new l.ChannelClient(d);const g=()=>this.disposeClient();process.once("exit",g),this.child.on("error",e=>console.warn('IPC "'+this.options.serverName+'" errored with '+e)),this.child.on("exit",(e,t)=>{process.removeListener("exit",g),this.activeRequests.forEach(e=>n.dispose(e)),this.activeRequests.clear(),0!==e&&"SIGTERM"!==t&&console.warn('IPC "'+this.options.serverName+'" crashed with exit code '+e+" and signal "+t),this.disposeDelayer&&this.disposeDelayer.cancel(),this.disposeClient(),this._onDidProcessExit.fire({code:e,signal:t
})})}return this._client}getCachedChannel(e){let t=this.channels.get(e);return t||(t=this.client.getChannel(e),this.channels.set(e,t)),t}disposeClient(){this._client&&(this.child&&(this.child.kill(),this.child=null),this._client=null,this.channels.clear())}dispose(){this._onDidProcessExit.dispose(),this.disposeDelayer&&(this.disposeDelayer.cancel(),this.disposeDelayer=void 0),this.disposeClient(),this.activeRequests.clear()}}})),define(e[67],t([6,5]),(function(e,t){return e.create("vs/base/node/zip",t)})),define(e[68],t([6,5]),(function(e,t){return e.create("vs/platform/configuration/common/configurationRegistry",t)})),define(e[69],t([6,5]),(function(e,t){return e.create("vs/platform/extensionManagement/common/extensionManagement",t)})),define(e[70],t([6,5]),(function(e,t){return e.create("vs/platform/extensionManagement/node/extensionManagementService",t)})),define(e[71],t([6,5]),(function(e,t){return e.create("vs/platform/extensionManagement/node/extensionManagementUtil",t)})),
define(e[72],t([6,5]),(function(e,t){return e.create("vs/platform/extensionManagement/node/extensionsScanner",t)})),define(e[73],t([6,5]),(function(e,t){return e.create("vs/platform/extensions/common/extensionValidator",t)})),define(e[74],t([6,5]),(function(e,t){return e.create("vs/platform/files/common/fileService",t)})),define(e[75],t([6,5]),(function(e,t){return e.create("vs/platform/files/common/io",t)})),define(e[76],t([6,5]),(function(e,t){return e.create("vs/platform/files/node/diskFileSystemProvider",t)})),define(e[77],t([6,5]),(function(e,t){return e.create("vs/platform/request/common/request",t)})),define(e[78],t([6,5]),(function(e,t){return e.create("vs/platform/telemetry/common/telemetryService",t)})),define(e[79],t([0,1,17]),(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.localizeManifest=void 0;const n=/^%([\w\d.-]+)%$/i;t.localizeManifest=function(e,t){return i.cloneAndChange(e,e=>{if("string"!=typeof e)return;const i=n.exec(e);return i?t[i[1]]||e:void 0})}})),
define(e[43],t([0,1,73]),(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVersionValid=t.isEngineValid=t.isValidExtensionVersion=t.isValidVersion=t.normalizeVersion=t.parseVersion=t.isValidVersionStr=void 0;const n=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/;function r(e){return"*"===(e=e.trim())||n.test(e)}function s(e){if(!r(e))return null;if("*"===(e=e.trim()))return{hasCaret:!1,hasGreaterEquals:!1,majorBase:0,majorMustEqual:!1,minorBase:0,minorMustEqual:!1,patchBase:0,patchMustEqual:!1,preRelease:null};let t=e.match(n);return t?{hasCaret:"^"===t[1],hasGreaterEquals:">="===t[1],majorBase:"x"===t[2]?0:parseInt(t[2],10),majorMustEqual:"x"!==t[2],minorBase:"x"===t[4]?0:parseInt(t[4],10),minorMustEqual:"x"!==t[4],patchBase:"x"===t[6]?0:parseInt(t[6],10),patchMustEqual:"x"!==t[6],preRelease:t[8]||null}:null}function o(e){if(!e)return null;let t=e.majorBase,i=e.majorMustEqual,n=e.minorBase,r=e.minorMustEqual,s=e.patchBase,o=e.patchMustEqual
;return e.hasCaret&&(0===t?o=!1:(r=!1,o=!1)),{majorBase:t,majorMustEqual:i,minorBase:n,minorMustEqual:r,patchBase:s,patchMustEqual:o,isMinimum:e.hasGreaterEquals}}function a(e,t){let i,n;if(i="string"==typeof e?o(s(e)):e,n="string"==typeof t?o(s(t)):t,!i||!n)return!1;let r=i.majorBase,a=i.minorBase,l=i.patchBase,c=n.majorBase,u=n.minorBase,d=n.patchBase,h=n.majorMustEqual,f=n.minorMustEqual,g=n.patchMustEqual;return n.isMinimum?r>c||!(r<c)&&(a>u||!(a<u)&&l>=d):(1!==r||0!==c||h&&f&&g||(c=1,u=0,d=0,h=!0,f=!1,g=!1),!(r<c)&&(r>c?!h:!(a<u)&&(a>u?!f:!(l<d)&&(!(l>d)||!g))))}function l(e,t,n=[]){let r=o(s(t));if(!r)return n.push(i.localize(0,null,t)),!1;if(0===r.majorBase){if(!r.majorMustEqual||!r.minorMustEqual)return n.push(i.localize(1,null,t)),!1}else if(!r.majorMustEqual)return n.push(i.localize(2,null,t)),!1;return!!a(e,r)||(n.push(i.localize(3,null,e,t)),!1)}t.isValidVersionStr=r,t.parseVersion=s,t.normalizeVersion=o,t.isValidVersion=a,t.isValidExtensionVersion=function(e,t,i){
return!(!t.isBuiltin&&void 0!==t.main)||l(e,t.engines.vscode,i)},t.isEngineValid=function(e,t){return"*"===e||l(t,e)},t.isVersionValid=l})),define(e[80],t([0,1,31,42,2,9]),(function(e,t,i,n,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;class o extends r.Disposable{constructor(e,t,i,n){super(),this.folders=e,this.onDidFilesChange=t,this.onLogMessage=i,this.verboseLogging=n,this.isDisposed=!1,this.restartCounter=0,this.startWatching()}startWatching(){const t=this._register(new n.Client(s.FileAccess.asFileUri("bootstrap-fork",e).fsPath,{serverName:"File Watcher (nsfw)",args:["--type=watcherService"],env:{AMD_ENTRYPOINT:"vs/platform/files/node/watcher/nsfw/watcherApp",PIPE_LOGGING:"true",VERBOSE_LOGGING:"true"}}));this._register(t.onDidProcessExit(()=>{this.isDisposed||(this.restartCounter<=o.MAX_RESTARTS?(this.error("terminated unexpectedly and is restarted again..."),this.restartCounter++,
this.startWatching()):this.error("failed to start after retrying for some time, giving up. Please report this as a bug report!"))})),this.service=i.createChannelSender(i.getNextTickChannel(t.getChannel("watcher"))),this.service.setVerboseLogging(this.verboseLogging),this._register(this.service.onDidChangeFile(e=>!this.isDisposed&&this.onDidFilesChange(e))),this._register(this.service.onDidLogMessage(e=>this.onLogMessage(e))),this.setFolders(this.folders)}setVerboseLogging(e){this.verboseLogging=e,!this.isDisposed&&this.service&&this.service.setVerboseLogging(e)}error(e){this.onLogMessage({type:"error",message:`[File Watcher (nsfw)] ${e}`})}setFolders(e){this.folders=e,this.service&&this.service.setRoots(e)}dispose(){this.isDisposed=!0,super.dispose()}}t.FileWatcher=o,o.MAX_RESTARTS=5})),define(e[81],t([0,1,31,42,2,9]),(function(e,t,i,n,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;class o extends r.Disposable{constructor(e,t,i,n,r={}){super(),this.folders=e,
this.onDidFilesChange=t,this.onLogMessage=i,this.verboseLogging=n,this.watcherOptions=r,this.isDisposed=!1,this.restartCounter=0,this.startWatching()}startWatching(){const t=this._register(new n.Client(s.FileAccess.asFileUri("bootstrap-fork",e).fsPath,{serverName:"File Watcher (chokidar)",args:["--type=watcherService"],env:{AMD_ENTRYPOINT:"vs/platform/files/node/watcher/unix/watcherApp",PIPE_LOGGING:"true",VERBOSE_LOGGING:"true"}}));this._register(t.onDidProcessExit(()=>{this.isDisposed||(this.restartCounter<=o.MAX_RESTARTS?(this.error("terminated unexpectedly and is restarted again..."),this.restartCounter++,this.startWatching()):this.error("failed to start after retrying for some time, giving up. Please report this as a bug report!"))})),this.service=i.createChannelSender(i.getNextTickChannel(t.getChannel("watcher"))),this.service.init(Object.assign(Object.assign({},this.watcherOptions),{verboseLogging:this.verboseLogging})),
this._register(this.service.onDidChangeFile(e=>!this.isDisposed&&this.onDidFilesChange(e))),this._register(this.service.onDidLogMessage(e=>this.onLogMessage(e))),this.service.setRoots(this.folders)}error(e){this.onLogMessage({type:"error",message:`[File Watcher (chokidar)] ${e}`})}setVerboseLogging(e){this.verboseLogging=e,this.service&&this.service.setVerboseLogging(e)}setFolders(e){this.folders=e,this.service&&this.service.setRoots(e)}dispose(){this.isDisposed=!0,super.dispose()}}t.FileWatcher=o,o.MAX_RESTARTS=5})),define(e[82],t([0,1,33,40,119,9]),(function(e,t,i,n,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OutOfProcessWin32FolderWatcher=void 0;class o{constructor(e,t,i,n,s){this.watchedFolder=e,this.eventCallback=i,this.logCallback=n,this.verboseLogging=s,this.restartCounter=0,Array.isArray(t)?this.ignored=t.map(e=>r.parse(e)):this.ignored=[],this.verboseLogging&&this.log(`Start watching: ${e}`),this.startWatcher()}startWatcher(){const t=[this.watchedFolder]
;this.verboseLogging&&t.push("-verbose"),this.handle=i.spawn(s.FileAccess.asFileUri("vs/platform/files/node/watcher/win32/CodeHelper.exe",e).fsPath,t);const r=new n.LineDecoder;this.handle.stdout.on("data",e=>{const t=[];r.write(e).forEach(e=>{const i=e.split("|");if(2===i.length){const e=Number(i[0]),n=i[1];if(e>=0&&e<3){if(this.ignored&&this.ignored.some(e=>e(n)))return void(this.verboseLogging&&this.log(n));t.push({type:o.changeTypeMap[e],path:n})}else this.log(i[1])}}),t.length>0&&this.eventCallback(t)}),this.handle.on("error",e=>this.onError(e)),this.handle.stderr.on("data",e=>this.onError(e)),this.handle.on("exit",(e,t)=>this.onExit(e,t))}onError(e){this.error("process error: "+e.toString())}onExit(e,t){this.handle&&(this.error(`terminated unexpectedly (code: ${e}, signal: ${t})`),this.restartCounter<=o.MAX_RESTARTS?(this.error("is restarted again..."),this.restartCounter++,
this.startWatcher()):this.error("Watcher failed to start after retrying for some time, giving up. Please report this as a bug report!"))}error(e){this.logCallback({type:"error",message:`[File Watcher (C#)] ${e}`})}log(e){this.logCallback({type:"trace",message:`[File Watcher (C#)] ${e}`})}dispose(){this.handle&&(this.handle.kill(),this.handle=void 0)}}t.OutOfProcessWin32FolderWatcher=o,o.MAX_RESTARTS=5,o.changeTypeMap=[0,1,2]})),define(e[83],t([0,1,82,3,16]),(function(e,t,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;t.FileWatcher=class{constructor(e,t,i,s){this.onDidFilesChange=t,this.onLogMessage=i,this.verboseLogging=s,this.service=void 0,this.folder=e[0],0===this.folder.path.indexOf("\\\\")&&this.folder.path.endsWith(n.posix.sep)&&(this.folder.path=r.rtrim(this.folder.path,n.posix.sep)),this.service=this.startWatching()}get isDisposed(){return!this.service}startWatching(){
return new i.OutOfProcessWin32FolderWatcher(this.folder.path,this.folder.excludes,e=>this.onFileEvents(e),e=>this.onLogMessage(e),this.verboseLogging)}setVerboseLogging(e){this.verboseLogging=e,this.service&&(this.service.dispose(),this.service=this.startWatching())}onFileEvents(e){this.isDisposed||e.length>0&&this.onDidFilesChange(e)}dispose(){this.service&&(this.service.dispose(),this.service=void 0)}}})),define(e[44],t([0,1]),(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createSyncDescriptor=t.SyncDescriptor=void 0;class i{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}t.SyncDescriptor=i;t.createSyncDescriptor=(e,...t)=>new i(e,t)})),define(e[84],t([0,1]),(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Graph=t.Node=void 0;class i{constructor(e){this.incoming=new Map,this.outgoing=new Map,this.data=e}}t.Node=i;t.Graph=class{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[]
;for(let t of this._nodes.values())0===t.outgoing.size&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(this._hashFn(t),n),n.incoming.set(this._hashFn(e),i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(let e of this._nodes.values())e.outgoing.delete(t),e.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let n=this._nodes.get(t);return n||(n=new i(e),this._nodes.set(t,n)),n}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return 0===this._nodes.size}toString(){let e=[];for(let[t,i]of this._nodes)e.push(`${t}, (incoming)[${[...i.incoming.keys()].join(", ")}], (outgoing)[${[...i.outgoing.keys()].join(",")}]`);return e.join("\n")}}})),define(e[85],t([0,1,4]),(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IDownloadService=void 0,t.IDownloadService=i.createDecorator("downloadService")})),define(e[19],t([0,1,4]),(function(e,t,i){"use strict"
;Object.defineProperty(t,"__esModule",{value:!0}),t.INativeEnvironmentService=t.IEnvironmentService=void 0,t.IEnvironmentService=i.createDecorator("environmentService"),t.INativeEnvironmentService=i.createDecorator("nativeEnvironmentService")})),define(e[24],t([0,1,69,4,9]),(function(e,t,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreferencesLocalizedLabel=t.PreferencesLabel=t.ExtensionsChannelId=t.ExtensionsLocalizedLabel=t.ExtensionsLabel=t.DefaultIconPath=t.IExtensionTipsService=t.IGlobalExtensionEnablementService=t.ENABLED_EXTENSIONS_STORAGE_PATH=t.DISABLED_EXTENSIONS_STORAGE_PATH=t.IExtensionManagementService=t.ExtensionManagementError=t.INSTALL_ERROR_INCOMPATIBLE=t.INSTALL_ERROR_MALICIOUS=t.INSTALL_ERROR_NOT_SUPPORTED=t.IExtensionGalleryService=t.InstallOperation=t.StatisticType=t.SortOrder=t.SortBy=t.isIExtensionIdentifier=t.EXTENSION_IDENTIFIER_REGEX=t.EXTENSION_IDENTIFIER_PATTERN=void 0,
t.EXTENSION_IDENTIFIER_PATTERN="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$",t.EXTENSION_IDENTIFIER_REGEX=new RegExp(t.EXTENSION_IDENTIFIER_PATTERN),t.isIExtensionIdentifier=function(e){return e&&"object"==typeof e&&"string"==typeof e.id&&(!e.uuid||"string"==typeof e.uuid)},function(e){e[e.NoneOrRelevance=0]="NoneOrRelevance",e[e.LastUpdatedDate=1]="LastUpdatedDate",e[e.Title=2]="Title",e[e.PublisherName=3]="PublisherName",e[e.InstallCount=4]="InstallCount",e[e.PublishedDate=5]="PublishedDate",e[e.AverageRating=6]="AverageRating",e[e.WeightedRating=12]="WeightedRating"}(t.SortBy||(t.SortBy={})),function(e){e[e.Default=0]="Default",e[e.Ascending=1]="Ascending",e[e.Descending=2]="Descending"}(t.SortOrder||(t.SortOrder={})),function(e){e.Uninstall="uninstall"}(t.StatisticType||(t.StatisticType={})),function(e){e[e.None=0]="None",e[e.Install=1]="Install",e[e.Update=2]="Update"}(t.InstallOperation||(t.InstallOperation={})),t.IExtensionGalleryService=n.createDecorator("extensionGalleryService"),
t.INSTALL_ERROR_NOT_SUPPORTED="notsupported",t.INSTALL_ERROR_MALICIOUS="malicious",t.INSTALL_ERROR_INCOMPATIBLE="incompatible";class s extends Error{constructor(e,t){super(e),this.code=t}}t.ExtensionManagementError=s,t.IExtensionManagementService=n.createDecorator("extensionManagementService"),t.DISABLED_EXTENSIONS_STORAGE_PATH="extensionsIdentifiers/disabled",t.ENABLED_EXTENSIONS_STORAGE_PATH="extensionsIdentifiers/enabled",t.IGlobalExtensionEnablementService=n.createDecorator("IGlobalExtensionEnablementService"),t.IExtensionTipsService=n.createDecorator("IExtensionTipsService"),t.DefaultIconPath=r.FileAccess.asBrowserUri("./media/defaultIcon.png",e).toString(!0),t.ExtensionsLabel=i.localize(0,null),t.ExtensionsLocalizedLabel={value:t.ExtensionsLabel,original:"Extensions"},t.ExtensionsChannelId="extensions",t.PreferencesLabel=i.localize(1,null),t.PreferencesLocalizedLabel={value:t.PreferencesLabel,original:"Preferences"}})),define(e[34],t([0,1,16,4]),(function(e,t,i,n){"use strict"
;Object.defineProperty(t,"__esModule",{value:!0}),t.IBuiltinExtensionsScannerService=t.isAuthenticaionProviderExtension=t.isLanguagePackExtension=t.ExtensionIdentifier=t.ExtensionType=t.EXTENSION_CATEGORIES=t.isIExtensionIdentifier=t.BUILTIN_MANIFEST_CACHE_FILE=t.USER_MANIFEST_CACHE_FILE=t.MANIFEST_CACHE_FOLDER=void 0,t.MANIFEST_CACHE_FOLDER="CachedExtensions",t.USER_MANIFEST_CACHE_FILE="user",t.BUILTIN_MANIFEST_CACHE_FILE="builtin",t.isIExtensionIdentifier=function(e){return e&&"object"==typeof e&&"string"==typeof e.id&&(!e.uuid||"string"==typeof e.uuid)},t.EXTENSION_CATEGORIES=["Azure","Data Science","Debuggers","Extension Packs","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Themes","Testing","Visualization","Other"],function(e){e[e.System=0]="System",e[e.User=1]="User"}(t.ExtensionType||(t.ExtensionType={}));t.ExtensionIdentifier=class{constructor(e){this.value=e,this._lower=e.toLowerCase()}static equals(e,t){
if(null==e)return null==t;if(null==t)return!1;if("string"==typeof e||"string"==typeof t){let n="string"==typeof e?e:e.value,r="string"==typeof t?t:t.value;return i.equalsIgnoreCase(n,r)}return e._lower===t._lower}static toKey(e){return"string"==typeof e?e.toLowerCase():e._lower}},t.isLanguagePackExtension=function(e){return!(!e.contributes||!e.contributes.localizations)&&e.contributes.localizations.length>0},t.isAuthenticaionProviderExtension=function(e){return!(!e.contributes||!e.contributes.authentication)&&e.contributes.authentication.length>0},t.IBuiltinExtensionsScannerService=n.createDecorator("IBuiltinExtensionsScannerService")})),define(e[25],t([0,1,16,34]),(function(e,t,i,n){"use strict";function r(e,t){return e.uuid&&t.uuid?e.uuid===t.uuid:e.id===t.id||0===i.compareIgnoreCase(e.id,t.id)}Object.defineProperty(t,"__esModule",{value:!0}),
t.getMaliciousExtensionsSet=t.BetterMergeId=t.getGalleryExtensionTelemetryData=t.getLocalExtensionTelemetryData=t.groupByExtension=t.getGalleryExtensionId=t.adoptToGalleryExtensionId=t.ExtensionIdentifierWithVersion=t.areSameExtensions=void 0,t.areSameExtensions=r;class s{constructor(e,t){this.identifier=e,this.version=t}key(){return`${this.identifier.id}-${this.version}`}equals(e){return e instanceof s&&(r(this.identifier,e.identifier)&&this.version===e.version)}}t.ExtensionIdentifierWithVersion=s,t.adoptToGalleryExtensionId=function(e){return e.toLocaleLowerCase()},t.getGalleryExtensionId=function(e,t){return`${e.toLocaleLowerCase()}.${t.toLocaleLowerCase()}`},t.groupByExtension=function(e,t){const i=[],n=e=>{for(const n of i)if(n.some(i=>r(t(i),t(e))))return n;return null};for(const t of e){const e=n(t);e?e.push(t):i.push([t])}return i},t.getLocalExtensionTelemetryData=function(e){return{id:e.identifier.id,name:e.manifest.name,galleryId:null,publisherId:e.publisherId,publisherName:e.manifest.publisher,
publisherDisplayName:e.publisherDisplayName,dependencies:e.manifest.extensionDependencies&&e.manifest.extensionDependencies.length>0}},t.getGalleryExtensionTelemetryData=function(e){return Object.assign({id:e.identifier.id,name:e.name,galleryId:e.identifier.uuid,publisherId:e.publisherId,publisherName:e.publisher,publisherDisplayName:e.publisherDisplayName,dependencies:!!(e.properties.dependencies&&e.properties.dependencies.length>0)},e.telemetryData)},t.BetterMergeId=new n.ExtensionIdentifier("pprice.better-merge"),t.getMaliciousExtensionsSet=function(e){const t=new Set;for(const i of e)i.malicious&&t.add(i.id.id);return t}})),define(e[86],t([0,1,2,3,34,10]),(function(e,t,i,n,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsManifestCache=void 0;class o extends i.Disposable{constructor(e,t){super(),this.environmentService=e,this.extensionsManifestCache=n.join(this.environmentService.userDataPath,r.MANIFEST_CACHE_FOLDER,r.USER_MANIFEST_CACHE_FILE),
this._register(t.onDidInstallExtension(e=>this.onDidInstallExtension(e))),this._register(t.onDidUninstallExtension(e=>this.onDidUnInstallExtension(e)))}onDidInstallExtension(e){e.error||this.invalidate()}onDidUnInstallExtension(e){e.error||this.invalidate()}invalidate(){s.rimraf(this.extensionsManifestCache,s.RimRafMode.MOVE).then(()=>{},()=>{})}}t.ExtensionsManifestCache=o})),define(e[45],t([0,1,75,15,26,20]),(function(e,t,i,n,r,s){"use strict";function o(e){if(e.isCancellationRequested)throw s.canceled();return!0}function a(e,t){if(null==t?void 0:t.limits){if("number"==typeof t.limits.memory&&e>t.limits.memory)throw r.createFileSystemProviderError(i.localize(0,null),r.FileSystemProviderErrorCode.FileExceedsMemoryLimit);if("number"==typeof t.limits.size&&e>t.limits.size)throw r.createFileSystemProviderError(i.localize(1,null),r.FileSystemProviderErrorCode.FileTooLarge)}return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.readFileIntoStream=void 0,t.readFileIntoStream=async function(e,t,i,s,l,c){
let u=void 0;try{await async function(e,t,i,s,l,c){o(c);const u=await e.open(t,{create:!1});o(c);try{let t=0,r=0,d=l&&"number"==typeof l.length?l.length:void 0,h=n.VSBuffer.alloc(Math.min(l.bufferSize,"number"==typeof d?d:l.bufferSize)),f=l&&"number"==typeof l.position?l.position:0,g=0;do{r=await e.read(u,f,h.buffer,g,h.byteLength-g),f+=r,t+=r,"number"==typeof d&&(d-=r),(g+=r)===h.byteLength&&(await i.write(s(h)),h=n.VSBuffer.alloc(Math.min(l.bufferSize,"number"==typeof d?d:l.bufferSize)),g=0)}while(r>0&&("number"!=typeof d||d>0)&&o(c)&&a(t,l));if(g>0){let e=g;"number"==typeof d&&(e=Math.min(g,d)),i.write(s(h.slice(0,e)))}}catch(e){throw r.ensureFileSystemProviderError(e)}finally{await e.close(u)}}(e,t,i,s,l,c)}catch(e){u=e}finally{u&&l.errorTransformer&&(u=l.errorTransformer(u)),i.end(u)}}})),define(e[46],t([0,1,13,26,14]),(function(e,t,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeFileChanges=t.toFileChanges=void 0,t.toFileChanges=function(e){return e.map(e=>({type:e.type,
resource:i.URI.file(e.path)}))},t.normalizeFileChanges=function(e){const t=new s;for(const i of e)t.processEvent(i);return t.normalize()};class s{constructor(){this.normalized=[],this.mapPathToChange=new Map}processEvent(e){const t=this.mapPathToChange.get(e.path);if(t){const i=t.type,n=e.type;1===i&&2===n?(this.mapPathToChange.delete(e.path),this.normalized.splice(this.normalized.indexOf(t),1)):2===i&&1===n?t.type=0:1===i&&0===n||(t.type=n)}else this.normalized.push(e),this.mapPathToChange.set(e.path,e)}normalize(){const e=[],t=[];return this.normalized.filter(t=>2===t.type||(e.push(t),!1)).sort((e,t)=>e.path.length-t.path.length).filter(e=>!t.some(t=>n.isParent(e.path,t,!r.isLinux))&&(t.push(e.path),!0)).concat(e)}}})),define(e[87],t([0,1,46,2,10,59,60,12,3]),(function(e,t,i,n,r,s,o,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileWatcher=void 0;class c extends n.Disposable{constructor(e,t,i,n){super(),this.path=e,this.onDidFilesChange=t,this.onLogMessage=i,this.verboseLogging=n,
this.fileChangesDelayer=this._register(new a.ThrottledDelayer(2*o.CHANGE_BUFFER_DELAY)),this.fileChangesBuffer=[],this.startWatching()}setVerboseLogging(e){this.verboseLogging=e}async startWatching(){try{const{stat:e,symbolicLink:t}=await r.statLink(this.path);if(this.isDisposed)return;let i=this.path;if(t)try{i=await s.realpath(i)}catch(e){this.onError(e)}e.isDirectory()?this._register(o.watchFolder(i,(e,t)=>{this.onFileChange({type:"changed"===e?0:"added"===e?1:2,path:l.join(this.path,l.basename(t))})},e=>this.onError(e))):this._register(o.watchFile(i,e=>{this.onFileChange({type:"changed"===e?0:2,path:this.path})},e=>this.onError(e)))}catch(e){this.onError(e)}}onFileChange(e){this.fileChangesBuffer.push(e),this.verboseLogging&&this.onVerbose(`${1===e.type?"[ADDED]":2===e.type?"[DELETED]":"[CHANGED]"} ${e.path}`),this.fileChangesDelayer.trigger(async()=>{const e=this.fileChangesBuffer;this.fileChangesBuffer=[];const t=i.normalizeFileChanges(e);this.verboseLogging&&t.forEach(e=>{
this.onVerbose(`>> normalized ${1===e.type?"[ADDED]":2===e.type?"[DELETED]":"[CHANGED]"} ${e.path}`)}),t.length>0&&this.onDidFilesChange(t)})}onError(e){this.isDisposed||this.onLogMessage({type:"error",message:`[File Watcher (node.js)] ${e}`})}onVerbose(e){this.isDisposed||this.onLogMessage({type:"trace",message:`[File Watcher (node.js)] ${e}`})}dispose(){this.isDisposed=!0,super.dispose()}}t.FileWatcher=c})),define(e[47],t([0,1]),(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServiceCollection=void 0;t.ServiceCollection=class{constructor(...e){this._entries=new Map;for(let[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}})),define(e[88],t([0,1,20,84,44,4,47,12]),(function(e,t,i,n,r,s,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=void 0;const l=!1;class c extends Error{constructor(e){
super("cyclic dependency between services"),this.message=e.toString()}}class u{constructor(e=new o.ServiceCollection,t=!1,i){this._services=e,this._strict=t,this._parent=i,this._services.set(s.IInstantiationService,this)}createChild(e){return new u(e,this._strict,this)}invokeFunction(e,...t){let n=h.traceInvocation(e),r=!1;try{return e({get:(e,t)=>{if(r)throw i.illegalState("service accessor is only valid during the invocation of its target method");const o=this._getOrCreateServiceInstance(e,n);if(!o&&t!==s.optional)throw new Error(`[invokeFunction] unknown service '${e}'`);return o}},...t)}finally{r=!0,n.stop()}}createInstance(e,...t){let i,n;return e instanceof r.SyncDescriptor?(i=h.traceCreation(e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=h.traceCreation(e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){let n=s._util.getServiceDependencies(e).sort((e,t)=>e.index-t.index),r=[];for(const t of n){let n=this._getOrCreateServiceInstance(t.id,i)
;if(!n&&this._strict&&!t.optional)throw new Error(`[createInstance] ${e.name} depends on UNKNOWN service ${t.id}.`);r.push(n)}let o=n.length>0?n[0].index:t.length;if(t.length!==o){console.warn(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${t.length} static arguments`);let i=o-t.length;t=i>0?t.concat(new Array(i)):t.slice(0,o)}return new e(...[...t,...r])}_setServiceInstance(e,t){if(this._services.get(e)instanceof r.SyncDescriptor)this._services.set(e,t);else{if(!this._parent)throw new Error("illegalState - setting UNKNOWN service instance");this._parent._setServiceInstance(e,t)}}_getServiceInstanceOrDescriptor(e){let t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){let i=this._getServiceInstanceOrDescriptor(e);return i instanceof r.SyncDescriptor?this._createAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_createAndCacheServiceInstance(e,t,i){
const o=new n.Graph(e=>e.id.toString());let a=0;const l=[{id:e,desc:t,_trace:i}];for(;l.length;){const t=l.pop();if(o.lookupOrInsertNode(t),a++>1e3)throw new c(o);for(let i of s._util.getServiceDependencies(t.desc.ctor)){let n=this._getServiceInstanceOrDescriptor(i.id);if(n||i.optional||console.warn(`[createInstance] ${e} depends on ${i.id} which is NOT registered.`),n instanceof r.SyncDescriptor){const e={id:i.id,desc:n,_trace:t._trace.branch(i.id,!0)};o.insertEdge(t,e),l.push(e)}}}for(;;){const e=o.roots();if(0===e.length){if(!o.isEmpty())throw new c(o);break}for(const{data:t}of e){if(this._getServiceInstanceOrDescriptor(t.id)instanceof r.SyncDescriptor){const e=this._createServiceInstanceWithOwner(t.id,t.desc.ctor,t.desc.staticArguments,t.desc.supportsDelayedInstantiation,t._trace);this._setServiceInstance(t.id,e)}o.removeNode(t)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,s){
if(this._services.get(e)instanceof r.SyncDescriptor)return this._createServiceInstance(t,i,n,s);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,s);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t=[],i,n){if(i){const i=new a.IdleValue(()=>this._createInstance(e,t,n));return new Proxy(Object.create(null),{get(e,t){if(t in e)return e[t];let n=i.value,r=n[t];return"function"!=typeof r?r:(r=r.bind(n),e[t]=r,r)},set:(e,t,n)=>(i.value[t]=n,!0)})}return this._createInstance(e,t,n)}}var d;t.InstantiationService=u,function(e){e[e.Creation=0]="Creation",e[e.Invocation=1]="Invocation",e[e.Branch=2]="Branch"}(d||(d={}));class h{constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}static traceInvocation(e){return l?new h(1,e.name||e.toString().substring(0,42).replace(/\n/g,"")):h._None}static traceCreation(e){return l?new h(0,e.name):h._None}branch(e,t){let i=new h(2,e.toString());return this._dep.push([e,t,i]),i}
stop(){let e=Date.now()-this._start;h._totals+=e;let t=!1;let i=[`${0===this.type?"CREATE":"CALL"} ${this.name}`,`${function e(i,n){let r=[],s=new Array(i+1).join("\t");for(const[o,a,l]of n._dep)if(a&&l){t=!0,r.push(`${s}CREATES -> ${o}`);let n=e(i+1,l);n&&r.push(n)}else r.push(`${s}uses -> ${o}`);return r.join("\n")}(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${h._totals.toFixed(2)}ms)`];(e>2||t)&&console.log(i.join("\n"))}}h._None=new class extends h{constructor(){super(-1,null)}stop(){}branch(){return this}},h._totals=0})),define(e[89],t([0,1,4]),(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidLocalization=t.ILocalizationsService=void 0,t.ILocalizationsService=i.createDecorator("localizationsService"),t.isValidLocalization=function(e){if("string"!=typeof e.languageId)return!1;if(!Array.isArray(e.translations)||0===e.translations.length)return!1;for(const t of e.translations){if("string"!=typeof t.id)return!1;if("string"!=typeof t.path)return!1}
return(!e.languageName||"string"==typeof e.languageName)&&(!e.localizedLanguageName||"string"==typeof e.localizedLanguageName)}})),define(e[7],t([0,1,4,2,14,11,32]),(function(e,t,i,n,r,s,o){"use strict";function a(){return(new Date).toISOString()}var l;Object.defineProperty(t,"__esModule",{value:!0}),t.getLogLevel=t.NullLogService=t.DelegatedLogService=t.MultiplexLogService=t.ConsoleLogInMainService=t.LogServiceAdapter=t.ConsoleLogService=t.ConsoleLogMainService=t.AbstractLogService=t.DEFAULT_LOG_LEVEL=t.LogLevel=t.ILoggerService=t.ILogService=void 0,t.ILogService=i.createDecorator("logService"),t.ILoggerService=i.createDecorator("loggerService"),function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.Off=6]="Off"}(l=t.LogLevel||(t.LogLevel={})),t.DEFAULT_LOG_LEVEL=l.Info;class c extends n.Disposable{constructor(){super(...arguments),this.level=t.DEFAULT_LOG_LEVEL,
this._onDidChangeLogLevel=this._register(new s.Emitter),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}}t.AbstractLogService=c;t.ConsoleLogMainService=class extends c{constructor(e=t.DEFAULT_LOG_LEVEL){super(),this.setLevel(e),this.useColors=!r.isWindows}trace(e,...t){this.getLevel()<=l.Trace&&(this.useColors?console.log(`[90m[main ${a()}][0m`,e,...t):console.log(`[main ${a()}]`,e,...t))}debug(e,...t){this.getLevel()<=l.Debug&&(this.useColors?console.log(`[90m[main ${a()}][0m`,e,...t):console.log(`[main ${a()}]`,e,...t))}info(e,...t){this.getLevel()<=l.Info&&(this.useColors?console.log(`[90m[main ${a()}][0m`,e,...t):console.log(`[main ${a()}]`,e,...t))}warn(e,...t){this.getLevel()<=l.Warning&&(this.useColors?console.warn(`[93m[main ${a()}][0m`,e,...t):console.warn(`[main ${a()}]`,e,...t))}error(e,...t){
this.getLevel()<=l.Error&&(this.useColors?console.error(`[91m[main ${a()}][0m`,e,...t):console.error(`[main ${a()}]`,e,...t))}critical(e,...t){this.getLevel()<=l.Critical&&(this.useColors?console.error(`[90m[main ${a()}][0m`,e,...t):console.error(`[main ${a()}]`,e,...t))}dispose(){}flush(){}};t.ConsoleLogService=class extends c{constructor(e=t.DEFAULT_LOG_LEVEL){super(),this.setLevel(e)}trace(e,...t){this.getLevel()<=l.Trace&&console.log("%cTRACE","color: #888",e,...t)}debug(e,...t){this.getLevel()<=l.Debug&&console.log("%cDEBUG","background: #eee; color: #888",e,...t)}info(e,...t){this.getLevel()<=l.Info&&console.log("%c INFO","color: #33f",e,...t)}warn(e,...t){this.getLevel()<=l.Warning&&console.log("%c WARN","color: #993",e,...t)}error(e,...t){this.getLevel()<=l.Error&&console.log("%c  ERR","color: #f33",e,...t)}critical(e,...t){this.getLevel()<=l.Critical&&console.log("%cCRITI","background: #f33; color: white",e,...t)}dispose(){}flush(){}};class u extends c{constructor(e,i=t.DEFAULT_LOG_LEVEL){
super(),this.adapter=e,this.setLevel(i)}trace(e,...t){this.getLevel()<=l.Trace&&this.adapter.consoleLog("trace",[this.extractMessage(e),...t])}debug(e,...t){this.getLevel()<=l.Debug&&this.adapter.consoleLog("debug",[this.extractMessage(e),...t])}info(e,...t){this.getLevel()<=l.Info&&this.adapter.consoleLog("info",[this.extractMessage(e),...t])}warn(e,...t){this.getLevel()<=l.Warning&&this.adapter.consoleLog("warn",[this.extractMessage(e),...t])}error(e,...t){this.getLevel()<=l.Error&&this.adapter.consoleLog("error",[this.extractMessage(e),...t])}critical(e,...t){this.getLevel()<=l.Critical&&this.adapter.consoleLog("critical",[this.extractMessage(e),...t])}extractMessage(e){return"string"==typeof e?e:o.toErrorMessage(e,this.getLevel()<=l.Trace)}dispose(){}flush(){}}t.LogServiceAdapter=u;t.ConsoleLogInMainService=class extends u{constructor(e,i=t.DEFAULT_LOG_LEVEL){super({consoleLog:(t,i)=>e.consoleLog(t,i)},i)}};t.MultiplexLogService=class extends c{constructor(e){super(),this.logServices=e,
e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.logServices)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.logServices)i.trace(e,...t)}debug(e,...t){for(const i of this.logServices)i.debug(e,...t)}info(e,...t){for(const i of this.logServices)i.info(e,...t)}warn(e,...t){for(const i of this.logServices)i.warn(e,...t)}error(e,...t){for(const i of this.logServices)i.error(e,...t)}critical(e,...t){for(const i of this.logServices)i.critical(e,...t)}flush(){for(const e of this.logServices)e.flush()}dispose(){for(const e of this.logServices)e.dispose()}};class d extends n.Disposable{constructor(e){super(),this.logService=e,this._register(e)}get onDidChangeLogLevel(){return this.logService.onDidChangeLogLevel}setLevel(e){this.logService.setLevel(e)}getLevel(){return this.logService.getLevel()}trace(e,...t){this.logService.trace(e,...t)}debug(e,...t){this.logService.debug(e,...t)}info(e,...t){this.logService.info(e,...t)}warn(e,...t){this.logService.warn(e,...t)}
error(e,...t){this.logService.error(e,...t)}critical(e,...t){this.logService.critical(e,...t)}flush(){this.logService.flush()}}t.DelegatedLogService=d;t.NullLogService=class{constructor(){this.onDidChangeLogLevel=(new s.Emitter).event}setLevel(e){}getLevel(){return l.Info}trace(e,...t){}debug(e,...t){}info(e,...t){}warn(e,...t){}error(e,...t){}critical(e,...t){}dispose(){}flush(){}},t.getLogLevel=function(e){if(e.verbose)return l.Trace;if("string"==typeof e.logLevel){switch(e.logLevel.toLowerCase()){case"trace":return l.Trace;case"debug":return l.Debug;case"info":return l.Info;case"warn":return l.Warning;case"error":return l.Error;case"critical":return l.Critical;case"off":return l.Off}}return t.DEFAULT_LOG_LEVEL}}));var i=this&&this.__decorate||function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n
;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},n=this&&this.__param||function(e,t){return function(i,n){t(i,n,e)}};define(e[90],t([0,1,2,26,24,19,13,21,25,7,35,48]),(function(e,t,r,s,o,a,l,c,u,d,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsDownloader=void 0;const g=/^([^.]+\..+)-(\d+\.\d+\.\d+)$/;let p=class extends r.Disposable{constructor(e,t,i,n){super(),this.fileService=t,this.extensionGalleryService=i,this.logService=n,this.extensionsDownloadDir=l.URI.file(e.extensionsDownloadPath),this.cache=20,this.cleanUpPromise=this.cleanUp()}async downloadExtension(e,t){await this.cleanUpPromise;const i=c.joinPath(this.extensionsDownloadDir,this.getName(e));return await this.download(e,i,t),i}async delete(e){}async download(e,t,i){
await this.fileService.exists(t)||await this.extensionGalleryService.download(e,t,i)}async cleanUp(){try{if(!await this.fileService.exists(this.extensionsDownloadDir))return void this.logService.trace("Extension VSIX downlads cache dir does not exist");const e=await this.fileService.resolve(this.extensionsDownloadDir,{resolveMetadata:!0});if(e.children){const t=[],i=[];for(const t of e.children){const e=this.parse(t.name);e&&i.push([e,t])}const n=u.groupByExtension(i,([e])=>e.identifier),r=[];for(const e of n)e.sort((e,t)=>f.rcompare(e[0].version,t[0].version)),t.push(...e.slice(1).map(e=>e[1].resource)),r.push(e[0][1]);r.sort((e,t)=>e.mtime-t.mtime),t.push(...r.slice(0,Math.max(0,r.length-this.cache)).map(e=>e.resource)),await Promise.all(t.map(e=>(this.logService.trace("Deleting vsix from cache",e.path),this.fileService.del(e))))}}catch(e){this.logService.error(e)}}getName(e){return this.cache?new u.ExtensionIdentifierWithVersion(e.identifier,e.version).key().toLowerCase():h.generateUuid()}parse(e){
const t=g.exec(e);return t&&t[1]&&t[2]?new u.ExtensionIdentifierWithVersion({id:t[1]},t[2]):null}};p=i([n(0,a.INativeEnvironmentService),n(1,s.IFileService),n(2,o.IExtensionGalleryService),n(3,d.ILogService)],p),t.ExtensionsDownloader=p})),define(e[91],t([0,1,2,7,33,32,3,12,11,9,10,19]),(function(e,t,r,s,o,a,l,c,u,d,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsLifecycle=void 0;let g=class extends r.Disposable{constructor(e,t){super(),this.environmentService=e,this.logService=t,this.processesLimiter=new c.Limiter(5)}async postUninstall(e){const t=this.parseScript(e,"uninstall");return t&&(this.logService.info(e.identifier.id,e.manifest.version,"Running post uninstall script"),
await this.processesLimiter.queue(()=>this.runLifecycleHook(t.script,"uninstall",t.args,!0,e).then(()=>this.logService.info(e.identifier.id,e.manifest.version,"Finished running post uninstall script"),t=>this.logService.error(e.identifier.id,e.manifest.version,`Failed to run post uninstall script: ${t}`)))),h.rimraf(this.getExtensionStoragePath(e)).then(void 0,e=>this.logService.error("Error while removing extension storage path",e))}parseScript(e,t){const i=`vscode:${t}`;if(e.location.scheme===d.Schemas.file&&e.manifest&&e.manifest.scripts&&"string"==typeof e.manifest.scripts[i]){const t=e.manifest.scripts[i].split(" ");return t.length<2||"node"!==t[0]||!t[1]?(this.logService.warn(e.identifier.id,e.manifest.version,`${i} should be a node script`),null):{script:l.join(e.location.fsPath,t[1]),args:t.slice(2)||[]}}return null}runLifecycleHook(e,t,i,n,r){return new Promise((s,o)=>{const l=this.start(e,t,i,r);let c;const u=e=>{c&&(clearTimeout(c),c=null),e?o(e):s(void 0)};l.on("error",e=>{
u(a.toErrorMessage(e)||"Unknown")}),l.on("exit",(e,i)=>{u(e?`post-${t} process exited with code ${e}`:void 0)}),n&&(c=setTimeout(()=>{c=null,l.kill(),o("timed out")},5e3))})}start(e,t,i,n){const r={silent:!0,execArgv:void 0},s=o.fork(e,[`--type=extension-post-${t}`,...i],r);s.stdout.setEncoding("utf8"),s.stderr.setEncoding("utf8");const a=u.Event.fromNodeEventEmitter(s.stdout,"data"),l=u.Event.fromNodeEventEmitter(s.stderr,"data");a(e=>this.logService.info(n.identifier.id,n.manifest.version,`post-${t}`,e)),l(e=>this.logService.error(n.identifier.id,n.manifest.version,`post-${t}`,e));const c=u.Event.any(u.Event.map(a,e=>({data:`%c${e}`,format:[""]})),u.Event.map(l,e=>({data:`%c${e}`,format:["color: red"]})));return u.Event.debounce(c,(e,t)=>e?{data:e.data+t.data,format:[...e.format,...t.format]}:{data:t.data,format:t.format},100)(e=>{console.group(n.identifier.id),console.log(e.data,...e.format),console.groupEnd()}),s}getExtensionStoragePath(e){
return l.join(this.environmentService.globalStorageHome.fsPath,e.identifier.id.toLowerCase())}};g=i([n(0,f.IEnvironmentService),n(1,s.ILogService)],g),t.ExtensionsLifecycle=g})),define(e[92],t([0,1,2,26,11,21,74,93,18,39,7,15,30,12,28,9,45,120]),(function(e,t,r,s,o,a,l,c,u,d,h,f,g,p,m,v,y,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileService=void 0;let E=class extends r.Disposable{constructor(e){super(),this.logService=e,this.BUFFER_SIZE=65536,this._onDidChangeFileSystemProviderRegistrations=this._register(new o.Emitter),this.onDidChangeFileSystemProviderRegistrations=this._onDidChangeFileSystemProviderRegistrations.event,this._onWillActivateFileSystemProvider=this._register(new o.Emitter),this.onWillActivateFileSystemProvider=this._onWillActivateFileSystemProvider.event,this._onDidChangeFileSystemProviderCapabilities=this._register(new o.Emitter),this.onDidChangeFileSystemProviderCapabilities=this._onDidChangeFileSystemProviderCapabilities.event,this.provider=new Map,
this._onDidRunOperation=this._register(new o.Emitter),this.onDidRunOperation=this._onDidRunOperation.event,this._onError=this._register(new o.Emitter),this.onError=this._onError.event,this._onDidFilesChange=this._register(new o.Emitter),this.onDidFilesChange=this._onDidFilesChange.event,this.activeWatchers=new Map,this.writeQueues=new Map}registerProvider(e,t){if(this.provider.has(e))throw new Error(`A filesystem provider for the scheme '${e}' is already registered.`);this.provider.set(e,t),this._onDidChangeFileSystemProviderRegistrations.fire({added:!0,scheme:e,provider:t});const i=new r.DisposableStore;return i.add(t.onDidChangeFile(e=>this._onDidFilesChange.fire(new s.FileChangesEvent(e,this.getExtUri(t).extUri)))),i.add(t.onDidChangeCapabilities(()=>this._onDidChangeFileSystemProviderCapabilities.fire({provider:t,scheme:e}))),"function"==typeof t.onDidErrorOccur&&i.add(t.onDidErrorOccur(e=>this._onError.fire(new Error(e)))),r.toDisposable(()=>{this._onDidChangeFileSystemProviderRegistrations.fire({
added:!1,scheme:e,provider:t}),this.provider.delete(e),r.dispose(i)})}async activateProvider(e){const t=[];this._onWillActivateFileSystemProvider.fire({scheme:e,join(e){e&&t.push(e)}}),this.provider.has(e)||await Promise.all(t)}canHandleResource(e){return this.provider.has(e.scheme)}hasCapability(e,t){const i=this.provider.get(e.scheme);return!!(i&&i.capabilities&t)}listCapabilities(){return S.Iterable.map(this.provider,([e,t])=>({scheme:e,capabilities:t.capabilities}))}async withProvider(e){if(!a.isAbsolutePath(e))throw new s.FileOperationError(l.localize(0,null,this.resourceForError(e)),8);await this.activateProvider(e.scheme);const t=this.provider.get(e.scheme);if(!t){const t=new Error;throw t.name="ENOPRO",t.message=l.localize(1,null,e.toString()),t}return t}async withReadProvider(e){const t=await this.withProvider(e);if(s.hasOpenReadWriteCloseCapability(t)||s.hasReadWriteCapability(t)||s.hasFileReadStreamCapability(t))return t
;throw new Error(`Filesystem provider for scheme '${e.scheme}' neither has FileReadWrite, FileReadStream nor FileOpenReadWriteClose capability which is needed for the read operation.`)}async withWriteProvider(e){const t=await this.withProvider(e);if(s.hasOpenReadWriteCloseCapability(t)||s.hasReadWriteCapability(t))return t;throw new Error(`Filesystem provider for scheme '${e.scheme}' neither has FileReadWrite nor FileOpenReadWriteClose capability which is needed for the write operation.`)}async resolve(e,t){try{return await this.doResolveFile(e,t)}catch(t){if(s.toFileSystemProviderErrorCode(t)===s.FileSystemProviderErrorCode.FileNotFound)throw new s.FileOperationError(l.localize(2,null,this.resourceForError(e)),1);throw s.ensureFileSystemProviderError(t)}}async doResolveFile(e,t){const i=await this.withProvider(e),n=null==t?void 0:t.resolveTo,r=null==t?void 0:t.resolveSingleChildDescendants,s=null==t?void 0:t.resolveMetadata,o=await i.stat(e);let a
;return this.toFileStat(i,e,o,void 0,!!s,(t,i)=>(a||((a=c.TernarySearchTree.forUris()).set(e,!0),u.isNonEmptyArray(n)&&n.forEach(e=>a.set(e,!0))),!!Boolean(a.findSuperstr(t.resource)||a.get(t.resource))||!(!t.isDirectory||!r)&&1===i))}async toFileStat(e,t,i,n,r,o){const l={resource:t,name:d.getBaseLabel(t),isFile:0!=(i.type&s.FileType.File),isDirectory:0!=(i.type&s.FileType.Directory),isSymbolicLink:0!=(i.type&s.FileType.SymbolicLink),mtime:i.mtime,ctime:i.ctime,size:i.size,etag:s.etag({mtime:i.mtime,size:i.size})};if(l.isDirectory&&o(l,n)){try{const i=await e.readdir(t),n=await Promise.all(i.map(async([n,s])=>{try{const l=a.joinPath(t,n),c=r?await e.stat(l):{type:s};return await this.toFileStat(e,l,c,i.length,r,o)}catch(e){return this.logService.trace(e),null}}));l.children=u.coalesce(n)}catch(e){this.logService.trace(e),l.children=[]}return l}return l}async resolveAll(e){return Promise.all(e.map(async e=>{try{return{stat:await this.doResolveFile(e.resource,e.options),success:!0}}catch(e){
return this.logService.trace(e),{stat:void 0,success:!1}}}))}async exists(e){const t=await this.withProvider(e);try{return!!await t.stat(e)}catch(e){return!1}}async canCreateFile(e,t){try{await this.doValidateCreateFile(e,t)}catch(e){return e}return!0}async doValidateCreateFile(e,t){if(!(null==t?void 0:t.overwrite)&&await this.exists(e))throw new s.FileOperationError(l.localize(3,null,this.resourceForError(e)),3,t)}async createFile(e,t=f.VSBuffer.fromString(""),i){await this.doValidateCreateFile(e,i);const n=await this.writeFile(e,t);return this._onDidRunOperation.fire(new s.FileOperationEvent(e,0,n)),n}async writeFile(e,t,i){const n=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(e),e);try{let r;if(await this.validateWriteFile(n,e,i)||await this.mkdirp(n,a.dirname(e)),!s.hasReadWriteCapability(n)||t instanceof f.VSBuffer)r=t;else if(g.isReadableStream(t)){const e=await g.peekStream(t,3);r=e.ended?f.VSBuffer.concat(e.buffer):e}else r=g.peekReadable(t,e=>f.VSBuffer.concat(e),3)
;!s.hasOpenReadWriteCloseCapability(n)||s.hasReadWriteCapability(n)&&r instanceof f.VSBuffer?await this.doWriteUnbuffered(n,e,r):await this.doWriteBuffered(n,e,r instanceof f.VSBuffer?f.bufferToReadable(r):r)}catch(t){throw new s.FileOperationError(l.localize(4,null,this.resourceForError(e),s.ensureFileSystemProviderError(t).toString()),s.toFileOperationResult(t),i)}return this.resolve(e,{resolveMetadata:!0})}async validateWriteFile(e,t,i){let n=void 0;try{n=await e.stat(t)}catch(e){return}if(0!=(n.type&s.FileType.Directory))throw new s.FileOperationError(l.localize(5,null,this.resourceForError(t)),0,i);if(i&&"number"==typeof i.mtime&&"string"==typeof i.etag&&i.etag!==s.ETAG_DISABLED&&"number"==typeof n.mtime&&"number"==typeof n.size&&i.mtime<n.mtime&&i.etag!==s.etag({mtime:i.mtime,size:n.size}))throw new s.FileOperationError(l.localize(6,null),3,i);return n}async readFile(e,t){const i=await this.withReadProvider(e),n=await this.doReadAsFileStream(i,e,Object.assign(Object.assign({},t),{preferUnbuffered:!0}))
;return Object.assign(Object.assign({},n),{value:await f.streamToBuffer(n.value)})}async readFileStream(e,t){const i=await this.withReadProvider(e);return this.doReadAsFileStream(i,e,t)}async doReadAsFileStream(e,t,i){const n=new m.CancellationTokenSource,r=this.validateReadFile(t,i).then(e=>e,e=>{throw n.cancel(),e});try{let o;i&&"string"==typeof i.etag&&i.etag!==s.ETAG_DISABLED&&await r,o=!s.hasOpenReadWriteCloseCapability(e)&&!s.hasFileReadStreamCapability(e)||s.hasReadWriteCapability(e)&&(null==i?void 0:i.preferUnbuffered)?this.readFileUnbuffered(e,t,i):s.hasFileReadStreamCapability(e)?Promise.resolve(this.readFileStreamed(e,t,n.token,i)):Promise.resolve(this.readFileBuffered(e,t,n.token,i));const[a,l]=await Promise.all([r,o]);return Object.assign(Object.assign({},a),{value:l})}catch(e){throw new s.FileOperationError(l.localize(7,null,this.resourceForError(t),s.ensureFileSystemProviderError(e).toString()),s.toFileOperationResult(e),i)}}readFileStreamed(e,t,i,n=Object.create(null)){
const r=e.readFileStream(t,n,i);return g.transform(r,{data:e=>e instanceof f.VSBuffer?e:f.VSBuffer.wrap(e),error:e=>new s.FileOperationError(l.localize(8,null,this.resourceForError(t),s.ensureFileSystemProviderError(e).toString()),s.toFileOperationResult(e),n)},e=>f.VSBuffer.concat(e))}readFileBuffered(e,t,i,n=Object.create(null)){const r=f.newWriteableBufferStream();return y.readFileIntoStream(e,t,r,e=>e,Object.assign(Object.assign({},n),{bufferSize:this.BUFFER_SIZE,errorTransformer:e=>new s.FileOperationError(l.localize(9,null,this.resourceForError(t),s.ensureFileSystemProviderError(e).toString()),s.toFileOperationResult(e),n)}),i),r}async readFileUnbuffered(e,t,i){let n=await e.readFile(t);return i&&"number"==typeof i.position&&(n=n.slice(i.position)),i&&"number"==typeof i.length&&(n=n.slice(0,i.length)),this.validateReadFileLimits(t,n.byteLength,i),f.bufferToStream(f.VSBuffer.wrap(n))}async validateReadFile(e,t){const i=await this.resolve(e,{resolveMetadata:!0})
;if(i.isDirectory)throw new s.FileOperationError(l.localize(10,null,this.resourceForError(e)),0,t);if(t&&"string"==typeof t.etag&&t.etag!==s.ETAG_DISABLED&&t.etag===i.etag)throw new s.FileOperationError(l.localize(11,null),2,t);return this.validateReadFileLimits(e,i.size,t),i}validateReadFileLimits(e,t,i){if(null==i?void 0:i.limits){let n=void 0;if("number"==typeof i.limits.memory&&t>i.limits.memory&&(n=9),"number"==typeof i.limits.size&&t>i.limits.size&&(n=7),"number"==typeof n)throw new s.FileOperationError(l.localize(12,null,this.resourceForError(e)),n)}}async canMove(e,t,i){return this.doCanMoveCopy(e,t,"move",i)}async canCopy(e,t,i){return this.doCanMoveCopy(e,t,"copy",i)}async doCanMoveCopy(e,t,i,n){if(e.toString()!==t.toString())try{const r="move"===i?this.throwIfFileSystemIsReadonly(await this.withWriteProvider(e),e):await this.withReadProvider(e),s=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(t),t);await this.doValidateMoveCopy(r,e,s,t,i,n)}catch(e){return e}return!0}
async move(e,t,i){const n=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(e),e),r=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(t),t),o=await this.doMoveCopy(n,e,r,t,"move",!!i),a=await this.resolve(t,{resolveMetadata:!0});return this._onDidRunOperation.fire(new s.FileOperationEvent(e,"move"===o?2:3,a)),a}async copy(e,t,i){const n=await this.withReadProvider(e),r=this.throwIfFileSystemIsReadonly(await this.withWriteProvider(t),t),o=await this.doMoveCopy(n,e,r,t,"copy",!!i),a=await this.resolve(t,{resolveMetadata:!0});return this._onDidRunOperation.fire(new s.FileOperationEvent(e,"copy"===o?3:2,a)),a}async doMoveCopy(e,t,i,n,r,o){if(t.toString()===n.toString())return r;const{exists:l,isSameResourceWithDifferentPathCase:c}=await this.doValidateMoveCopy(e,t,i,n,r,o);if(l&&!c&&o&&await this.del(n,{recursive:!0}),await this.mkdirp(i,a.dirname(n)),"copy"===r){if(e===i&&s.hasFileFolderCopyCapability(e))await e.copy(t,n,{overwrite:o});else{const r=await this.resolve(t)
;r.isDirectory?await this.doCopyFolder(e,r,i,n):await this.doCopyFile(e,t,i,n)}return r}return e===i?(await e.rename(t,n,{overwrite:o}),r):(await this.doMoveCopy(e,t,i,n,"copy",o),await this.del(t,{recursive:!0}),"copy")}async doCopyFile(e,t,i,n){return s.hasOpenReadWriteCloseCapability(e)&&s.hasOpenReadWriteCloseCapability(i)?this.doPipeBuffered(e,t,i,n):s.hasOpenReadWriteCloseCapability(e)&&s.hasReadWriteCapability(i)?this.doPipeBufferedToUnbuffered(e,t,i,n):s.hasReadWriteCapability(e)&&s.hasOpenReadWriteCloseCapability(i)?this.doPipeUnbufferedToBuffered(e,t,i,n):s.hasReadWriteCapability(e)&&s.hasReadWriteCapability(i)?this.doPipeUnbuffered(e,t,i,n):void 0}async doCopyFolder(e,t,i,n){await i.mkdir(n),Array.isArray(t.children)&&await Promise.all(t.children.map(async t=>{const r=a.joinPath(n,t.name);return t.isDirectory?this.doCopyFolder(e,await this.resolve(t.resource),i,r):this.doCopyFile(e,t.resource,i,r)}))}async doValidateMoveCopy(e,t,i,n,r,o){let a=!1;if(e===i){
const{extUri:i,isPathCaseSensitive:s}=this.getExtUri(e);if(s||(a=i.isEqual(t,n)),a&&"copy"===r)throw new Error(l.localize(13,null,this.resourceForError(t),this.resourceForError(n)));if(!a&&i.isEqualOrParent(n,t))throw new Error(l.localize(14,null,this.resourceForError(t),this.resourceForError(n)))}const c=await this.exists(n);if(c&&!a){if(!o)throw new s.FileOperationError(l.localize(15,null,this.resourceForError(t),this.resourceForError(n)),4);if(e===i){const{extUri:i}=this.getExtUri(e);if(i.isEqualOrParent(t,n))throw new Error(l.localize(16,null,this.resourceForError(t),this.resourceForError(n)))}}return{exists:c,isSameResourceWithDifferentPathCase:a}}getExtUri(e){const t=!!(1024&e.capabilities);return{extUri:t?a.extUri:a.extUriIgnorePathCase,isPathCaseSensitive:t}}async createFolder(e){const t=this.throwIfFileSystemIsReadonly(await this.withProvider(e),e);await this.mkdirp(t,e);const i=await this.resolve(e,{resolveMetadata:!0});return this._onDidRunOperation.fire(new s.FileOperationEvent(e,0,i)),i}
async mkdirp(e,t){const i=[],{extUri:n}=this.getExtUri(e);for(;!n.isEqual(t,a.dirname(t));)try{if(0==((await e.stat(t)).type&s.FileType.Directory))throw new Error(l.localize(17,null,this.resourceForError(t)));break}catch(e){if(s.toFileSystemProviderErrorCode(e)!==s.FileSystemProviderErrorCode.FileNotFound)throw e;i.push(a.basename(t)),t=a.dirname(t)}for(let n=i.length-1;n>=0;n--){t=a.joinPath(t,i[n]);try{await e.mkdir(t)}catch(e){if(s.toFileSystemProviderErrorCode(e)!==s.FileSystemProviderErrorCode.FileExists)throw e}}}async canDelete(e,t){try{await this.doValidateDelete(e,t)}catch(e){return e}return!0}async doValidateDelete(e,t){const i=this.throwIfFileSystemIsReadonly(await this.withProvider(e),e);if(!!(null==t?void 0:t.useTrash)&&!(4096&i.capabilities))throw new Error(l.localize(18,null,this.resourceForError(e)));const n=await this.exists(e);if(!n)throw new s.FileOperationError(l.localize(19,null,this.resourceForError(e)),1);if(!!!(null==t?void 0:t.recursive)&&n){const t=await this.resolve(e)
;if(t.isDirectory&&Array.isArray(t.children)&&t.children.length>0)throw new Error(l.localize(20,null,this.resourceForError(e)))}return i}async del(e,t){const i=await this.doValidateDelete(e,t),n=!!(null==t?void 0:t.useTrash),r=!!(null==t?void 0:t.recursive);await i.delete(e,{recursive:r,useTrash:n}),this._onDidRunOperation.fire(new s.FileOperationEvent(e,1))}watch(e,t={recursive:!1,excludes:[]}){let i=!1,n=r.toDisposable(()=>i=!0);return this.doWatch(e,t).then(e=>{i?r.dispose(e):n=e},e=>this.logService.error(e)),r.toDisposable(()=>r.dispose(n))}async doWatch(e,t){const i=await this.withProvider(e),n=this.toWatchKey(i,e,t),s=this.activeWatchers.get(n)||{count:0,disposable:i.watch(e,t)};return this.activeWatchers.has(n)||this.activeWatchers.set(n,s),s.count+=1,r.toDisposable(()=>{s.count--,0===s.count&&(r.dispose(s.disposable),this.activeWatchers.delete(n))})}toWatchKey(e,t,i){const{extUri:n}=this.getExtUri(e);return[n.getComparisonKey(t),String(i.recursive),i.excludes.join()].join()}dispose(){super.dispose(),
this.activeWatchers.forEach(e=>r.dispose(e.disposable)),this.activeWatchers.clear()}ensureWriteQueue(e,t){const{extUri:i}=this.getExtUri(e),n=i.getComparisonKey(t);let s=this.writeQueues.get(n);if(!s){s=new p.Queue,this.writeQueues.set(n,s),o.Event.once(s.onFinished)(()=>{this.writeQueues.delete(n),r.dispose(s)})}return s}async doWriteBuffered(e,t,i){return this.ensureWriteQueue(e,t).queue(async()=>{const n=await e.open(t,{create:!0});try{g.isReadableStream(i)||g.isReadableBufferedStream(i)?await this.doWriteStreamBufferedQueued(e,n,i):await this.doWriteReadableBufferedQueued(e,n,i)}catch(e){throw s.ensureFileSystemProviderError(e)}finally{await e.close(n)}})}async doWriteStreamBufferedQueued(e,t,i){let n,r=0;if(g.isReadableBufferedStream(i)){if(i.buffer.length>0){const n=f.VSBuffer.concat(i.buffer);await this.doWriteBuffer(e,t,n,n.byteLength,r,0),r+=n.byteLength}if(i.ended)return;n=i.stream}else n=i;return new Promise(async(i,s)=>{n.on("data",async i=>{n.pause();try{
await this.doWriteBuffer(e,t,i,i.byteLength,r,0)}catch(e){return s(e)}r+=i.byteLength,setTimeout(()=>n.resume())}),n.on("error",e=>s(e)),n.on("end",()=>i())})}async doWriteReadableBufferedQueued(e,t,i){let n,r=0;for(;null!==(n=i.read());)await this.doWriteBuffer(e,t,n,n.byteLength,r,0),r+=n.byteLength}async doWriteBuffer(e,t,i,n,r,s){let o=0;for(;o<n;){o+=await e.write(t,r+o,i.buffer,s+o,n-o)}}async doWriteUnbuffered(e,t,i){return this.ensureWriteQueue(e,t).queue(()=>this.doWriteUnbufferedQueued(e,t,i))}async doWriteUnbufferedQueued(e,t,i){let n;n=i instanceof f.VSBuffer?i:g.isReadableStream(i)?await f.streamToBuffer(i):g.isReadableBufferedStream(i)?await f.bufferedStreamToBuffer(i):f.readableToBuffer(i),await e.writeFile(t,n.buffer,{create:!0,overwrite:!0})}async doPipeBuffered(e,t,i,n){return this.ensureWriteQueue(i,n).queue(()=>this.doPipeBufferedQueued(e,t,i,n))}async doPipeBufferedQueued(e,t,i,n){let r=void 0,o=void 0;try{r=await e.open(t,{create:!1}),o=await i.open(n,{create:!0})
;const s=f.VSBuffer.alloc(this.BUFFER_SIZE);let a=0,l=0,c=0;do{c=await e.read(r,a,s.buffer,l,s.byteLength-l),await this.doWriteBuffer(i,o,s,c,a,l),a+=c,(l+=c)===s.byteLength&&(l=0)}while(c>0)}catch(e){throw s.ensureFileSystemProviderError(e)}finally{await Promise.all(["number"==typeof r?e.close(r):Promise.resolve(),"number"==typeof o?i.close(o):Promise.resolve()])}}async doPipeUnbuffered(e,t,i,n){return this.ensureWriteQueue(i,n).queue(()=>this.doPipeUnbufferedQueued(e,t,i,n))}async doPipeUnbufferedQueued(e,t,i,n){return i.writeFile(n,await e.readFile(t),{create:!0,overwrite:!0})}async doPipeUnbufferedToBuffered(e,t,i,n){return this.ensureWriteQueue(i,n).queue(()=>this.doPipeUnbufferedToBufferedQueued(e,t,i,n))}async doPipeUnbufferedToBufferedQueued(e,t,i,n){const r=await i.open(n,{create:!0});try{const n=await e.readFile(t);await this.doWriteBuffer(i,r,f.VSBuffer.wrap(n),n.byteLength,0,0)}catch(e){throw s.ensureFileSystemProviderError(e)}finally{await i.close(r)}}async doPipeBufferedToUnbuffered(e,t,i,n){
const r=await f.streamToBuffer(this.readFileBuffered(e,t,m.CancellationToken.None));await this.doWriteUnbuffered(i,n,r)}throwIfFileSystemIsReadonly(e,t){if(2048&e.capabilities)throw new s.FileOperationError(l.localize(21,null,this.resourceForError(t)),6);return e}resourceForError(e){return e.scheme===v.Schemas.file?e.fsPath:e.toString(!0)}};E=i([n(0,h.ILogService)],E),t.FileService=E})),define(e[94],t([0,1,23,41,2,26,11,14,10,3,21,66,12,7,76,46,81,83,80,87,30,45,18,15]),(function(e,t,i,n,r,s,o,a,l,c,u,d,h,f,g,p,m,v,y,S,E,w,b,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DiskFileSystemProvider=void 0;class x extends r.Disposable{constructor(e,t){var i;super(),this.logService=e,this.options=t,this.BUFFER_SIZE=(null===(i=this.options)||void 0===i?void 0:i.bufferSize)||65536,this.onDidChangeCapabilities=o.Event.None,this.mapHandleToPos=new Map,this.writeHandles=new Set,this.canFlush=!0,this._onDidWatchErrorOccur=this._register(new o.Emitter),
this.onDidErrorOccur=this._onDidWatchErrorOccur.event,this._onDidChangeFile=this._register(new o.Emitter),this.onDidChangeFile=this._onDidChangeFile.event,this.recursiveFoldersToWatch=[],this.recursiveWatchRequestDelayer=this._register(new h.ThrottledDelayer(0))}get capabilities(){return this._capabilities||(this._capabilities=30,a.isLinux&&(this._capabilities|=1024)),this._capabilities}async stat(e){try{const{stat:t,symbolicLink:i}=await l.statLink(this.toFilePath(e));return{type:this.toType(t,i),ctime:t.birthtime.getTime(),mtime:t.mtime.getTime(),size:t.size}}catch(e){throw this.toFileSystemProviderError(e)}}async readdir(e){try{const t=await l.readdirWithFileTypes(this.toFilePath(e)),i=[];return await Promise.all(t.map(async t=>{try{let n;n=t.isSymbolicLink()?(await this.stat(u.joinPath(e,t.name))).type:this.toType(t),i.push([t.name,n])}catch(e){this.logService.trace(e)}})),i}catch(e){throw this.toFileSystemProviderError(e)}}toType(e,t){let i
;return i=(null==t?void 0:t.dangling)?s.FileType.Unknown:e.isFile()?s.FileType.File:e.isDirectory()?s.FileType.Directory:s.FileType.Unknown,t&&(i|=s.FileType.SymbolicLink),i}async readFile(e){try{const t=this.toFilePath(e);return await l.readFile(t)}catch(e){throw this.toFileSystemProviderError(e)}}readFileStream(e,t,i){const n=E.newWriteableStream(e=>C.VSBuffer.concat(e.map(e=>C.VSBuffer.wrap(e))).buffer);return w.readFileIntoStream(this,e,n,e=>e.buffer,Object.assign(Object.assign({},t),{bufferSize:this.BUFFER_SIZE}),i),n}async writeFile(e,t,i){let n=void 0;try{const r=this.toFilePath(e);if(!i.create||!i.overwrite){if(await l.exists(r)){if(!i.overwrite)throw s.createFileSystemProviderError(g.localize(0,null),s.FileSystemProviderErrorCode.FileExists)}else if(!i.create)throw s.createFileSystemProviderError(g.localize(1,null),s.FileSystemProviderErrorCode.FileNotFound)}n=await this.open(e,{create:!0}),await this.write(n,0,t,0,t.byteLength)}catch(e){throw this.toFileSystemProviderError(e)}finally{
"number"==typeof n&&await this.close(n)}}async open(e,t){try{const r=this.toFilePath(e);let s=void 0;if(t.create){if(a.isWindows&&await l.exists(r))try{await l.truncate(r,0),s="r+"}catch(e){this.logService.trace(e)}s||(s="w")}else s="r";const o=await n.promisify(i.open)(r,s);return this.mapHandleToPos.set(o,0),t.create&&this.writeHandles.add(o),o}catch(e){throw this.toFileSystemProviderError(e)}}async close(e){try{if(this.mapHandleToPos.delete(e),this.writeHandles.delete(e)&&this.canFlush)try{await n.promisify(i.fdatasync)(e)}catch(e){this.canFlush=!1,this.logService.error(e)}return await n.promisify(i.close)(e)}catch(e){throw this.toFileSystemProviderError(e)}}async read(e,t,r,s,o){const a=this.normalizePos(e,t);let l=null;try{const t=await n.promisify(i.read)(e,r,s,o,a);return l="number"==typeof t?t:t.bytesRead}catch(e){throw this.toFileSystemProviderError(e)}finally{this.updatePos(e,a,l)}}normalizePos(e,t){return t===this.mapHandleToPos.get(e)?null:t}updatePos(e,t,i){const n=this.mapHandleToPos.get(e)
;"number"==typeof n&&("number"==typeof t||("number"==typeof i?this.mapHandleToPos.set(e,n+i):this.mapHandleToPos.delete(e)))}async write(e,t,i,n,r){return h.retry(()=>this.doWrite(e,t,i,n,r),100,3)}async doWrite(e,t,r,s,o){const a=this.normalizePos(e,t);let l=null;try{const t=await n.promisify(i.write)(e,r,s,o,a);return l="number"==typeof t?t:t.bytesWritten}catch(e){throw this.toFileSystemProviderError(e)}finally{this.updatePos(e,a,l)}}async mkdir(e){try{await n.promisify(i.mkdir)(this.toFilePath(e))}catch(e){throw this.toFileSystemProviderError(e)}}async delete(e,t){try{const i=this.toFilePath(e);await this.doDelete(i,t)}catch(e){throw this.toFileSystemProviderError(e)}}async doDelete(e,t){t.recursive?await l.rimraf(e,l.RimRafMode.MOVE):await l.unlink(e)}async rename(e,t,i){const n=this.toFilePath(e),r=this.toFilePath(t);if(n!==r)try{await this.validateTargetDeleted(e,t,"move",i.overwrite),await l.move(n,r)}catch(e){
throw"EINVAL"!==e.code&&"EBUSY"!==e.code&&"ENAMETOOLONG"!==e.code||(e=new Error(g.localize(2,null,c.basename(n),c.basename(c.dirname(r)),e.toString()))),this.toFileSystemProviderError(e)}}async copy(e,t,i){const n=this.toFilePath(e),r=this.toFilePath(t);if(n!==r)try{await this.validateTargetDeleted(e,t,"copy",i.overwrite),await l.copy(n,r)}catch(e){throw"EINVAL"!==e.code&&"EBUSY"!==e.code&&"ENAMETOOLONG"!==e.code||(e=new Error(g.localize(3,null,c.basename(n),c.basename(c.dirname(r)),e.toString()))),this.toFileSystemProviderError(e)}}async validateTargetDeleted(e,t,i,n){const r=this.toFilePath(e),o=this.toFilePath(t);let a=!1;if(!!(1024&this.capabilities)||(a=d.isEqual(r,o,!0)),a&&"copy"===i)throw s.createFileSystemProviderError(g.localize(4,null),s.FileSystemProviderErrorCode.FileExists);if(!a&&await l.exists(o)){if(!n)throw s.createFileSystemProviderError(g.localize(5,null),s.FileSystemProviderErrorCode.FileExists);await this.delete(t,{recursive:!0,useTrash:!1})}}watch(e,t){
return t.recursive?this.watchRecursive(e,t.excludes):this.watchNonRecursive(e)}watchRecursive(e,t){const i={path:this.toFilePath(e),excludes:t},n=b.insert(this.recursiveFoldersToWatch,i);return this.refreshRecursiveWatchers(),r.toDisposable(()=>{n(),this.refreshRecursiveWatchers()})}refreshRecursiveWatchers(){this.recursiveWatchRequestDelayer.trigger(async()=>{this.doRefreshRecursiveWatchers()})}doRefreshRecursiveWatchers(){var e,t,i;if(this.recursiveWatcher instanceof y.FileWatcher)this.recursiveWatcher.setFolders(this.recursiveFoldersToWatch);else if(r.dispose(this.recursiveWatcher),this.recursiveWatcher=void 0,this.recursiveFoldersToWatch.length>0){let n,r=void 0;(null===(t=null===(e=this.options)||void 0===e?void 0:e.watcher)||void 0===t?void 0:t.usePolling)?(n=m.FileWatcher,r=null===(i=this.options)||void 0===i?void 0:i.watcher):n=1===this.recursiveFoldersToWatch.length?a.isWindows?v.FileWatcher:m.FileWatcher:y.FileWatcher,
this.recursiveWatcher=new n(this.recursiveFoldersToWatch,e=>this._onDidChangeFile.fire(p.toFileChanges(e)),e=>{"error"===e.type&&this._onDidWatchErrorOccur.fire(e.message),this.logService[e.type](e.message)},this.logService.getLevel()===f.LogLevel.Trace,r),this.recursiveWatcherLogLevelListener||(this.recursiveWatcherLogLevelListener=this.logService.onDidChangeLogLevel(()=>{this.recursiveWatcher&&this.recursiveWatcher.setVerboseLogging(this.logService.getLevel()===f.LogLevel.Trace)}))}}watchNonRecursive(e){const t=new S.FileWatcher(this.toFilePath(e),e=>this._onDidChangeFile.fire(p.toFileChanges(e)),e=>{"error"===e.type&&this._onDidWatchErrorOccur.fire(e.message),this.logService[e.type](e.message)},this.logService.getLevel()===f.LogLevel.Trace),i=this.logService.onDidChangeLogLevel(()=>{t.setVerboseLogging(this.logService.getLevel()===f.LogLevel.Trace)});return r.combinedDisposable(t,i)}toFilePath(e){return c.normalize(e.fsPath)}toFileSystemProviderError(e){if(e instanceof s.FileSystemProviderError)return e
;let t;switch(e.code){case"ENOENT":t=s.FileSystemProviderErrorCode.FileNotFound;break;case"EISDIR":t=s.FileSystemProviderErrorCode.FileIsADirectory;break;case"ENOTDIR":t=s.FileSystemProviderErrorCode.FileNotADirectory;break;case"EEXIST":t=s.FileSystemProviderErrorCode.FileExists;break;case"EPERM":case"EACCES":t=s.FileSystemProviderErrorCode.NoPermissions;break;default:t=s.FileSystemProviderErrorCode.Unknown}return s.createFileSystemProviderError(e,t)}dispose(){super.dispose(),r.dispose(this.recursiveWatcher),this.recursiveWatcher=void 0,r.dispose(this.recursiveWatcherLogLevelListener),this.recursiveWatcherLogLevelListener=void 0}}t.DiskFileSystemProvider=x})),define(e[95],t([0,1,10,96,24,2,19,12,25,7,89,18,11,9,3]),(function(e,t,r,s,o,a,l,c,u,d,h,f,g,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalizationsService=void 0;let v=class extends a.Disposable{constructor(e,t,i){super(),this.extensionManagementService=e,this.logService=i,
this._onDidLanguagesChange=this._register(new g.Emitter),this.onDidLanguagesChange=this._onDidLanguagesChange.event,this.cache=this._register(new y(t,i)),this._register(e.onDidInstallExtension(({local:e})=>this.onDidInstallExtension(e))),this._register(e.onDidUninstallExtension(({identifier:e})=>this.onDidUninstallExtension(e)))}getLanguageIds(){return this.cache.getLanguagePacks().then(e=>{const t=["en",...Object.keys(e)];return f.distinct(t)})}onDidInstallExtension(e){e&&e.manifest&&e.manifest.contributes&&e.manifest.contributes.localizations&&e.manifest.contributes.localizations.length&&(this.logService.debug("Adding language packs from the extension",e.identifier.id),this.update().then(e=>{e&&this._onDidLanguagesChange.fire()}))}onDidUninstallExtension(e){this.cache.getLanguagePacks().then(t=>{Object.keys(t).some(i=>t[i]&&t[i].extensions.some(t=>u.areSameExtensions(t.extensionIdentifier,e)))&&(this.logService.debug("Removing language packs from the extension",e.id),this.update().then(e=>{
e&&this._onDidLanguagesChange.fire()}))})}update(){return Promise.all([this.cache.getLanguagePacks(),this.extensionManagementService.getInstalled()]).then(([e,t])=>this.cache.update(t).then(t=>!f.equals(Object.keys(e),Object.keys(t))))}};v=i([n(0,o.IExtensionManagementService),n(1,l.INativeEnvironmentService),n(2,d.ILogService)],v),t.LocalizationsService=v;let y=class extends a.Disposable{constructor(e,t){super(),this.logService=t,this.languagePacks={},this.languagePacksFilePath=m.join(e.userDataPath,"languagepacks.json"),this.languagePacksFileLimiter=new c.Queue}getLanguagePacks(){return this.languagePacksFileLimiter.size||!this.initializedCache?this.withLanguagePacks().then(()=>this.languagePacks):Promise.resolve(this.languagePacks)}update(e){return this.withLanguagePacks(t=>{Object.keys(t).forEach(e=>delete t[e]),this.createLanguagePacksFromExtensions(t,...e)}).then(()=>this.languagePacks)}createLanguagePacksFromExtensions(e,...t){
for(const i of t)i&&i.manifest&&i.manifest.contributes&&i.manifest.contributes.localizations&&i.manifest.contributes.localizations.length&&this.createLanguagePacksFromExtension(e,i);Object.keys(e).forEach(t=>this.updateHash(e[t]))}createLanguagePacksFromExtension(e,t){const i=t.identifier,n=t.manifest.contributes&&t.manifest.contributes.localizations?t.manifest.contributes.localizations:[];for(const r of n)if(t.location.scheme===p.Schemas.file&&h.isValidLocalization(r)){let n=e[r.languageId];n||(n={hash:"",extensions:[],translations:{}},e[r.languageId]=n);let s=n.extensions.filter(e=>u.areSameExtensions(e.extensionIdentifier,i))[0];s?s.version=t.manifest.version:n.extensions.push({extensionIdentifier:i,version:t.manifest.version});for(const e of r.translations)n.translations[e.id]=m.join(t.location.fsPath,e.path)}}updateHash(e){if(e){const t=s.createHash("md5");for(const i of e.extensions)t.update(i.extensionIdentifier.uuid||i.extensionIdentifier.id).update(i.version);e.hash=t.digest("hex")}}
withLanguagePacks(e=(()=>null)){return this.languagePacksFileLimiter.queue(()=>{let t=null;return r.readFile(this.languagePacksFilePath,"utf8").then(void 0,e=>"ENOENT"===e.code?Promise.resolve("{}"):Promise.reject(e)).then(e=>{try{return JSON.parse(e)}catch(e){return{}}}).then(i=>(t=e(i),i)).then(e=>{for(const t of Object.keys(e))e[t]||delete e[t];this.languagePacks=e,this.initializedCache=!0;const t=JSON.stringify(this.languagePacks);return this.logService.debug("Writing language packs",t),r.writeFile(this.languagePacksFilePath,t)}).then(()=>t,e=>this.logService.error(e))})}};y=i([n(0,l.INativeEnvironmentService),n(1,d.ILogService)],y)})),define(e[97],t([0,1,3,7]),(function(e,t,i,n){"use strict";function r(e,t,i){switch(t){case n.LogLevel.Trace:e.trace(i);break;case n.LogLevel.Debug:e.debug(i);break;case n.LogLevel.Info:e.info(i);break;case n.LogLevel.Warning:e.warn(i);break;case n.LogLevel.Error:e.error(i);break;case n.LogLevel.Critical:e.critical(i);break;default:throw new Error("Invalid log level")}}
Object.defineProperty(t,"__esModule",{value:!0}),t.SpdLogService=t.createRotatingLogger=void 0,t.createRotatingLogger=function(t,i,n,r){return e.__$__nodeRequire("spdlog").createRotatingLogger(t,i,n,r)};class s extends n.AbstractLogService{constructor(e,t,i){super(),this.name=e,this.logsFolder=t,this.buffer=[],this._loggerCreationPromise=void 0,this.setLevel(i),this._createSpdLogLogger(),this._register(this.onDidChangeLogLevel(e=>{this._logger&&this._logger.setLevel(e)}))}_createSpdLogLogger(){return this._loggerCreationPromise||(this._loggerCreationPromise=async function(t,n){try{const r=await new Promise((t,i)=>{e(["spdlog"],t,i)});r.setAsyncMode(8192,500);const s=i.join(n,`${t}.log`);return r.createRotatingLoggerAsync(t,s,5242880,6)}catch(e){console.error(e)}return null}(this.name,this.logsFolder).then(e=>{if(e){this._logger=e,this._logger.setLevel(this.getLevel());for(const{level:e,message:t}of this.buffer)r(this._logger,e,t);this.buffer=[]}})),this._loggerCreationPromise}_log(e,t){
this._logger?r(this._logger,e,t):this.getLevel()<=e&&this.buffer.push({level:e,message:t})}trace(e,...t){this.getLevel()<=n.LogLevel.Trace&&this._log(n.LogLevel.Trace,this.format([e,...t]))}debug(e,...t){this.getLevel()<=n.LogLevel.Debug&&this._log(n.LogLevel.Debug,this.format([e,...t]))}info(e,...t){this.getLevel()<=n.LogLevel.Info&&this._log(n.LogLevel.Info,this.format([e,...t]))}warn(e,...t){this.getLevel()<=n.LogLevel.Warning&&this._log(n.LogLevel.Warning,this.format([e,...t]))}error(e,...t){if(this.getLevel()<=n.LogLevel.Error)if(e instanceof Error){const t=Array.prototype.slice.call(arguments);t[0]=e.stack,this._log(n.LogLevel.Error,this.format(t))}else this._log(n.LogLevel.Error,this.format([e,...t]))}critical(e,...t){this.getLevel()<=n.LogLevel.Critical&&this._log(n.LogLevel.Critical,this.format([e,...t]))}flush(){this._logger?this._logger.flush():this._loggerCreationPromise&&this._loggerCreationPromise.then(()=>this.flush())}dispose(){
this._logger?this.disposeLogger():this._loggerCreationPromise&&this._loggerCreationPromise.then(()=>this.disposeLogger()),this._loggerCreationPromise=void 0}disposeLogger(){this._logger&&(this._logger.drop(),this._logger=void 0)}format(e){let t="";for(let i=0;i<e.length;i++){let n=e[i];if("object"==typeof n)try{n=JSON.stringify(n)}catch(e){}t+=(i>0?" ":"")+n}return t}}t.SpdLogService=s})),define(e[98],t([0,1,96,58,99,3,21,54,49,62,14,9,13]),(function(e,t,n,r,s,o,a,l,c,u,d,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUserDataDir=t.parsePathArg=t.parseSearchPort=t.parseExtensionHostPort=t.xdgRuntimeDir=t.NativeEnvironmentService=void 0;class g{constructor(e){if(this._args=e,!process.env.VSCODE_LOGS){const e=u.toLocalISOString(new Date).replace(/-|:|\.\d+Z$/g,"");process.env.VSCODE_LOGS=o.join(this.userDataPath,"logs",e)}this.logsPath=process.env.VSCODE_LOGS}get args(){return this._args}get appRoot(){return o.dirname(h.FileAccess.asFileUri("",e).fsPath)}get userHome(){
return f.URI.file(s.homedir())}get userDataPath(){const e=process.env.VSCODE_PORTABLE;return e?o.join(e,"user-data"):E(this._args,process)}get appSettingsHome(){return f.URI.file(o.join(this.userDataPath,"User"))}get tmpDir(){return f.URI.file(s.tmpdir())}get userRoamingDataHome(){return this.appSettingsHome}get settingsResource(){return a.joinPath(this.userRoamingDataHome,"settings.json")}get userDataSyncHome(){return a.joinPath(this.userRoamingDataHome,"sync")}get userDataSyncLogResource(){return f.URI.file(o.join(this.logsPath,"userDataSync.log"))}get sync(){return this.args.sync}get machineSettingsResource(){return a.joinPath(f.URI.file(o.join(this.userDataPath,"Machine")),"settings.json")}get globalStorageHome(){return f.URI.joinPath(this.appSettingsHome,"globalStorage")}get workspaceStorageHome(){return f.URI.joinPath(this.appSettingsHome,"workspaceStorage")}get keybindingsResource(){return a.joinPath(this.userRoamingDataHome,"keybindings.json")}get keyboardLayoutResource(){
return a.joinPath(this.userRoamingDataHome,"keyboardLayout.json")}get argvResource(){const e=process.env.VSCODE_PORTABLE;return e?f.URI.file(o.join(e,"argv.json")):a.joinPath(this.userHome,c.default.dataFolderName,"argv.json")}get snippetsHome(){return a.joinPath(this.userRoamingDataHome,"snippets")}get isExtensionDevelopment(){return!!this._args.extensionDevelopmentPath}get backupHome(){return o.join(this.userDataPath,"Backups")}get backupWorkspacesPath(){return o.join(this.backupHome,"workspaces.json")}get untitledWorkspacesHome(){return f.URI.file(o.join(this.userDataPath,"Workspaces"))}get installSourcePath(){return o.join(this.userDataPath,"installSource")}get builtinExtensionsPath(){const t=S(this._args["builtin-extensions-dir"],process);return t||o.normalize(o.join(h.FileAccess.asFileUri("",e).fsPath,"..","extensions"))}get extensionsDownloadPath(){const e=S(this._args["extensions-download-dir"],process);return e||o.join(this.userDataPath,"CachedExtensionVSIXs")}get extensionsPath(){
const e=S(this._args["extensions-dir"],process);if(e)return e;const t=process.env.VSCODE_EXTENSIONS;if(t)return t;const i=process.env.VSCODE_PORTABLE;return i?o.join(i,"extensions"):a.joinPath(this.userHome,c.default.dataFolderName,"extensions").fsPath}get extensionDevelopmentLocationURI(){const e=this._args.extensionDevelopmentPath;if(Array.isArray(e))return e.map(e=>/^[^:/?#]+?:\/\//.test(e)?f.URI.parse(e):f.URI.file(o.normalize(e)))}get extensionTestsLocationURI(){const e=this._args.extensionTestsPath;if(e)return/^[^:/?#]+?:\/\//.test(e)?f.URI.parse(e):f.URI.file(o.normalize(e))}get disableExtensions(){if(this._args["disable-extensions"])return!0;const e=this._args["disable-extension"];if(e){if("string"==typeof e)return[e];if(Array.isArray(e)&&e.length>0)return e}return!1}get debugExtensionHost(){return v(this._args,this.isBuilt)}get isBuilt(){return!process.env.VSCODE_DEV}get verbose(){return!!this._args.verbose}get logLevel(){return this._args.log}get mainIPCHandle(){return m(this.userDataPath,"main")}
get sharedIPCHandle(){return m(this.userDataPath,"shared")}get nodeCachedDataDir(){return process.env.VSCODE_NODE_CACHED_DATA_DIR||void 0}get serviceMachineIdResource(){return a.joinPath(f.URI.file(this.userDataPath),"machineid")}get disableUpdates(){return!!this._args["disable-updates"]}get crashReporterId(){return this._args["crash-reporter-id"]}get crashReporterDirectory(){return this._args["crash-reporter-directory"]}get driverHandle(){return this._args.driver}get driverVerbose(){return!!this._args["driver-verbose"]}get disableTelemetry(){return!!this._args["disable-telemetry"]}get sandbox(){return!!this._args.__sandbox}}i([l.memoize],g.prototype,"appRoot",null),i([l.memoize],g.prototype,"userHome",null),i([l.memoize],g.prototype,"userDataPath",null),i([l.memoize],g.prototype,"appSettingsHome",null),i([l.memoize],g.prototype,"tmpDir",null),i([l.memoize],g.prototype,"userRoamingDataHome",null),i([l.memoize],g.prototype,"settingsResource",null),i([l.memoize],g.prototype,"userDataSyncHome",null),
i([l.memoize],g.prototype,"userDataSyncLogResource",null),i([l.memoize],g.prototype,"sync",null),i([l.memoize],g.prototype,"machineSettingsResource",null),i([l.memoize],g.prototype,"globalStorageHome",null),i([l.memoize],g.prototype,"workspaceStorageHome",null),i([l.memoize],g.prototype,"keybindingsResource",null),i([l.memoize],g.prototype,"keyboardLayoutResource",null),i([l.memoize],g.prototype,"argvResource",null),i([l.memoize],g.prototype,"snippetsHome",null),i([l.memoize],g.prototype,"isExtensionDevelopment",null),i([l.memoize],g.prototype,"backupHome",null),i([l.memoize],g.prototype,"backupWorkspacesPath",null),i([l.memoize],g.prototype,"untitledWorkspacesHome",null),i([l.memoize],g.prototype,"installSourcePath",null),i([l.memoize],g.prototype,"builtinExtensionsPath",null),i([l.memoize],g.prototype,"extensionsPath",null),i([l.memoize],g.prototype,"extensionDevelopmentLocationURI",null),i([l.memoize],g.prototype,"extensionTestsLocationURI",null),i([l.memoize],g.prototype,"debugExtensionHost",null),
i([l.memoize],g.prototype,"mainIPCHandle",null),i([l.memoize],g.prototype,"sharedIPCHandle",null),i([l.memoize],g.prototype,"nodeCachedDataDir",null),i([l.memoize],g.prototype,"serviceMachineIdResource",null),t.NativeEnvironmentService=g,t.xdgRuntimeDir=process.env.XDG_RUNTIME_DIR;const p={2:107,1:103};function m(e,i){return d.isWindows?function(e,t){return`\\\\.\\pipe\\${n.createHash("md5").update(e).digest("hex")}-${c.default.version}-${t}-sock`}(e,i):function(e,i){const r=process.env.VSCODE_PORTABLE;let s;if(t.xdgRuntimeDir&&!r){const r=n.createHash("md5").update(e).digest("hex").substr(0,8);s=o.join(t.xdgRuntimeDir,`vscode-${r}-${c.default.version}-${i}.sock`)}else s=o.join(e,`${c.default.version}-${i}.sock`);const a=p[d.platform];return"number"==typeof a&&s.length>=a&&console.warn(`WARNING: IPC handle "${s}" is longer than ${a} chars, try a shorter --user-data-dir`),s}(e,i)}function v(e,t){return y(e["inspect-extensions"],e["inspect-brk-extensions"],5870,t,e.debugId)}function y(e,t,i,n,r){
const s=Number(t||e)||(n?null:i);return{port:s,break:!!s&&Boolean(!!t),debugId:r}}function S(e,t){if(!e)return;const i=o.resolve(e);return o.normalize(e)===i?i:o.resolve(t.env.VSCODE_CWD||t.cwd(),e)}function E(e,t){return S(e["user-data-dir"],t)||o.resolve(r.getDefaultUserDataPath(t.platform))}t.parseExtensionHostPort=v,t.parseSearchPort=function(e,t){return y(e["inspect-search"],e["inspect-brk-search"],5876,t)},t.parsePathArg=S,t.parseUserDataDir=E})),define(e[36],t([0,1,4]),(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IProductService=void 0,t.IProductService=i.createDecorator("productService")})),define(e[22],t([0,1,8,53]),(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Registry=void 0;t.Registry=new class{constructor(){this.data=new Map}add(e,t){n.ok(i.isString(e)),n.ok(i.isObject(t)),n.ok(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}knows(e){return this.data.has(e)}as(e){
return this.data.get(e)||null}}})),define(e[100],t([0,1,22,11]),(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Extensions=void 0,t.Extensions={JSONContribution:"base.contributions.json"};const r=new class{constructor(){this._onDidChangeSchema=new n.Emitter,this.onDidChangeSchema=this._onDidChangeSchema.event,this.schemasById={}}registerSchema(e,t){var i;this.schemasById[(i=e,i.length>0&&"#"===i.charAt(i.length-1)?i.substring(0,i.length-1):i)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}};i.Registry.add(t.Extensions.JSONContribution,r)})),define(e[29],t([0,1,68,11,22,8,100]),(function(e,t,i,n,r,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),
t.getScopes=t.validateProperty=t.getDefaultValue=t.overrideIdentifierFromKey=t.OVERRIDE_PROPERTY_PATTERN=t.resourceLanguageSettingsSchemaId=t.resourceSettings=t.windowSettings=t.machineOverridableSettings=t.machineSettings=t.applicationSettings=t.allSettings=t.ConfigurationScope=t.Extensions=void 0,t.Extensions={Configuration:"base.contributions.configuration"},function(e){e[e.APPLICATION=1]="APPLICATION",e[e.MACHINE=2]="MACHINE",e[e.WINDOW=3]="WINDOW",e[e.RESOURCE=4]="RESOURCE",e[e.LANGUAGE_OVERRIDABLE=5]="LANGUAGE_OVERRIDABLE",e[e.MACHINE_OVERRIDABLE=6]="MACHINE_OVERRIDABLE"}(t.ConfigurationScope||(t.ConfigurationScope={})),t.allSettings={properties:{},patternProperties:{}},t.applicationSettings={properties:{},patternProperties:{}},t.machineSettings={properties:{},patternProperties:{}},t.machineOverridableSettings={properties:{},patternProperties:{}},t.windowSettings={properties:{},patternProperties:{}},t.resourceSettings={properties:{},patternProperties:{}},
t.resourceLanguageSettingsSchemaId="vscode://schemas/settings/resourceLanguage";const a=r.Registry.as(o.Extensions.JSONContribution);function l(e){return e.substring(1,e.length-1)}function c(e){switch(Array.isArray(e)?e[0]:e){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}t.OVERRIDE_PROPERTY_PATTERN=new RegExp("\\[.*\\]$"),t.overrideIdentifierFromKey=l,t.getDefaultValue=c;const u=new class{constructor(){this.overrideIdentifiers=new Set,this._onDidSchemaChange=new n.Emitter,this.onDidSchemaChange=this._onDidSchemaChange.event,this._onDidUpdateConfiguration=new n.Emitter,this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event,this.defaultValues={},this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:i.localize(0,null),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},
patternProperties:{},additionalProperties:!1,errorMessage:"Unknown editor configuration setting",allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.excludedConfigurationProperties={},a.registerSchema(t.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema)}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,i=!0){const n=[];e.forEach(e=>{n.push(...this.validateAndRegisterProperties(e,i)),this.configurationContributors.push(e),this.registerJSONConfiguration(e)}),a.registerSchema(t.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(n)}deregisterConfigurations(e){const i=[],n=e=>{if(e.properties)for(const t in e.properties)i.push(t),delete this.configurationProperties[t],this.removeFromSchema(t,e.properties[t]);e.allOf&&e.allOf.forEach(e=>n(e))};for(const t of e){n(t);const e=this.configurationContributors.indexOf(t)
;-1!==e&&this.configurationContributors.splice(e,1)}a.registerSchema(t.resourceLanguageSettingsSchemaId,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(i)}registerDefaultConfigurations(e){const n=[],r=[];for(const s of e)for(const e in s)if(n.push(e),this.defaultValues[e]=s[e],t.OVERRIDE_PROPERTY_PATTERN.test(e)){const n={type:"object",default:this.defaultValues[e],description:i.localize(1,null,e),$ref:t.resourceLanguageSettingsSchemaId};r.push(l(e)),this.configurationProperties[e]=n,this.defaultLanguageConfigurationOverridesNode.properties[e]=n}else{const t=this.configurationProperties[e];t&&(this.updatePropertyDefaultValue(e,t),this.updateSchema(e,t))}this.registerOverrideIdentifiers(r),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(n)}deregisterDefaultConfigurations(e){const i=[];for(const n of e)for(const e in n)if(i.push(e),delete this.defaultValues[e],t.OVERRIDE_PROPERTY_PATTERN.test(e))delete this.configurationProperties[e],
delete this.defaultLanguageConfigurationOverridesNode.properties[e];else{const t=this.configurationProperties[e];t&&(this.updatePropertyDefaultValue(e,t),this.updateSchema(e,t))}this.updateOverridePropertyPatternKey(),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire(i)}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}validateAndRegisterProperties(e,i=!0,n=3){n=s.isUndefinedOrNull(e.scope)?n:e.scope;let r=[],o=e.properties;if(o)for(let e in o){if(i&&d(e)){delete o[e];continue}const a=o[e];this.updatePropertyDefaultValue(e,a),t.OVERRIDE_PROPERTY_PATTERN.test(e)?a.scope=void 0:a.scope=s.isUndefinedOrNull(a.scope)?n:a.scope,!o[e].hasOwnProperty("included")||o[e].included?(this.configurationProperties[e]=o[e],!o[e].deprecationMessage&&o[e].markdownDeprecationMessage&&(o[e].deprecationMessage=o[e].markdownDeprecationMessage),
r.push(e)):(this.excludedConfigurationProperties[e]=o[e],delete o[e])}let a=e.allOf;if(a)for(let e of a)r.push(...this.validateAndRegisterProperties(e,i,n));return r}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}registerJSONConfiguration(e){const t=e=>{let i=e.properties;if(i)for(const e in i)this.updateSchema(e,i[e]);let n=e.allOf;n&&n.forEach(t)};t(e)}updateSchema(e,i){switch(t.allSettings.properties[e]=i,i.scope){case 1:t.applicationSettings.properties[e]=i;break;case 2:t.machineSettings.properties[e]=i;break;case 6:t.machineOverridableSettings.properties[e]=i;break;case 3:t.windowSettings.properties[e]=i;break;case 4:t.resourceSettings.properties[e]=i;break;case 5:t.resourceSettings.properties[e]=i,this.resourceLanguageSettingsSchema.properties[e]=i}}removeFromSchema(e,i){switch(delete t.allSettings.properties[e],i.scope){case 1:
delete t.applicationSettings.properties[e];break;case 2:delete t.machineSettings.properties[e];break;case 6:delete t.machineOverridableSettings.properties[e];break;case 3:delete t.windowSettings.properties[e];break;case 4:case 5:delete t.resourceSettings.properties[e]}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const n=`[${e}]`,r={type:"object",description:i.localize(2,null),errorMessage:i.localize(3,null),$ref:t.resourceLanguageSettingsSchemaId};this.updatePropertyDefaultValue(n,r),t.allSettings.properties[n]=r,t.applicationSettings.properties[n]=r,t.machineSettings.properties[n]=r,t.machineOverridableSettings.properties[n]=r,t.windowSettings.properties[n]=r,t.resourceSettings.properties[n]=r}this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){let i=this.defaultValues[e];s.isUndefined(i)&&(i=t.default),s.isUndefined(i)&&(i=c(t.type)),t.default=i}};function d(e){
return t.OVERRIDE_PROPERTY_PATTERN.test(e)?i.localize(4,null,e):void 0!==u.getConfigurationProperties()[e]?i.localize(5,null,e):null}r.Registry.add(t.Extensions.Configuration,u),t.validateProperty=d,t.getScopes=function(){const e=[],t=u.getConfigurationProperties();for(const i of Object.keys(t))e.push([i,t[i].scope]);return e.push(["launch",4]),e.push(["task",4]),e}})),define(e[27],t([0,1,17,8,13,22,4,29]),(function(e,t,i,n,r,s,o,a){"use strict";function l(e,t){const i=Object.create(null);for(let n in e)c(i,n,e[n],t);return i}function c(e,t,i,n){const r=t.split("."),s=r.pop();let o=e;for(let e=0;e<r.length;e++){let i=r[e],s=o[i];switch(typeof s){case"undefined":s=o[i]=Object.create(null);break;case"object":break;default:return void n(`Ignoring ${t} as ${r.slice(0,e+1).join(".")} is ${JSON.stringify(s)}`)}o=s}if("object"==typeof o&&null!==o)try{o[s]=i}catch(e){n(`Ignoring ${t} as ${r.join(".")} is ${JSON.stringify(o)}`)}else n(`Ignoring ${t} as ${r.join(".")} is ${JSON.stringify(o)}`)}function u(e,t,i){
const n=function(e,t){let i=e;for(const e of t){if("object"!=typeof i||null===i)return;i=i[e]}return i}(e,t.split("."));return void 0===n?i:n}function d(e){return`[${e}]`}Object.defineProperty(t,"__esModule",{value:!0}),t.getMigratedSettingValue=t.keyFromOverrideIdentifier=t.getDefaultValues=t.getConfigurationKeys=t.merge=t.getConfigurationValue=t.removeFromValueTree=t.addToValueTree=t.toValuesTree=t.toOverrides=t.compare=t.ConfigurationTargetToString=t.ConfigurationTarget=t.isConfigurationOverrides=t.IConfigurationService=void 0,t.IConfigurationService=o.createDecorator("configurationService"),t.isConfigurationOverrides=function(e){return e&&"object"==typeof e&&(!e.overrideIdentifier||"string"==typeof e.overrideIdentifier)&&(!e.resource||e.resource instanceof r.URI)},function(e){e[e.USER=1]="USER",e[e.USER_LOCAL=2]="USER_LOCAL",e[e.USER_REMOTE=3]="USER_REMOTE",e[e.WORKSPACE=4]="WORKSPACE",e[e.WORKSPACE_FOLDER=5]="WORKSPACE_FOLDER",e[e.DEFAULT=6]="DEFAULT",e[e.MEMORY=7]="MEMORY"
}(t.ConfigurationTarget||(t.ConfigurationTarget={})),t.ConfigurationTargetToString=function(e){switch(e){case 1:return"USER";case 2:return"USER_LOCAL";case 3:return"USER_REMOTE";case 4:return"WORKSPACE";case 5:return"WORKSPACE_FOLDER";case 6:return"DEFAULT";case 7:return"MEMORY"}},t.compare=function e(t,n){const r=n?t?n.keys.filter(e=>-1===t.keys.indexOf(e)):[...n.keys]:[],s=t?n?t.keys.filter(e=>-1===n.keys.indexOf(e)):[...t.keys]:[],o=[];if(n&&t)for(const e of t.keys)if(-1!==n.keys.indexOf(e)){const r=u(t.contents,e),s=u(n.contents,e);i.equals(r,s)||o.push(e)}const l=[],c=e=>{const t={};for(const i of e)for(const e of i.identifiers)t[d(e)]=i;return t},h=n?c(n.overrides):{},f=t?c(t.overrides):{};if(Object.keys(h).length)for(const e of r){const t=h[e];t&&l.push([a.overrideIdentifierFromKey(e),t.keys])}if(Object.keys(f).length)for(const e of s){const t=f[e];t&&l.push([a.overrideIdentifierFromKey(e),t.keys])}if(Object.keys(h).length&&Object.keys(f).length)for(const t of o){const i=f[t],n=h[t];if(i&&n){
const r=e({contents:i.contents,keys:i.keys,overrides:[]},{contents:n.contents,keys:n.keys,overrides:[]});l.push([a.overrideIdentifierFromKey(t),[...r.added,...r.removed,...r.updated]])}}return{added:r,removed:s,updated:o,overrides:l}},t.toOverrides=function(e,t){const i=[];for(const n of Object.keys(e))if(a.OVERRIDE_PROPERTY_PATTERN.test(n)){const r={};for(const t in e[n])r[t]=e[n][t];i.push({identifiers:[a.overrideIdentifierFromKey(n).trim()],keys:Object.keys(r),contents:l(r,t)})}return i},t.toValuesTree=l,t.addToValueTree=c,t.removeFromValueTree=function(e,t){!function e(t,i){const n=i.shift();if(0===i.length)return void delete t[n];if(-1!==Object.keys(t).indexOf(n)){const r=t[n];"object"!=typeof r||Array.isArray(r)||(e(r,i),0===Object.keys(r).length&&delete t[n])}}(e,t.split("."))},t.getConfigurationValue=u,t.merge=function e(t,i,r){Object.keys(i).forEach(s=>{"__proto__"!==s&&(s in t?n.isObject(t[s])&&n.isObject(i[s])?e(t[s],i[s],r):r&&(t[s]=i[s]):t[s]=i[s])})},t.getConfigurationKeys=function(){
const e=s.Registry.as(a.Extensions.Configuration).getConfigurationProperties();return Object.keys(e)},t.getDefaultValues=function(){const e=Object.create(null),t=s.Registry.as(a.Extensions.Configuration).getConfigurationProperties();for(let i in t){c(e,i,t[i].default,e=>console.error(`Conflict in default settings: ${e}`))}return e},t.keyFromOverrideIdentifier=d,t.getMigratedSettingValue=function(e,t,i){const n=e.inspect(t),r=e.inspect(i);return void 0!==n.userValue||void 0!==n.workspaceValue||void 0!==n.workspaceFolderValue?n.value:void 0!==r.userValue||void 0!==r.workspaceValue||void 0!==r.workspaceFolderValue?r.value:n.defaultValue}})),define(e[101],t([0,1,55,93,18,8,17,13,29,27,22,2,11,21]),(function(e,t,i,n,r,s,o,a,l,c,u,d,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllKeysConfigurationChangeEvent=t.ConfigurationChangeEvent=t.mergeChanges=t.Configuration=t.UserSettings=t.ConfigurationModelParser=t.DefaultConfigurationModel=t.ConfigurationModel=void 0;class g{
constructor(e={},t=[],i=[]){this._contents=e,this._keys=t,this._overrides=i,this.isFrozen=!1}get contents(){return this.checkAndFreeze(this._contents)}get overrides(){return this.checkAndFreeze(this._overrides)}get keys(){return this.checkAndFreeze(this._keys)}isEmpty(){return 0===this._keys.length&&0===Object.keys(this._contents).length&&0===this._overrides.length}getValue(e){return e?c.getConfigurationValue(this.contents,e):this.contents}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?c.getConfigurationValue(i,e):i:void 0}getKeysForOverrideIdentifier(e){for(const t of this.overrides)if(-1!==t.identifiers.indexOf(e))return t.keys;return[]}override(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||"object"!=typeof t||!Object.keys(t).length)return this;let i={};for(const e of r.distinct([...Object.keys(this.contents),...Object.keys(t)])){let n=this.contents[e],r=t[e];r&&("object"==typeof n&&"object"==typeof r?(n=o.deepClone(n),this.mergeContents(n,r)):n=r),i[e]=n}
return new g(i,this.keys,this.overrides)}merge(...e){const t=o.deepClone(this.contents),i=o.deepClone(this.overrides),n=[...this.keys];for(const s of e){this.mergeContents(t,s.contents);for(const e of s.overrides){const[t]=i.filter(t=>r.equals(t.identifiers,e.identifiers));t?this.mergeContents(t.contents,e.contents):i.push(o.deepClone(e))}for(const e of s.keys)-1===n.indexOf(e)&&n.push(e)}return new g(t,n,i)}freeze(){return this.isFrozen=!0,this}mergeContents(e,t){for(const i of Object.keys(t))i in e&&s.isObject(e[i])&&s.isObject(t[i])?this.mergeContents(e[i],t[i]):e[i]=o.deepClone(t[i])}checkAndFreeze(e){return this.isFrozen&&!Object.isFrozen(e)?o.deepFreeze(e):e}getContentsForOverrideIdentifer(e){for(const t of this.overrides)if(-1!==t.identifiers.indexOf(e))return t.contents;return null}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.addKey(e),c.addToValueTree(this.contents,e,t,e=>{throw new Error(e)})}removeValue(e){
this.removeKey(e)&&c.removeFromValueTree(this.contents,e)}addKey(e){let t=this.keys.length;for(let i=0;i<t;i++)0===e.indexOf(this.keys[i])&&(t=i);this.keys.splice(t,1,e)}removeKey(e){let t=this.keys.indexOf(e);return-1!==t&&(this.keys.splice(t,1),!0)}}t.ConfigurationModel=g;t.DefaultConfigurationModel=class extends g{constructor(){const e=c.getDefaultValues(),t=c.getConfigurationKeys(),i=[];for(const t of Object.keys(e))l.OVERRIDE_PROPERTY_PATTERN.test(t)&&i.push({identifiers:[l.overrideIdentifierFromKey(t).trim()],keys:Object.keys(e[t]),contents:c.toValuesTree(e[t],e=>console.error(`Conflict in default settings file: ${e}`))});super(e,t,i)}};class p{constructor(e,t){this._name=e,this._scopes=t,this._raw=null,this._configurationModel=null,this._parseErrors=[]}get configurationModel(){return this._configurationModel||new g}get errors(){return this._parseErrors}parseContent(e){if(!s.isUndefinedOrNull(e)){const t=this.doParseContent(e);this.parseRaw(t)}}parseRaw(e){this._raw=e;const t=this.doParseRaw(e)
;this._configurationModel=new g(t.contents,t.keys,t.overrides)}parse(){this._raw&&this.parseRaw(this._raw)}doParseContent(e){let t={},n=null,r=[],s=[],o=[];function a(e){Array.isArray(r)?r.push(e):n&&(r[n]=e)}let l={onObjectBegin:()=>{let e={};a(e),s.push(r),r=e,n=null},onObjectProperty:e=>{n=e},onObjectEnd:()=>{r=s.pop()},onArrayBegin:()=>{let e=[];a(e),s.push(r),r=e,n=null},onArrayEnd:()=>{r=s.pop()},onLiteralValue:a,onError:(e,t,i)=>{o.push({error:e,offset:t,length:i})}};if(e)try{i.visit(e,l),t=r[0]||{}}catch(e){console.error(`Error while parsing settings file ${this._name}: ${e}`),this._parseErrors=[e]}return t}doParseRaw(e){if(this._scopes){const t=u.Registry.as(l.Extensions.Configuration).getConfigurationProperties();e=this.filterByScope(e,t,!0,this._scopes)}return{contents:c.toValuesTree(e,e=>console.error(`Conflict in settings file ${this._name}: ${e}`)),keys:Object.keys(e),overrides:c.toOverrides(e,e=>console.error(`Conflict in settings file ${this._name}: ${e}`))}}filterByScope(e,t,i,n){const r={}
;for(let s in e)if(l.OVERRIDE_PROPERTY_PATTERN.test(s)&&i)r[s]=this.filterByScope(e[s],t,!1,n);else{const i=this.getScope(s,t);void 0!==i&&-1===n.indexOf(i)||(r[s]=e[s])}return r}getScope(e,t){const i=t[e];return i?void 0!==i.scope?i.scope:3:void 0}}t.ConfigurationModelParser=p;class m extends d.Disposable{constructor(e,t,i){super(),this.userSettingsResource=e,this.scopes=t,this.fileService=i,this._onDidChange=this._register(new h.Emitter),this.onDidChange=this._onDidChange.event,this.parser=new p(this.userSettingsResource.toString(),this.scopes),this._register(this.fileService.watch(f.dirname(this.userSettingsResource))),this._register(h.Event.filter(this.fileService.onDidFilesChange,e=>e.contains(this.userSettingsResource))(()=>this._onDidChange.fire()))}async loadConfiguration(){try{const e=await this.fileService.readFile(this.userSettingsResource);return this.parser.parseContent(e.value.toString()||"{}"),this.parser.configurationModel}catch(e){return new g}}reprocess(){return this.parser.parse(),
this.parser.configurationModel}}t.UserSettings=m;class v{constructor(e,t,i=new g,r=new g,s=new n.ResourceMap,o=new g,a=new n.ResourceMap,l=!0){this._defaultConfiguration=e,this._localUserConfiguration=t,this._remoteUserConfiguration=i,this._workspaceConfiguration=r,this._folderConfigurations=s,this._memoryConfiguration=o,this._memoryConfigurationByResource=a,this._freeze=l,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new n.ResourceMap,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidateConfigurationModel(t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource))||(n=new g,this._memoryConfigurationByResource.set(i.resource,n)):n=this._memoryConfiguration,void 0===t?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){
const n=this.getConsolidateConfigurationModel(t,i),s=this.getFolderConfigurationModelForResource(t.resource,i),o=t.resource&&this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration,a=t.overrideIdentifier?this._defaultConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this._defaultConfiguration.freeze().getValue(e),l=t.overrideIdentifier?this.userConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this.userConfiguration.freeze().getValue(e),c=t.overrideIdentifier?this.localUserConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this.localUserConfiguration.freeze().getValue(e),u=t.overrideIdentifier?this.remoteUserConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this.remoteUserConfiguration.freeze().getValue(e),d=i?t.overrideIdentifier?this._workspaceConfiguration.freeze().override(t.overrideIdentifier).getValue(e):this._workspaceConfiguration.freeze().getValue(e):void 0,h=s?t.overrideIdentifier?s.freeze().override(t.overrideIdentifier).getValue(e):s.freeze().getValue(e):void 0,f=t.overrideIdentifier?o.override(t.overrideIdentifier).getValue(e):o.getValue(e),g=n.getValue(e),p=r.distinct(r.flatten(n.overrides.map(e=>e.identifiers))).filter(t=>void 0!==n.getOverrideValue(e,t))
;return{defaultValue:a,userValue:l,userLocalValue:c,userRemoteValue:u,workspaceValue:d,workspaceFolderValue:h,memoryValue:f,value:g,default:void 0!==a?{value:this._defaultConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this._defaultConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,user:void 0!==l?{value:this.userConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this.userConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,userLocal:void 0!==c?{value:this.localUserConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this.localUserConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,userRemote:void 0!==u?{value:this.remoteUserConfiguration.freeze().getValue(e),override:t.overrideIdentifier?this.remoteUserConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,workspace:void 0!==d?{value:this._workspaceConfiguration.freeze().getValue(e),
override:t.overrideIdentifier?this._workspaceConfiguration.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,workspaceFolder:void 0!==h?{value:null==s?void 0:s.freeze().getValue(e),override:t.overrideIdentifier?null==s?void 0:s.freeze().getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,memory:void 0!==f?{value:o.getValue(e),override:t.overrideIdentifier?o.getOverrideValue(e,t.overrideIdentifier):void 0}:void 0,overrideIdentifiers:p.length?p:void 0}}keys(e){const t=this.getFolderConfigurationModelForResource(void 0,e);return{default:this._defaultConfiguration.freeze().keys,user:this.userConfiguration.freeze().keys,workspace:this._workspaceConfiguration.freeze().keys,workspaceFolder:t?t.freeze().keys:[]}}updateDefaultConfiguration(e){this._defaultConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(e){this._localUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,
this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(e){this._remoteUserConfiguration=e,this._userConfiguration=null,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(e){this._workspaceConfiguration=e,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(e,t){this._folderConfigurations.set(e,t),this._foldersConsolidatedConfigurations.delete(e)}deleteFolderConfiguration(e){this.folderConfigurations.delete(e),this._foldersConsolidatedConfigurations.delete(e)}compareAndUpdateDefaultConfiguration(e,t){const i=t.filter(e=>l.OVERRIDE_PROPERTY_PATTERN.test(e)).map(t=>{
const i=l.overrideIdentifierFromKey(t),n=this._defaultConfiguration.getKeysForOverrideIdentifier(i),r=e.getKeysForOverrideIdentifier(i),s=[...r.filter(e=>-1===n.indexOf(e)),...n.filter(e=>-1===r.indexOf(e)),...n.filter(t=>!o.equals(this._defaultConfiguration.override(i).getValue(t),e.override(i).getValue(t)))];return[i,s]});return this.updateDefaultConfiguration(e),{keys:t,overrides:i}}compareAndUpdateLocalUserConfiguration(e){const{added:t,updated:i,removed:n,overrides:r}=c.compare(this.localUserConfiguration,e),s=[...t,...i,...n];return s.length&&this.updateLocalUserConfiguration(e),{keys:s,overrides:r}}compareAndUpdateRemoteUserConfiguration(e){const{added:t,updated:i,removed:n,overrides:r}=c.compare(this.remoteUserConfiguration,e);let s=[...t,...i,...n];return s.length&&this.updateRemoteUserConfiguration(e),{keys:s,overrides:r}}compareAndUpdateWorkspaceConfiguration(e){const{added:t,updated:i,removed:n,overrides:r}=c.compare(this.workspaceConfiguration,e);let s=[...t,...i,...n]
;return s.length&&this.updateWorkspaceConfiguration(e),{keys:s,overrides:r}}compareAndUpdateFolderConfiguration(e,t){const i=this.folderConfigurations.get(e),{added:n,updated:r,removed:s,overrides:o}=c.compare(i,t);let a=[...n,...r,...s];return!a.length&&i||this.updateFolderConfiguration(e,t),{keys:a,overrides:o}}compareAndDeleteFolderConfiguration(e){const t=this.folderConfigurations.get(e);if(!t)throw new Error("Unknown folder");this.deleteFolderConfiguration(e);const{added:i,updated:n,removed:r,overrides:s}=c.compare(t,void 0);return{keys:[...i,...n,...r],overrides:s}}get defaults(){return this._defaultConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration),this._freeze&&this._userConfiguration.freeze()),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){
return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidateConfigurationModel(e,t){let i=this.getConsolidatedConfigurationModelForResource(e,t);return e.overrideIdentifier?i.override(e.overrideIdentifier):i}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const r=this._memoryConfigurationByResource.get(e);r&&(i=i.merge(r))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration),this._freeze&&(this._workspaceConfiguration=this._workspaceConfiguration.freeze())),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){
let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._freeze&&(t=t.freeze()),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:n,keys:r}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:r}]),e},[])}}allKeys(){
const e=new Set;return this._defaultConfiguration.freeze().keys.forEach(t=>e.add(t)),this.userConfiguration.freeze().keys.forEach(t=>e.add(t)),this._workspaceConfiguration.freeze().keys.forEach(t=>e.add(t)),this._folderConfigurations.forEach(t=>t.freeze().keys.forEach(t=>e.add(t))),[...e.values()]}getAllKeysForOverrideIdentifier(e){const t=new Set;return this._defaultConfiguration.getKeysForOverrideIdentifier(e).forEach(e=>t.add(e)),this.userConfiguration.getKeysForOverrideIdentifier(e).forEach(e=>t.add(e)),this._workspaceConfiguration.getKeysForOverrideIdentifier(e).forEach(e=>t.add(e)),this._folderConfigurations.forEach(i=>i.getKeysForOverrideIdentifier(e).forEach(e=>t.add(e))),[...t.values()]}static parse(e){const t=this.parseConfigurationModel(e.defaults),i=this.parseConfigurationModel(e.user),r=this.parseConfigurationModel(e.workspace),s=e.folders.reduce((e,t)=>(e.set(a.URI.revive(t[0]),this.parseConfigurationModel(t[1])),e),new n.ResourceMap);return new v(t,i,new g,r,s,new g,new n.ResourceMap,!1)}
static parseConfigurationModel(e){return new g(e.contents,e.keys,e.overrides).freeze()}}t.Configuration=v,t.mergeChanges=function(...e){if(0===e.length)return{keys:[],overrides:[]};if(1===e.length)return e[0];const t=new Set,i=new Map;for(const r of e)r.keys.forEach(e=>t.add(e)),r.overrides.forEach(([e,t])=>{const r=n.getOrSet(i,e,new Set);t.forEach(e=>r.add(e))});const r=[];return i.forEach((e,t)=>r.push([t,[...e.values()]])),{keys:[...t.values()],overrides:r}};class y{constructor(e,t,i,n){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this._previousConfiguration=void 0;const r=new Set;e.keys.forEach(e=>r.add(e)),e.overrides.forEach(([,e])=>e.forEach(e=>r.add(e))),this.affectedKeys=[...r.values()];const s=new g;this.affectedKeys.forEach(e=>s.setValue(e,{})),this.affectedKeysTree=s.contents}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=v.parse(this.previous.data)),this._previousConfiguration}
affectsConfiguration(e,t){var i;if(this.doesAffectedKeysTreeContains(this.affectedKeysTree,e)){if(t){const n=this.previousConfiguration?this.previousConfiguration.getValue(e,t,null===(i=this.previous)||void 0===i?void 0:i.workspace):void 0,r=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!o.equals(n,r)}return!0}return!1}doesAffectedKeysTreeContains(e,t){let i,n=c.toValuesTree({[t]:!0},()=>{});for(;"object"==typeof n&&(i=Object.keys(n)[0]);){if(!(e=e[i]))return!1;n=n[i]}return!0}}t.ConfigurationChangeEvent=y;t.AllKeysConfigurationChangeEvent=class extends y{constructor(e,t,i,n){super({keys:e.allKeys(),overrides:[]},void 0,e,t),this.source=i,this.sourceConfig=n}}})),define(e[102],t([0,1,22,29,2,27,101,11,12]),(function(e,t,i,n,r,s,o,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigurationService=void 0;class c extends r.Disposable{constructor(e,t){super(),this.settingsResource=e,this._onDidChangeConfiguration=this._register(new a.Emitter),
this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this.userConfiguration=this._register(new o.UserSettings(this.settingsResource,void 0,t)),this.configuration=new o.Configuration(new o.DefaultConfigurationModel,new o.ConfigurationModel),this.reloadConfigurationScheduler=this._register(new l.RunOnceScheduler(()=>this.reloadConfiguration(),50)),this._register(i.Registry.as(n.Extensions.Configuration).onDidUpdateConfiguration(e=>this.onDidDefaultConfigurationChange(e))),this._register(this.userConfiguration.onDidChange(()=>this.reloadConfigurationScheduler.schedule()))}async initialize(){const e=await this.userConfiguration.loadConfiguration();this.configuration=new o.Configuration(new o.DefaultConfigurationModel,e)}getConfigurationData(){return this.configuration.toData()}getValue(e,t){const i="string"==typeof e?e:void 0,n=s.isConfigurationOverrides(e)?e:s.isConfigurationOverrides(t)?t:{};return this.configuration.getValue(i,n,void 0)}updateValue(e,t,i,n){
return Promise.reject(new Error("not supported"))}inspect(e){return this.configuration.inspect(e,{},void 0)}keys(){return this.configuration.keys(void 0)}async reloadConfiguration(){const e=await this.userConfiguration.loadConfiguration();this.onDidChangeUserConfiguration(e)}onDidChangeUserConfiguration(e){const t=this.configuration.toData(),i=this.configuration.compareAndUpdateLocalUserConfiguration(e);this.trigger(i,t,1)}onDidDefaultConfigurationChange(e){const t=this.configuration.toData(),i=this.configuration.compareAndUpdateDefaultConfiguration(new o.DefaultConfigurationModel,e);this.trigger(i,t,6)}trigger(e,t,i){const n=new o.ConfigurationChangeEvent(e,{data:t},this.configuration);n.source=i,n.sourceConfig=this.getTargetConfiguration(i),this._onDidChangeConfiguration.fire(n)}getTargetConfiguration(e){switch(e){case 6:return this.configuration.defaults.contents;case 1:return this.configuration.localUserConfiguration.contents}return{}}}t.ConfigurationService=c})),
define(e[50],t([0,1,77,4,29,22,15]),(function(e,t,i,n,r,s,o){"use strict";function a(e){return e.res.statusCode&&e.res.statusCode>=200&&e.res.statusCode<300||1223===e.res.statusCode}function l(e){return 204===e.res.statusCode}Object.defineProperty(t,"__esModule",{value:!0}),t.asJson=t.asText=t.isSuccess=t.IRequestService=void 0,t.IRequestService=n.createDecorator("requestService"),t.isSuccess=a,t.asText=async function(e){if(!a(e))throw new Error("Server returned "+e.res.statusCode);return l(e)?null:(await o.streamToBuffer(e.stream)).toString()},t.asJson=async function(e){if(!a(e))throw new Error("Server returned "+e.res.statusCode);if(l(e))return null;const t=(await o.streamToBuffer(e.stream)).toString();try{return JSON.parse(t)}catch(e){throw e.message+=":\n"+t,e}},s.Registry.as(r.Extensions.Configuration).registerConfiguration({id:"http",order:15,title:i.localize(0,null),type:"object",properties:{"http.proxy":{type:"string",pattern:"^https?://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",
markdownDescription:i.localize(1,null)},"http.proxyStrictSSL":{type:"boolean",default:!0,description:i.localize(2,null)},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:i.localize(3,null)},"http.proxySupport":{type:"string",enum:["off","on","override"],enumDescriptions:[i.localize(4,null),i.localize(5,null),i.localize(6,null)],default:"override",description:i.localize(7,null)},"http.systemCertificates":{type:"boolean",default:!0,description:i.localize(8,null)}}})})),define(e[103],t([0,1,104,8]),(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProxyAgent=void 0,t.getProxyAgent=async function(t,r={}){const s=i.parse(t),o=r.proxyUrl||function(e){return"http:"===e.protocol?process.env.HTTP_PROXY||process.env.http_proxy||null:"https:"===e.protocol&&(process.env.HTTPS_PROXY||process.env.https_proxy||process.env.HTTP_PROXY||process.env.http_proxy)||null}(s);if(!o)return null;const a=i.parse(o);if(!/^https?:$/.test(a.protocol||""))return null
;const l={host:a.hostname||"",port:a.port||("https"===a.protocol?"443":"80"),auth:a.auth,rejectUnauthorized:!n.isBoolean(r.strictSSL)||r.strictSSL};return"http:"===s.protocol?new(await new Promise((t,i)=>{e(["http-proxy-agent"],t,i)}))(l):new(await new Promise((t,i)=>{e(["https-proxy-agent"],t,i)}))(l)}})),define(e[105],t([0,1,35,15]),(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getServiceMachineId=void 0,t.getServiceMachineId=async function(e,t,r){let s=r&&r.get("storage.serviceMachineId",0)||null;if(s)return s;try{const n=(await t.readFile(e.serviceMachineIdResource)).value.toString();s=i.isUUID(n)?n:null}catch(e){s=null}if(!s){s=i.generateUuid();try{await t.writeFile(e.serviceMachineIdResource,n.VSBuffer.fromString(s))}catch(e){}}return r&&r.store("storage.serviceMachineId",s,0),s}})),define(e[106],t([0,1,4]),(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IStateService=void 0,t.IStateService=i.createDecorator("stateService")})),
define(e[107],t([0,1,3,23,19,10,8,7]),(function(e,t,r,s,o,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateService=t.FileStorage=void 0;class u{constructor(e,t){this.dbPath=e,this.onError=t,this._database=null,this.lastFlushedSerializedDatabase=null}get database(){return this._database||(this._database=this.loadSync()),this._database}async init(){if(this._database)return;const e=await this.loadAsync();this._database||(this._database=e)}loadSync(){try{return this.lastFlushedSerializedDatabase=s.readFileSync(this.dbPath).toString(),JSON.parse(this.lastFlushedSerializedDatabase)}catch(e){return"ENOENT"!==e.code&&this.onError(e),{}}}async loadAsync(){try{return this.lastFlushedSerializedDatabase=(await a.readFile(this.dbPath)).toString(),JSON.parse(this.lastFlushedSerializedDatabase)}catch(e){return"ENOENT"!==e.code&&this.onError(e),{}}}getItem(e,t){const i=this.database[e];return l.isUndefinedOrNull(i)?t:i}setItem(e,t){if(l.isUndefinedOrNull(t))return this.removeItem(e)
;("string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||this.database[e]!==t)&&(this.database[e]=t,this.saveSync())}removeItem(e){l.isUndefined(this.database[e])||(this.database[e]=void 0,this.saveSync())}saveSync(){const e=JSON.stringify(this.database,null,4);if(e!==this.lastFlushedSerializedDatabase)try{a.writeFileSync(this.dbPath,e),this.lastFlushedSerializedDatabase=e}catch(e){this.onError(e)}}}t.FileStorage=u;let d=class e{constructor(t,i){this.fileStorage=new u(r.join(t.userDataPath,e.STATE_FILE),e=>i.error(e))}init(){return this.fileStorage.init()}getItem(e,t){return this.fileStorage.getItem(e,t)}setItem(e,t){this.fileStorage.setItem(e,t)}removeItem(e){this.fileStorage.removeItem(e)}};d.STATE_FILE="storage.json",d=i([n(0,o.INativeEnvironmentService),n(1,c.ILogService)],d),t.StateService=d})),define(e[108],t([0,1,4,11,2,8]),(function(e,t,i,n,r,s){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),
t.logStorage=t.InMemoryStorageService=t.StorageScope=t.WillSaveStateReason=t.IStorageService=t.IS_NEW_KEY=void 0,t.IS_NEW_KEY="__$__isNewStorageMarker",t.IStorageService=i.createDecorator("storageService"),function(e){e[e.NONE=0]="NONE",e[e.SHUTDOWN=1]="SHUTDOWN"}(o=t.WillSaveStateReason||(t.WillSaveStateReason={})),function(e){e[e.GLOBAL=0]="GLOBAL",e[e.WORKSPACE=1]="WORKSPACE"}(t.StorageScope||(t.StorageScope={}));class a extends r.Disposable{constructor(){super(...arguments),this._onDidChangeStorage=this._register(new n.Emitter),this.onDidChangeStorage=this._onDidChangeStorage.event,this._onWillSaveState=this._register(new n.Emitter),this.onWillSaveState=this._onWillSaveState.event,this.globalCache=new Map,this.workspaceCache=new Map}getCache(e){return 0===e?this.globalCache:this.workspaceCache}get(e,t,i){const n=this.getCache(t).get(e);return s.isUndefinedOrNull(n)?i:n}getBoolean(e,t,i){const n=this.getCache(t).get(e);return s.isUndefinedOrNull(n)?i:"true"===n}getNumber(e,t,i){
const n=this.getCache(t).get(e);return s.isUndefinedOrNull(n)?i:parseInt(n,10)}store(e,t,i){if(s.isUndefinedOrNull(t))return this.remove(e,i);const n=String(t);return this.getCache(i).get(e)===n?Promise.resolve():(this.getCache(i).set(e,n),this._onDidChangeStorage.fire({scope:i,key:e}),Promise.resolve())}remove(e,t){return this.getCache(t).delete(e)?(this._onDidChangeStorage.fire({scope:t,key:e}),Promise.resolve()):Promise.resolve()}logStorage(){l(this.globalCache,this.workspaceCache,"inMemory","inMemory")}async migrate(e){}flush(){this._onWillSaveState.fire({reason:o.NONE})}isNew(){return!0}async close(){}}async function l(e,t,i,n){const r=e=>{try{return JSON.parse(e)}catch(t){return e}},s=new Map,o=new Map;e.forEach((e,t)=>{s.set(t,e),o.set(t,r(e))});const a=new Map,l=new Map;t.forEach((e,t)=>{a.set(t,e),l.set(t,r(e))}),console.group(`Storage: Global (path: ${i})`);let c=[];s.forEach((e,t)=>{c.push({key:t,value:e})}),console.table(c),console.groupEnd(),console.log(o),
console.group(`Storage: Workspace (path: ${n})`);let u=[];a.forEach((e,t)=>{u.push({key:t,value:e})}),console.table(u),console.groupEnd(),console.log(l)}t.InMemoryStorageService=a,t.logStorage=l})),define(e[37],t([0,1,4]),(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.machineIdKey=t.lastSessionDateStorageKey=t.firstSessionDateStorageKey=t.currentSessionDateStorageKey=t.instanceStorageKey=t.ITelemetryService=void 0,t.ITelemetryService=i.createDecorator("telemetryService"),t.instanceStorageKey="telemetry.instanceId",t.currentSessionDateStorageKey="telemetry.currentSessionDate",t.firstSessionDateStorageKey="telemetry.firstSessionDate",t.lastSessionDateStorageKey="telemetry.lastSessionDate",t.machineIdKey="telemetry.machineId"})),define(e[109],t([0,1,20,24,25,17,37,50,43,19,28,7,26,13,36,108,105,4,21]),(function(e,t,r,s,o,a,l,c,u,d,h,f,g,p,m,v,y,S,E){"use strict";var w,b;Object.defineProperty(t,"__esModule",{value:!0}),t.resolveMarketplaceHeaders=t.ExtensionGalleryService=void 0,
function(e){e[e.None=0]="None",e[e.IncludeVersions=1]="IncludeVersions",e[e.IncludeFiles=2]="IncludeFiles",e[e.IncludeCategoryAndTags=4]="IncludeCategoryAndTags",e[e.IncludeSharedAccounts=8]="IncludeSharedAccounts",e[e.IncludeVersionProperties=16]="IncludeVersionProperties",e[e.ExcludeNonValidated=32]="ExcludeNonValidated",e[e.IncludeInstallationTargets=64]="IncludeInstallationTargets",e[e.IncludeAssetUri=128]="IncludeAssetUri",e[e.IncludeStatistics=256]="IncludeStatistics",e[e.IncludeLatestVersionOnly=512]="IncludeLatestVersionOnly",e[e.Unpublished=4096]="Unpublished"}(w||(w={})),function(e){e[e.Tag=1]="Tag",e[e.ExtensionId=4]="ExtensionId",e[e.Category=5]="Category",e[e.ExtensionName=7]="ExtensionName",e[e.Target=8]="Target",e[e.Featured=9]="Featured",e[e.SearchText=10]="SearchText",e[e.ExcludeWithFlags=12]="ExcludeWithFlags"}(b||(b={}));const C={Icon:"Microsoft.VisualStudio.Services.Icons.Default",Details:"Microsoft.VisualStudio.Services.Content.Details",
Changelog:"Microsoft.VisualStudio.Services.Content.Changelog",Manifest:"Microsoft.VisualStudio.Code.Manifest",VSIX:"Microsoft.VisualStudio.Services.VSIXPackage",License:"Microsoft.VisualStudio.Services.Content.License",Repository:"Microsoft.VisualStudio.Services.Links.Source"},x={Dependency:"Microsoft.VisualStudio.Code.ExtensionDependencies",ExtensionPack:"Microsoft.VisualStudio.Code.ExtensionPack",Engine:"Microsoft.VisualStudio.Code.Engine",LocalizedLanguages:"Microsoft.VisualStudio.Code.LocalizedLanguages",WebExtension:"Microsoft.VisualStudio.Code.WebExtension"},P={pageNumber:1,pageSize:10,sortBy:0,sortOrder:0,flags:w.None,criteria:[],assetTypes:[]};class _{constructor(e=P){this.state=e}get pageNumber(){return this.state.pageNumber}get pageSize(){return this.state.pageSize}get sortBy(){return this.state.sortBy}get sortOrder(){return this.state.sortOrder}get flags(){return this.state.flags}withPage(e,t=this.state.pageSize){return new _(Object.assign(Object.assign({},this.state),{pageNumber:e,pageSize:t}))}
withFilter(e,...t){const i=[...this.state.criteria,...t.length?t.map(t=>({filterType:e,value:t})):[{filterType:e}]];return new _(Object.assign(Object.assign({},this.state),{criteria:i}))}withSortBy(e){return new _(Object.assign(Object.assign({},this.state),{sortBy:e}))}withSortOrder(e){return new _(Object.assign(Object.assign({},this.state),{sortOrder:e}))}withFlags(...e){return new _(Object.assign(Object.assign({},this.state),{flags:e.reduce((e,t)=>e|t,0)}))}withAssetTypes(...e){return new _(Object.assign(Object.assign({},this.state),{assetTypes:e}))}get raw(){const{criteria:e,pageNumber:t,pageSize:i,sortBy:n,sortOrder:r,flags:s,assetTypes:o}=this.state;return{filters:[{criteria:e,pageNumber:t,pageSize:i,sortBy:n,sortOrder:r}],assetTypes:o,flags:s}}get searchText(){const e=this.state.criteria.filter(e=>e.filterType===b.SearchText)[0];return e&&e.value?e.value:""}}function I(e,t){const i=(e||[]).filter(e=>e.statisticName===t)[0];return i?i.value:0}function D(e){
return e.files.filter(e=>0===e.assetType.indexOf("Microsoft.VisualStudio.Code.Translation.")).reduce((t,i)=>{const n=F(e,i.assetType);return n&&t.push([i.assetType.substring("Microsoft.VisualStudio.Code.Translation.".length),n]),t},[])}function O(e){if(e.properties){const t=e.properties.filter(e=>e.key===C.Repository),i=new RegExp("((git|ssh|http(s)?)|(git@[w.]+))(:(//)?)([w.@:/-~]+)(.git)(/)?"),n=t.filter(e=>i.test(e.value))[0];return n?{uri:n.value,fallbackUri:n.value}:null}return F(e,C.Repository)}function L(e){return{uri:`${e.fallbackAssetUri}/${C.VSIX}?redirect=true`,fallbackUri:`${e.fallbackAssetUri}/${C.VSIX}`}}function R(e){const t=F(e,C.Icon);if(t)return t;const i=s.DefaultIconPath;return{uri:i,fallbackUri:i}}function F(e,t){return e.files.filter(e=>e.assetType===t)[0]?{uri:`${e.assetUri}/${t}`,fallbackUri:`${e.fallbackAssetUri}/${t}`}:null}function k(e,t){const i=e.properties?e.properties.filter(e=>e.key===t):[],n=i.length>0&&i[0].value;return n?n.split(",").map(e=>o.adoptToGalleryExtensionId(e)):[]
}function T(e){const t=e.properties?e.properties.filter(e=>e.key===x.Engine):[];return t.length>0&&t[0].value||""}function A(e){const t=e.properties?e.properties.filter(e=>e.key===x.LocalizedLanguages):[],i=t.length>0&&t[0].value||"";return i?i.split(","):[]}function M(e){const t=e.properties?e.properties.find(e=>e.key===x.WebExtension):void 0;return!!t&&"true"===t.value}function U(e){return e.files.some(e=>e.assetType.startsWith("Microsoft.VisualStudio.Code.WebResources"))?E.joinPath(p.URI.parse(e.assetUri),"Microsoft.VisualStudio.Code.WebResources","extension"):void 0}function j(e,t,i,n,r){const s={manifest:F(t,C.Manifest),readme:F(t,C.Details),changelog:F(t,C.Changelog),license:F(t,C.License),repository:O(t),download:L(t),icon:R(t),coreTranslations:D(t)};return{identifier:{id:o.getGalleryExtensionId(e.publisher.publisherName,e.extensionName),uuid:e.extensionId},name:e.extensionName,version:t.version,date:t.lastUpdated,displayName:e.displayName,publisherId:e.publisher.publisherId,
publisher:e.publisher.publisherName,publisherDisplayName:e.publisher.displayName,description:e.shortDescription||"",installCount:I(e.statistics,"install"),rating:I(e.statistics,"averagerating"),ratingCount:I(e.statistics,"ratingcount"),assetUri:p.URI.parse(t.assetUri),webResource:U(t),assetTypes:t.files.map(({assetType:e})=>e),assets:s,properties:{dependencies:k(t,x.Dependency),extensionPack:k(t,x.ExtensionPack),engine:T(t),localizedLanguages:A(t),webExtension:M(t)},telemetryData:{index:(n.pageNumber-1)*n.pageSize+i,searchText:n.searchText,querySource:r},preview:(a=e.flags,-1!==a.indexOf("preview"))};var a}let N=class{constructor(e,t,i,n,r,s,o){this.requestService=e,this.logService=t,this.environmentService=i,this.telemetryService=n,this.fileService=r,this.productService=s;const a=s.extensionsGallery;this.extensionsGalleryUrl=a&&a.serviceUrl,this.extensionsControlUrl=a&&a.controlUrl,this.commonHeadersPromise=z(s.version,this.environmentService,this.fileService,o)}api(e=""){
return`${this.extensionsGalleryUrl}${e}`}isEnabled(){return!!this.extensionsGalleryUrl}async getCompatibleExtension(e,t){const i=await this.getCompatibleExtensionByEngine(e,t);return(null==i?void 0:i.properties.webExtension)?i.webResource?i:null:i}async getCompatibleExtensionByEngine(e,t){const i=s.isIExtensionIdentifier(e)?null:e;if(i&&i.properties.engine&&u.isEngineValid(i.properties.engine,this.productService.version))return i;const{id:n,uuid:r}=i?i.identifier:e;let o=(new _).withFlags(w.IncludeAssetUri,w.IncludeStatistics,w.IncludeFiles,w.IncludeVersionProperties).withPage(1,1).withFilter(b.Target,"Microsoft.VisualStudio.Code");o=r?o.withFilter(b.ExtensionId,r):o.withFilter(b.ExtensionName,n);const{galleryExtensions:a}=await this.queryGallery(o,h.CancellationToken.None),[l]=a;if(!l||!l.versions.length)return null;if(t){const e=l.versions.filter(e=>e.version===t)[0];if(e){const t=j(l,e,0,o);if(t.properties.engine&&u.isEngineValid(t.properties.engine,this.productService.version))return t}return null}
const c=await this.getLastValidExtensionVersion(l,l.versions);return c?j(l,c,0,o):null}async query(e,t){const i=h.CancellationToken.isCancellationToken(e)?{}:e,n=h.CancellationToken.isCancellationToken(e)?e:t;if(!this.isEnabled())throw new Error("No extension gallery service configured.");const s=i.names?"ids":i.text?"text":"all";let o=i.text||"";const l=a.getOrDefault(i,e=>e.pageSize,50);this.telemetryService.publicLog2("galleryService:query",{type:s,text:o});let c=(new _).withFlags(w.IncludeLatestVersionOnly,w.IncludeAssetUri,w.IncludeStatistics,w.IncludeFiles,w.IncludeVersionProperties).withPage(1,l).withFilter(b.Target,"Microsoft.VisualStudio.Code");o?((o=(o=(o=(o=o.replace(/\bcategory:("([^"]*)"|([^"]\S*))(\s+|\b|$)/g,(e,t,i)=>(c=c.withFilter(b.Category,i||t),""))).replace(/\btag:("([^"]*)"|([^"]\S*))(\s+|\b|$)/g,(e,t,i)=>(c=c.withFilter(b.Tag,i||t),""))).replace(/\bfeatured(\s+|\b|$)/g,()=>(c=c.withFilter(b.Featured),""))).trim())&&(o=o.length<200?o:o.substring(0,200),c=c.withFilter(b.SearchText,o)),
c=c.withSortBy(0)):c=i.ids?c.withFilter(b.ExtensionId,...i.ids):i.names?c.withFilter(b.ExtensionName,...i.names):c.withSortBy(4),"number"==typeof i.sortBy&&(c=c.withSortBy(i.sortBy)),"number"==typeof i.sortOrder&&(c=c.withSortOrder(i.sortOrder));const{galleryExtensions:u,total:d}=await this.queryGallery(c,n);return{firstPage:u.map((e,t)=>j(e,e.versions[0],t,c,i.source)),total:d,pageSize:c.pageSize,getPage:async(e,t)=>{if(t.isCancellationRequested)throw r.canceled();const n=c.withPage(e+1),{galleryExtensions:s}=await this.queryGallery(n,t);return s.map((e,t)=>j(e,e.versions[0],t,n,i.source))}}}async queryGallery(e,t){if(!this.isEnabled())throw new Error("No extension gallery service configured.");e=e.withFlags(e.flags,w.ExcludeNonValidated).withFilter(b.ExcludeWithFlags,function(...e){return String(e.reduce((e,t)=>e|t,0))}(w.Unpublished));const i=await this.commonHeadersPromise,n=JSON.stringify(e.raw),r=Object.assign(Object.assign({},i),{"Content-Type":"application/json",
Accept:"application/json;api-version=3.0-preview.1","Accept-Encoding":"gzip","Content-Length":String(n.length)}),s=await this.requestService.request({type:"POST",url:this.api("/extensionquery"),data:n,headers:r},t);if(s.res.statusCode&&s.res.statusCode>=400&&s.res.statusCode<500)return{galleryExtensions:[],total:0};const o=await c.asJson(s);if(o){const e=o.results[0],t=e.extensions,i=e.resultMetadata&&e.resultMetadata.filter(e=>"ResultCount"===e.metadataType)[0];return{galleryExtensions:t,total:i&&i.metadataItems.filter(e=>"TotalCount"===e.name)[0].count||0}}return{galleryExtensions:[],total:0}}async reportStatistic(e,t,i,n){if(!this.isEnabled())return;const r=await this.commonHeadersPromise,s=Object.assign(Object.assign({},r),{Accept:"*/*;api-version=4.0-preview.1"});try{await this.requestService.request({type:"POST",url:this.api(`/publishers/${e}/extensions/${t}/${i}/stats?statType=${n}`),headers:s},h.CancellationToken.None)}catch(e){}}async download(e,t,i){
this.logService.trace("ExtensionGalleryService#download",e.identifier.id);const n=o.getGalleryExtensionTelemetryData(e),r=(new Date).getTime(),s=1===i?"install":2===i?"update":"",a=s?{uri:`${e.assets.download.uri}&${s}=true`,fallbackUri:`${e.assets.download.fallbackUri}?${s}=true`}:e.assets.download,l=await this.getAsset(a);await this.fileService.writeFile(t,l.stream),(e=>this.telemetryService.publicLog("galleryService:downloadVSIX",Object.assign(Object.assign({},n),{duration:e})))((new Date).getTime()-r)}async getReadme(e,t){if(e.assets.readme){const i=await this.getAsset(e.assets.readme,{},t);return await c.asText(i)||""}return""}async getManifest(e,t){if(e.assets.manifest){const i=await this.getAsset(e.assets.manifest,{},t),n=await c.asText(i);return n?JSON.parse(n):null}return null}async getCoreTranslation(e,t){const i=e.assets.coreTranslations.filter(e=>e[0]===t.toUpperCase())[0];if(i){const e=await this.getAsset(i[1]),t=await c.asText(e);return t?JSON.parse(t):null}return null}async getChangelog(e,t){
if(e.assets.changelog){const i=await this.getAsset(e.assets.changelog,{},t);return await c.asText(i)||""}return""}async getAllVersions(e,t){let i=(new _).withFlags(w.IncludeVersions,w.IncludeFiles,w.IncludeVersionProperties).withPage(1,1).withFilter(b.Target,"Microsoft.VisualStudio.Code");i=e.identifier.uuid?i.withFilter(b.ExtensionId,e.identifier.uuid):i.withFilter(b.ExtensionName,e.identifier.id);const n=[],{galleryExtensions:r}=await this.queryGallery(i,h.CancellationToken.None);return r.length&&(t?await Promise.all(r[0].versions.map(async e=>{let t;try{t=await this.getEngine(e)}catch(e){}t&&u.isEngineValid(t,this.productService.version)&&n.push({version:e.version,date:e.lastUpdated})})):n.push(...r[0].versions.map(e=>({version:e.version,date:e.lastUpdated})))),n}async getAsset(e,t={},i=h.CancellationToken.None){const n=await this.commonHeadersPromise,s=Object.assign(Object.assign({},n),t.headers||{});t=Object.assign(Object.assign(Object.assign({},t),{type:"GET"}),{headers:s})
;const o=e.uri,a=e.fallbackUri,l=Object.assign(Object.assign({},t),{url:o});try{const e=await this.requestService.request(l,i);if(200===e.res.statusCode)return e;const t=await c.asText(e);throw new Error(`Expected 200, got back ${e.res.statusCode} instead.\n\n${t}`)}catch(e){if(r.isPromiseCanceledError(e))throw e;const n=r.getErrorMessage(e);this.telemetryService.publicLog2("galleryService:cdnFallback",{url:o,message:n});const s=Object.assign(Object.assign({},t),{url:a});return this.requestService.request(s,i)}}async getLastValidExtensionVersion(e,t){const i=this.getLastValidExtensionVersionFromProperties(e,t);return i||this.getLastValidExtensionVersionRecursively(e,t)}getLastValidExtensionVersionFromProperties(e,t){for(const e of t){const t=T(e);if(!t)return null;if(u.isEngineValid(t,this.productService.version))return e}return null}async getEngine(e){const t=T(e);if(t)return t;const i=F(e,C.Manifest);if(!i)throw new Error("Manifest was not found");const n=await this.getAsset(i,{headers:{
"Accept-Encoding":"gzip"}}),r=await c.asJson(n);if(r)return r.engines.vscode;throw new Error("Error while reading manifest")}async getLastValidExtensionVersionRecursively(e,t){if(!t.length)return null;const i=t[0],n=await this.getEngine(i);return u.isEngineValid(n,this.productService.version)?(i.properties=i.properties||[],i.properties.push({key:x.Engine,value:n}),i):this.getLastValidExtensionVersionRecursively(e,t.slice(1))}async getExtensionsReport(){if(!this.isEnabled())throw new Error("No extension gallery service configured.");if(!this.extensionsControlUrl)return[];const e=await this.requestService.request({type:"GET",url:this.extensionsControlUrl},h.CancellationToken.None);if(200!==e.res.statusCode)throw new Error("Could not get extensions report.");const t=await c.asJson(e),i=new Map;if(t)for(const e of t.malicious){const t=i.get(e)||{id:{id:e},malicious:!0,slow:!1};t.malicious=!0,i.set(e,t)}return[...i.values()]}};async function z(e,t,i,n){const r={"X-Market-Client-Id":`VSCode ${e}`,
"User-Agent":`VSCode ${e}`},s=await y.getServiceMachineId(t,i,n);return r["X-Market-User-Id"]=s,r}N=i([n(0,c.IRequestService),n(1,f.ILogService),n(2,d.IEnvironmentService),n(3,l.ITelemetryService),n(4,g.IFileService),n(5,m.IProductService),n(6,S.optional(v.IStorageService))],N),t.ExtensionGalleryService=N,t.resolveMarketplaceHeaders=z})),define(e[110],t([0,1,78,16,4,27,29,2,17,22]),(function(e,t,r,s,o,a,l,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryService=void 0;let h=class{constructor(e,t){this._configurationService=t,this._experimentProperties={},this._disposables=new c.DisposableStore,this._cleanupPatterns=[],this._appender=e.appender,this._commonProperties=e.commonProperties||Promise.resolve({}),this._piiPaths=e.piiPaths||[],this._userOptIn=!0,this._enabled=!0,this.sendErrorTelemetry=!!e.sendErrorTelemetry,this._cleanupPatterns=[/file:\/\/\/.*?\/resources\/app\//gi];for(let e of this._piiPaths)this._cleanupPatterns.push(new RegExp(s.escapeRegExpCharacters(e),"gi"))
;this._configurationService&&(this._updateUserOptIn(),this._configurationService.onDidChangeConfiguration(this._updateUserOptIn,this,this._disposables),this.publicLog2("optInStatus",{optIn:this._userOptIn}),this._commonProperties.then(e=>{const t=/^[a-f0-9]+$/i.test(e["common.machineId"]);this.publicLog2("machineIdFallback",{usingFallbackGuid:!t})}))}setExperimentProperty(e,t){this._experimentProperties[e]=t}setEnabled(e){this._enabled=e}_updateUserOptIn(){var e;const t=null===(e=this._configurationService)||void 0===e?void 0:e.getValue(f);this._userOptIn=t?t.enableTelemetry:this._userOptIn}get isOptedIn(){return this._userOptIn&&this._enabled}async getTelemetryInfo(){const e=await this._commonProperties;return{sessionId:e.sessionID,instanceId:e["common.instanceId"],machineId:e["common.machineId"],msftInternal:e["common.msftInternal"]}}dispose(){this._disposables.dispose()}publicLog(e,t,i){return this.isOptedIn?this._commonProperties.then(n=>{t=u.mixin(t,n),t=u.mixin(t,this._experimentProperties),
t=u.cloneAndChange(t,e=>{if("string"==typeof e)return this._cleanupInfo(e,i)}),this._appender.log(e,t)},e=>{console.error(e)}):Promise.resolve(void 0)}publicLog2(e,t,i){return this.publicLog(e,t,i)}publicLogError(e,t){return this.sendErrorTelemetry?this.publicLog(e,t,!0):Promise.resolve(void 0)}publicLogError2(e,t){return this.publicLogError(e,t)}_cleanupInfo(e,t){let i=e;if(t){const t=[];for(let i of this._cleanupPatterns)for(;;){const n=i.exec(e);if(!n)break;t.push([n.index,i.lastIndex])}const n=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/,r=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let s=0;for(i="";;){const o=r.exec(e);if(!o)break;!n.test(o[0])&&t.every(([e,t])=>o.index<e||o.index>=t)&&(i+=e.substring(s,o.index)+"<REDACTED: user-file-path>",s=r.lastIndex)}s<e.length&&(i+=e.substr(s))}for(let e of this._cleanupPatterns)i=i.replace(e,"");return i}};h.IDLE_START_EVENT_NAME="UserIdleStart",h.IDLE_STOP_EVENT_NAME="UserIdleStop",
h=i([n(1,o.optional(a.IConfigurationService))],h),t.TelemetryService=h;const f="telemetry";d.Registry.as(l.Extensions.Configuration).registerConfiguration({id:f,order:110,type:"object",title:r.localize(0,null),properties:{"telemetry.enableTelemetry":{type:"boolean",description:r.localize(1,null),default:!0,tags:["usesOnlineServices"]}}})})),define(e[51],t([0,1,27,7,17,8]),(function(e,t,r,s,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cleanRemoteAuthority=t.validateTelemetryData=t.configurationTelemetry=t.LogAppender=t.NullAppender=t.combinedAppender=t.NullTelemetryService=void 0,t.NullTelemetryService=new class{constructor(){this.sendErrorTelemetry=!1,this.isOptedIn=!0}publicLog(e,t){return Promise.resolve(void 0)}publicLog2(e,t){return this.publicLog(e,t)}publicLogError(e,t){return Promise.resolve(void 0)}publicLogError2(e,t){return this.publicLogError(e,t)}setExperimentProperty(){}setEnabled(){}getTelemetryInfo(){return Promise.resolve({instanceId:"someValue.instanceId",
sessionId:"someValue.sessionId",machineId:"someValue.machineId"})}},t.combinedAppender=function(...e){return{log:(t,i)=>e.forEach(e=>e.log(t,i)),flush:()=>Promise.all(e.map(e=>e.flush()))}},t.NullAppender={log:()=>null,flush:()=>Promise.resolve(null)};let l=class{constructor(e){this._logService=e,this.commonPropertiesRegex=/^sessionID$|^version$|^timestamp$|^commitHash$|^common\./}flush(){return Promise.resolve(void 0)}log(e,t){const i={};Object.keys(t).forEach(e=>{this.commonPropertiesRegex.test(e)||(i[e]=t[e])}),this._logService.trace(`telemetry/${e}`,i)}};function c(e){if(!e)return[];const t=[];return function e(t,i,n){n&&"object"==typeof n&&!Array.isArray(n)?Object.keys(n).forEach(r=>e(t,i?`${i}.${r}`:r,n[r])):t.push(i)}(t,"",e),t}l=i([n(0,s.ILogService)],l),t.LogAppender=l,t.configurationTelemetry=function(e,t){return t.onDidChangeConfiguration(t=>{6!==t.source&&e.publicLog2("updateConfiguration",{configurationSource:r.ConfigurationTargetToString(t.source),configurationKeys:c(t.sourceConfig)})})},
t.validateTelemetryData=function(e){const t=Object.create(null),i=Object.create(null),n=Object.create(null);!function e(t,i,n=0,r){if(!t)return;for(let s of Object.getOwnPropertyNames(t)){const l=t[s],c=r?r+s:s;Array.isArray(l)?i[c]=o.safeStringify(l):l instanceof Date?i[c]=l.toISOString():a.isObject(l)?n<2?e(l,i,n+1,c+"."):i[c]=o.safeStringify(l):i[c]=l}}(e,n);for(let e in n){const r=n[e=e.length>150?e.substr(e.length-149):e];"number"==typeof r?i[e]=r:"boolean"==typeof r?i[e]=r?1:0:"string"==typeof r?t[e]=r.substring(0,1023):null!=r&&(t[e]=r)}return{properties:t,measurements:i}},t.cleanRemoteAuthority=function(e){if(!e)return"none";let t="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(i=>{0===e.indexOf(`${i}+`)&&(t=i)}),t}})),define(e[111],t([0,1,121,17,51,7]),(function(e,t,r,s,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AppInsightsAppender=void 0;let l=class{constructor(e,t,i,n){this._eventPrefix=e,this._defaultData=t,this._logService=n,
this._defaultData||(this._defaultData=Object.create(null)),"string"==typeof i?this._aiClient=function(e){let t;return r.defaultClient?(t=new r.TelemetryClient(e)).channel.setUseDiskRetryCaching(!0):(r.setup(e).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setInternalLogging(!1,!1).setUseDiskRetryCaching(!0).start(),t=r.defaultClient),0===e.indexOf("AIF-")&&(t.config.endpointUrl="https://vortex.data.microsoft.com/collect/v1"),t}(i):"function"==typeof i&&(this._aiClient=i())}log(e,t){this._aiClient&&(t=s.mixin(t,this._defaultData),t=o.validateTelemetryData(t),this._logService&&this._logService.trace(`telemetry/${e}`,t),this._aiClient.trackEvent({name:this._eventPrefix+"/"+e,properties:t.properties,measurements:t.measurements}))}flush(){return this._aiClient?new Promise(e=>{this._aiClient.flush({callback:()=>{this._aiClient=void 0,e(void 0)}})}):Promise.resolve(void 0)}}
;l=i([n(3,a.ILogService)],l),t.AppInsightsAppender=l})),define(e[112],t([0,1,14,99,35,10]),(function(e,t,i,n,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveCommonProperties=void 0,t.resolveCommonProperties=async function(e,t,o,a,l,c){const u=Object.create(null);u["common.machineId"]=o,u.sessionID=r.generateUuid()+Date.now(),u.commitHash=e,u.version=t,u["common.platformVersion"]=(n.release()||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),u["common.platform"]=i.PlatformToString(i.platform),u["common.nodePlatform"]=process.platform,u["common.nodeArch"]=process.arch,u["common.product"]=c||"desktop";const d=function(e){if(!process||!process.env||!process.env.USERDNSDOMAIN)return!1;const t=process.env.USERDNSDOMAIN.toLowerCase();return e.some(e=>t===e)}(a||[]);d&&(u["common.msftInternal"]=d);let h=0;const f=Date.now();Object.defineProperties(u,{timestamp:{get:()=>new Date,enumerable:!0},"common.timesincesessionstart":{get:()=>Date.now()-f,enumerable:!0},"common.sequence":{
get:()=>h++,enumerable:!0}}),"linux"===process.platform&&process.env.SNAP&&process.env.SNAP_REVISION&&(u["common.snap"]="true");try{const e=await s.readFile(l,"utf8");u["common.source"]=e.slice(0,30)}catch(e){}return u}})),define(e[113],t([0,1,10,23,3]),(function(e,t,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildTelemetryMessage=void 0,t.buildTelemetryMessage=function(e,t){const s=Object.create(null),o=(e,t)=>{const i=JSON.parse(e);s[t]=i};if(t){const e=i.readdirSync(t).filter(e=>{try{return n.statSync(r.join(t,e)).isDirectory()}catch(e){return!1}}),s=[];e.forEach(e=>{1===i.readdirSync(r.join(t,e)).filter(e=>"telemetry.json"===e).length&&s.push(e)}),s.forEach(e=>{const i=n.readFileSync(r.join(t,e,"telemetry.json")).toString();o(i,e)})}let a=n.readFileSync(r.join(e,"telemetry-core.json")).toString();return o(a,"vscode-core"),a=n.readFileSync(r.join(e,"telemetry-extensions.json")).toString(),o(a,"vscode-extensions"),JSON.stringify(s,null,4)}})),
define(e[38],t([0,1,67,3,23,12,10,122,123,8]),(function(e,t,i,n,r,s,o,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buffer=t.extract=t.zip=t.ExtractError=void 0;class u extends Error{constructor(e,t){let i=t.message;switch(e){case"CorruptZip":i=`Corrupt ZIP: ${i}`}super(i),this.type=e,this.cause=t}}function d(e){if(e instanceof u)return e;let t=void 0;return/end of central directory record signature not found/.test(e.message)&&(t="CorruptZip"),new u(t,e)}function h(e,t,a,l){let c=s.createCancelablePromise(()=>Promise.resolve()),d=0;return l.onCancellationRequested(()=>{c.cancel(),e.close()}),new Promise((h,f)=>{const p=new s.Sequencer,m=t=>{t.isCancellationRequested||(d++,e.readEntry())};e.once("error",f),e.once("close",()=>c.then(()=>{l.isCancellationRequested||e.entryCount===d?h():f(new u("Incomplete",new Error(i.localize(1,null,d,e.entryCount))))},f)),e.readEntry(),e.on("entry",u=>{if(l.isCancellationRequested)return;if(!a.sourcePathRegex.test(u.fileName))return void m(l)
;const d=u.fileName.replace(a.sourcePathRegex,"");if(/\/$/.test(d)){const e=n.join(t,d);return void(c=s.createCancelablePromise(t=>o.mkdirp(e).then(()=>m(t)).then(void 0,f)))}const h=g(e,u),v=function(e){const t=e.externalFileAttributes>>16||33188;return[448,56,7].map(e=>t&e).reduce((e,t)=>e+t,61440&t)}(u);c=s.createCancelablePromise(e=>p.queue(()=>h.then(s=>(function(e,t,s,a,l,c){const u=n.dirname(t),d=n.join(a,u);if(0!==d.indexOf(a))return Promise.reject(new Error(i.localize(0,null,t)));const h=n.join(a,t);let f;return c.onCancellationRequested(()=>{f&&f.destroy()}),Promise.resolve(o.mkdirp(d)).then(()=>new Promise((t,i)=>{if(!c.isCancellationRequested)try{(f=r.createWriteStream(h,{mode:s})).once("close",()=>t()),f.once("error",i),e.once("error",i),e.pipe(f)}catch(e){i(e)}}))})(s,d,v,t,0,e).then(()=>m(e)))).then(null,f))})})}function f(e,t=!1){return new Promise((i,n)=>{a.open(e,t?{lazyEntries:!0}:void 0,(e,t)=>{e?n(d(e)):i(c.assertIsDefined(t))})})}function g(e,t){return new Promise((i,n)=>{
e.openReadStream(t,(e,t)=>{e?n(d(e)):i(c.assertIsDefined(t))})})}t.ExtractError=u,t.zip=function(e,t){return new Promise((i,n)=>{const s=new l.ZipFile;t.forEach(e=>{e.contents?s.addBuffer("string"==typeof e.contents?Buffer.from(e.contents,"utf8"):e.contents,e.path):e.localPath&&s.addFile(e.localPath,e.path)}),s.end();const o=r.createWriteStream(e);s.outputStream.pipe(o),s.outputStream.once("error",n),o.once("error",n),o.once("finish",()=>i(e))})},t.extract=function(e,t,i={},n){const r=new RegExp(i.sourcePath?`^${i.sourcePath}`:"");let s=f(e,!0);return i.overwrite&&(s=s.then(e=>o.rimraf(t).then(()=>e))),s.then(e=>h(e,t,{sourcePathRegex:r},n))},t.buffer=function(e,t){return function(e,t){return f(e).then(e=>new Promise((n,r)=>{e.on("entry",i=>{i.fileName===t&&g(e,i).then(e=>n(e),e=>r(e))}),e.once("close",()=>r(new Error(i.localize(2,null,t))))}))}(e,t).then(e=>new Promise((t,i)=>{const n=[];e.once("error",i),e.on("data",e=>n.push(e)),e.on("end",()=>t(Buffer.concat(n)))}))}})),
define(e[52],t([0,1,38,71]),(function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getManifest=void 0,t.getManifest=function(e){return i.buffer(e,"extension/package.json").then(e=>{try{return JSON.parse(e.toString("utf8"))}catch(e){throw new Error(n.localize(0,null))}})}})),define(e[114],t([0,1,48,2,10,3,7,24,25,12,13,19,79,72,36,38,14,18,9]),(function(e,t,r,s,o,a,l,c,u,d,h,f,g,p,m,v,y,S,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionsScanner=void 0;let w=class extends s.Disposable{constructor(e,t,i,n){super(),this.beforeRemovingExtension=e,this.logService=t,this.environmentService=i,this.productService=n,this._devSystemExtensionsPath=null,this.systemExtensionsPath=i.builtinExtensionsPath,this.extensionsPath=i.extensionsPath,this.uninstalledPath=a.join(this.extensionsPath,".obsolete"),this.uninstalledFileLimiter=new d.Queue}async cleanUp(){await this.removeUninstalledExtensions(),await this.removeOutdatedExtensions()}async scanExtensions(e){const t=[]
;null!==e&&0!==e||t.push(this.scanSystemExtensions().then(null,e=>Promise.reject(new c.ExtensionManagementError(this.joinErrors(e).message,"scanningSystem")))),null!==e&&1!==e||t.push(this.scanUserExtensions(!0).then(null,e=>Promise.reject(new c.ExtensionManagementError(this.joinErrors(e).message,"scanningUser"))));try{const e=await Promise.all(t);return S.flatten(e)}catch(e){throw this.joinErrors(e)}}async scanUserExtensions(e){this.logService.trace("Started scanning user extensions");let[t,i]=await Promise.all([this.getUninstalledExtensions(),this.scanAllUserExtensions()]);if(i=i.filter(e=>!t[new u.ExtensionIdentifierWithVersion(e.identifier,e.manifest.version).key()]),e){i=u.groupByExtension(i,e=>e.identifier).map(e=>e.sort((e,t)=>r.rcompare(e.manifest.version,t.manifest.version))[0])}return this.logService.trace("Scanned user extensions:",i.length),i}async scanAllUserExtensions(){return this.scanExtensionsInDir(this.extensionsPath,1)}async extractUserExtension(e,t,i){
const{identifier:n}=e,r=e.key(),s=a.join(this.extensionsPath,`.${r}`),l=a.join(this.extensionsPath,r);try{await o.rimraf(l)}catch(e){try{await o.rimraf(l)}catch(e){}throw new c.ExtensionManagementError(p.localize(0,null,l,n.id),"deleting")}await this.extractAtLocation(n,t,s,i);try{await this.rename(n,s,l,Date.now()+12e4),this.logService.info("Renamed to",l)}catch(e){this.logService.info("Rename failed. Deleting from extracted location",s);try{o.rimraf(s)}catch(e){}throw e}let u=null;try{u=await this.scanExtension(r,this.extensionsPath,1)}catch(e){}if(u)return u;throw new Error(p.localize(1,null,this.extensionsPath))}async saveMetadataForLocalExtension(e,t){this.setMetadata(e,t),t.isMachineScoped=t.isMachineScoped||void 0;const i=a.join(e.location.fsPath,"package.json"),n=await o.readFile(i,"utf8"),{manifest:r}=await this.parseManifest(n);return r.__metadata=t,await o.writeFile(i,JSON.stringify(r,null,"\t")),e}getUninstalledExtensions(){return this.withUninstalledExtensions(e=>e)}
async withUninstalledExtensions(e){return this.uninstalledFileLimiter.queue(async()=>{let t;try{t=await o.readFile(this.uninstalledPath,"utf8")}catch(e){if("ENOENT"!==e.code)throw e}let i={};if(t)try{i=JSON.parse(t)}catch(e){}const n=e(i);return Object.keys(i).length?await o.writeFile(this.uninstalledPath,JSON.stringify(i)):await o.rimraf(this.uninstalledPath),n})}async removeExtension(e,t){this.logService.trace(`Deleting ${t} extension from disk`,e.identifier.id,e.location.fsPath),await o.rimraf(e.location.fsPath),this.logService.info("Deleted from disk",e.identifier.id,e.location.fsPath)}async removeUninstalledExtension(e){await this.removeExtension(e,"uninstalled"),await this.withUninstalledExtensions(t=>delete t[new u.ExtensionIdentifierWithVersion(e.identifier,e.manifest.version).key()])}async extractAtLocation(e,t,i,n){this.logService.trace(`Started extracting the extension from ${t} to ${i}`);try{await o.rimraf(i)}catch(e){throw new c.ExtensionManagementError(this.joinErrors(e).message,"deleting")}try{
await v.extract(t,i,{sourcePath:"extension",overwrite:!0},n),this.logService.info(`Extracted extension to ${i}:`,e.id)}catch(e){try{await o.rimraf(i)}catch(e){}throw new c.ExtensionManagementError(e.message,e instanceof v.ExtractError&&e.type?e.type:"extracting")}}async rename(e,t,i,n){try{await o.rename(t,i)}catch(r){if(y.isWindows&&r&&"EPERM"===r.code&&Date.now()<n)return this.logService.info(`Failed renaming ${t} to ${i} with 'EPERM' error. Trying again...`,e.id),this.rename(e,t,i,n);throw new c.ExtensionManagementError(r.message||p.localize(2,null,t,i),r.code||"renaming")}}async scanSystemExtensions(){this.logService.trace("Started scanning system extensions");const e=this.scanDefaultSystemExtensions();if(this.environmentService.isBuilt)return e;const t=this.scanDevSystemExtensions(),[i,n]=await Promise.all([e,t]);return[...i,...n]}async scanExtensionsInDir(e,t){const i=new d.Limiter(10),n=await o.readdir(e)
;return(await Promise.all(n.map(n=>i.queue(()=>this.scanExtension(n,e,t))))).filter(e=>e&&e.identifier)}async scanExtension(e,t,i){if(1===i&&0===e.indexOf("."))return null;const n=a.join(t,e);try{const e=await o.readdir(n),{manifest:t,metadata:r}=await this.readManifest(n),s=e.filter(e=>/^readme(\.txt|\.md|)$/i.test(e))[0],l=s?h.URI.file(a.join(n,s)):void 0,c=e.filter(e=>/^changelog(\.txt|\.md|)$/i.test(e))[0],d=c?h.URI.file(a.join(n,c)):void 0,f={type:i,identifier:{id:u.getGalleryExtensionId(t.publisher,t.name)},manifest:t,location:h.URI.file(n),readmeUrl:l,changelogUrl:d,publisherDisplayName:null,publisherId:null,isMachineScoped:!1};return r&&this.setMetadata(f,r),f}catch(e){return this.logService.trace(e),null}}async scanDefaultSystemExtensions(){const e=await this.scanExtensionsInDir(this.systemExtensionsPath,0);return this.logService.trace("Scanned system extensions:",e.length),e}async scanDevSystemExtensions(){const e=this.getDevSystemExtensionsList();if(e.length){
const t=await this.scanExtensionsInDir(this.devSystemExtensionsPath,0);return this.logService.trace("Scanned dev system extensions:",t.length),t.filter(t=>e.some(e=>u.areSameExtensions(t.identifier,{id:e})))}return[]}setMetadata(e,t){e.publisherDisplayName=t.publisherDisplayName||null,e.publisherId=t.publisherId||null,e.identifier.uuid=t.id,e.isMachineScoped=!!t.isMachineScoped}async removeUninstalledExtensions(){const e=await this.getUninstalledExtensions(),t=await this.scanAllUserExtensions(),i=new Set;for(const n of t)e[new u.ExtensionIdentifierWithVersion(n.identifier,n.manifest.version).key()]||i.add(n.identifier.id.toLowerCase());const n=u.groupByExtension(t,e=>e.identifier);await Promise.all(n.map(async e=>{const t=e.sort((e,t)=>r.rcompare(e.manifest.version,t.manifest.version))[0];i.has(t.identifier.id.toLowerCase())||await this.beforeRemovingExtension(t)}));const s=t.filter(t=>e[new u.ExtensionIdentifierWithVersion(t.identifier,t.manifest.version).key()])
;await Promise.all(s.map(e=>this.removeUninstalledExtension(e)))}async removeOutdatedExtensions(){const e=await this.scanAllUserExtensions(),t=[],i=u.groupByExtension(e,e=>e.identifier);t.push(...S.flatten(i.map(e=>e.sort((e,t)=>r.rcompare(e.manifest.version,t.manifest.version)).slice(1)))),await Promise.all(t.map(e=>this.removeExtension(e,"outdated")))}getDevSystemExtensionsList(){return(this.productService.builtInExtensions||[]).map(e=>e.name)}joinErrors(e){const t=Array.isArray(e)?e:[e];return 1===t.length?t[0]instanceof Error?t[0]:new Error(t[0]):t.reduce((e,t)=>new Error(`${e.message}${e.message?",":""}${t instanceof Error?t.message:t}`),new Error(""))}get devSystemExtensionsPath(){return this._devSystemExtensionsPath||(this._devSystemExtensionsPath=a.normalize(a.join(E.FileAccess.asFileUri("",e).fsPath,"..",".build","builtInExtensions"))),this._devSystemExtensionsPath}async readManifest(e){
const t=[o.readFile(a.join(e,"package.json"),"utf8").then(e=>this.parseManifest(e)),o.readFile(a.join(e,"package.nls.json"),"utf8").then(void 0,e=>"ENOENT"!==e.code?Promise.reject(e):"{}").then(e=>JSON.parse(e))],[{manifest:i,metadata:n},r]=await Promise.all(t);return{manifest:g.localizeManifest(i,r),metadata:n}}parseManifest(e){return new Promise((t,i)=>{try{const i=JSON.parse(e),n=i.__metadata||null;delete i.__metadata,t({manifest:i,metadata:n})}catch(e){i(new Error(p.localize(3,null)))}})}};w=i([n(1,l.ILogService),n(2,f.INativeEnvironmentService),n(3,m.IProductService)],w),t.ExtensionsScanner=w})),define(e[115],t([0,1,70,3,10,2,18,38,24,25,19,12,11,48,13,49,14,7,86,32,37,43,21,35,85,4,9,28,52,90,114,91]),(function(e,t,r,s,o,a,l,c,u,d,h,f,g,p,m,v,y,S,E,w,b,C,x,P,_,I,D,O,L,R,F,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionManagementService=void 0;let T=class extends a.Disposable{constructor(e,t,i,n,r,s){super(),this.environmentService=e,this.galleryService=t,this.logService=i,
this.downloadService=n,this.telemetryService=r,this.lastReportTimestamp=0,this.installingExtensions=new Map,this.uninstallingExtensions=new Map,this._onInstallExtension=this._register(new g.Emitter),this.onInstallExtension=this._onInstallExtension.event,this._onDidInstallExtension=this._register(new g.Emitter),this.onDidInstallExtension=this._onDidInstallExtension.event,this._onUninstallExtension=this._register(new g.Emitter),this.onUninstallExtension=this._onUninstallExtension.event,this._onDidUninstallExtension=this._register(new g.Emitter),this.onDidUninstallExtension=this._onDidUninstallExtension.event;const o=this._register(s.createInstance(k.ExtensionsLifecycle));this.extensionsScanner=this._register(s.createInstance(F.ExtensionsScanner,e=>o.postUninstall(e))),this.manifestCache=this._register(new E.ExtensionsManifestCache(e,this)),this.extensionsDownloader=this._register(s.createInstance(R.ExtensionsDownloader)),this._register(a.toDisposable(()=>{this.installingExtensions.forEach(e=>e.cancel()),
this.uninstallingExtensions.forEach(e=>e.cancel()),this.installingExtensions.clear(),this.uninstallingExtensions.clear()}))}async zip(e){this.logService.trace("ExtensionManagementService#zip",e.identifier.id);const t=await this.collectFiles(e),i=await c.zip(x.joinPath(this.environmentService.tmpDir,P.generateUuid()).fsPath,t);return m.URI.file(i)}async unzip(e){return this.logService.trace("ExtensionManagementService#unzip",e.toString()),(await this.install(e)).identifier}async getManifest(e){const t=await this.downloadVsix(e),i=s.resolve(t.fsPath);return L.getManifest(i)}async collectFiles(e){const t=async e=>{let i=await o.readdir(e);i=i.map(t=>s.join(e,t));const n=await Promise.all(i.map(e=>o.stat(e)));let r=Promise.resolve([]);return n.forEach((e,n)=>{const s=i[n];e.isFile()&&(r=r.then(e=>[...e,s])),e.isDirectory()&&(r=r.then(e=>t(s).then(t=>[...e,...t])))}),r};return(await t(e.location.fsPath)).map(t=>({path:`extension/${s.relative(e.location.fsPath,t)}`,localPath:t}))}async install(e,t){
return this.logService.trace("ExtensionManagementService#install",e.toString()),f.createCancelablePromise(async i=>{const n=await this.downloadVsix(e),o=s.resolve(n.fsPath),a=await L.getManifest(o),l={id:d.getGalleryExtensionId(a.publisher,a.name)};let c=1;if(a.engines&&a.engines.vscode&&!C.isEngineValid(a.engines.vscode,v.default.version))throw new Error(r.localize(0,null,l.id,v.default.version));const u=new d.ExtensionIdentifierWithVersion(l,a.version),h=(await this.getInstalled(1)).find(e=>d.areSameExtensions(l,e.identifier));if(h)if(t=t||h.isMachineScoped,c=2,u.equals(new d.ExtensionIdentifierWithVersion(h.identifier,h.manifest.version)))try{await this.extensionsScanner.removeExtension(h,"existing")}catch(e){throw new Error(r.localize(1,null,a.displayName||a.name))}else p.gt(h.manifest.version,a.version)&&await this.uninstallExtension(h);else{const e=await this.unsetUninstalledAndGetLocal(u);if(e)try{await this.extensionsScanner.removeExtension(e,"existing")}catch(e){
throw new Error(r.localize(2,null,a.displayName||a.name))}}let f;this.logService.info("Installing the extension:",l.id),this._onInstallExtension.fire({identifier:l,zipPath:o});try{f=await this.getGalleryMetadata(d.getGalleryExtensionId(a.publisher,a.name))}catch(e){}try{const e=await this.installFromZipPath(u,o,t?Object.assign(Object.assign({},f||{}),{isMachineScoped:t}):f,c,i);return this.logService.info("Successfully installed the extension:",l.id),e}catch(e){throw this.logService.error("Failed to install the extension:",l.id,e.message),e}})}async downloadVsix(e){if(e.scheme===D.Schemas.file)return e;if(!this.downloadService)throw new Error("Download service is not available");const t=x.joinPath(this.environmentService.tmpDir,P.generateUuid());return await this.downloadService.download(e,t),t}async installFromZipPath(e,t,i,n,r){try{const s=await this.installExtension({zipPath:t,identifierWithVersion:e,metadata:i},r);try{await this.installDependenciesAndPackExtensions(s,void 0)}catch(e){
l.isNonEmptyArray(s.manifest.extensionDependencies)&&this.logService.warn("Cannot install dependencies of extension:",s.identifier.id,e.message),l.isNonEmptyArray(s.manifest.extensionPack)&&this.logService.warn("Cannot install packed extensions of extension:",s.identifier.id,e.message)}return this._onDidInstallExtension.fire({identifier:e.identifier,zipPath:t,local:s,operation:n}),s}catch(i){throw this._onDidInstallExtension.fire({identifier:e.identifier,zipPath:t,operation:n,error:i}),i}}async canInstall(e){return!0}async installFromGallery(e,t){if(!this.galleryService.isEnabled())throw new Error(r.localize(3,null));try{e=await this.checkAndGetCompatibleVersion(e)}catch(t){const i=t&&t.code?t.code:"unknown";throw this.logService.error("Failed to install extension:",e.identifier.id,t?t.message:i),this.reportTelemetry(this.getTelemetryEvent(1),d.getGalleryExtensionTelemetryData(e),void 0,t),t instanceof Error&&(t.name=i),t}const i=new d.ExtensionIdentifierWithVersion(e.identifier,e.version).key()
;let n=this.installingExtensions.get(i);return n||(n=f.createCancelablePromise(i=>this.doInstallFromGallery(e,!!t,i)),this.installingExtensions.set(i,n),n.finally(()=>this.installingExtensions.delete(i))),n}async doInstallFromGallery(e,t,i){const n=(new Date).getTime();let r=1;this.logService.info("Installing extension:",e.identifier.id),this._onInstallExtension.fire({identifier:e.identifier,gallery:e});try{const s=(await this.getInstalled(1)).find(t=>d.areSameExtensions(t.identifier,e.identifier));s&&(r=2);const o=await this.downloadInstallableExtension(e,r);o.metadata.isMachineScoped=t||(null==s?void 0:s.isMachineScoped);const a=await this.installExtension(o,i);try{await this.extensionsDownloader.delete(m.URI.file(o.zipPath))}catch(e){}try{await this.installDependenciesAndPackExtensions(a,s)}catch(e){try{await this.uninstall(a)}catch(e){}throw e}return s&&p.neq(s.manifest.version,e.version)&&await this.setUninstalled(s),this.logService.info("Extensions installed successfully:",e.identifier.id),
this._onDidInstallExtension.fire({identifier:e.identifier,gallery:e,local:a,operation:r}),this.reportTelemetry(this.getTelemetryEvent(r),d.getGalleryExtensionTelemetryData(e),(new Date).getTime()-n,void 0),a}catch(t){const i=t&&t.code?t.code:"unknown";throw this.logService.error("Failed to install extension:",e.identifier.id,t?t.message:i),this._onDidInstallExtension.fire({identifier:e.identifier,gallery:e,operation:r,error:i}),this.reportTelemetry(this.getTelemetryEvent(r),d.getGalleryExtensionTelemetryData(e),(new Date).getTime()-n,t),t instanceof Error&&(t.name=i),t}}async checkAndGetCompatibleVersion(e){if(await this.isMalicious(e))throw new u.ExtensionManagementError(r.localize(4,null),u.INSTALL_ERROR_MALICIOUS);const t=await this.galleryService.getCompatibleExtension(e);if(!t)throw new u.ExtensionManagementError(r.localize(5,null,e.identifier.id,v.default.version),u.INSTALL_ERROR_INCOMPATIBLE);return t}async reinstallFromGallery(e){
if(this.logService.trace("ExtensionManagementService#reinstallFromGallery",e.identifier.id),!this.galleryService.isEnabled())throw new Error(r.localize(6,null));const t=await this.findGalleryExtension(e);if(!t)throw new Error(r.localize(7,null));await this.setUninstalled(e);try{await this.extensionsScanner.removeUninstalledExtension(e)}catch(e){throw new Error(r.localize(8,null,w.toErrorMessage(e)))}await this.installFromGallery(t)}getTelemetryEvent(e){return 2===e?"extensionGallery:update":"extensionGallery:install"}async isMalicious(e){const t=await this.getExtensionsReport();return d.getMaliciousExtensionsSet(t).has(e.identifier.id)}async downloadInstallableExtension(e,t){const i={id:e.identifier.uuid,publisherId:e.publisherId,publisherDisplayName:e.publisherDisplayName};let n;try{this.logService.trace("Started downloading extension:",e.identifier.id);const i=await this.extensionsDownloader.downloadExtension(e,t);this.logService.info("Downloaded extension:",e.identifier.id,n),n=i.fsPath}catch(e){
throw new u.ExtensionManagementError(this.joinErrors(e).message,"downloading")}try{const t=await L.getManifest(n);return{zipPath:n,identifierWithVersion:new d.ExtensionIdentifierWithVersion(e.identifier,t.version),metadata:i}}catch(e){throw new u.ExtensionManagementError(this.joinErrors(e).message,"validating")}}async installExtension(e,t){try{const t=await this.unsetUninstalledAndGetLocal(e.identifierWithVersion);if(t)return t}catch(e){throw y.isMacintosh?new u.ExtensionManagementError(r.localize(9,null),"unsetUninstalled"):new u.ExtensionManagementError(r.localize(10,null),"unsetUninstalled")}return this.extractAndInstall(e,t)}async unsetUninstalledAndGetLocal(e){return await this.isUninstalled(e)?(this.logService.trace("Removing the extension from uninstalled list:",e.identifier.id),await this.unsetUninstalled(e),this.logService.info("Removed the extension from uninstalled list:",e.identifier.id),
(await this.getInstalled(1)).find(t=>new d.ExtensionIdentifierWithVersion(t.identifier,t.manifest.version).equals(e))||null):null}async extractAndInstall({zipPath:e,identifierWithVersion:t,metadata:i},n){const{identifier:r}=t;let s=await this.extensionsScanner.extractUserExtension(t,e,n);return this.logService.info("Installation completed.",r.id),i&&(s=await this.extensionsScanner.saveMetadataForLocalExtension(s,i)),s}async installDependenciesAndPackExtensions(e,t){if(!this.galleryService.isEnabled())return;const i=e.manifest.extensionDependencies||[];if(e.manifest.extensionPack)for(const n of e.manifest.extensionPack)t&&t.manifest.extensionPack&&t.manifest.extensionPack.some(e=>d.areSameExtensions({id:e},{id:n}))||i.every(e=>!d.areSameExtensions({id:e},{id:n}))&&i.push(n);if(i.length){const e=await this.getInstalled(),t=i.filter(t=>e.every(({identifier:e})=>!d.areSameExtensions(e,{id:t})));if(t.length){const e=(await this.galleryService.query({names:t,pageSize:i.length},O.CancellationToken.None)).firstPage
;try{await Promise.all(e.map(e=>this.installFromGallery(e)))}catch(t){try{await this.rollback(e)}catch(e){}throw t}}}}async rollback(e){const t=(await this.getInstalled(1)).filter(t=>e.some(e=>new d.ExtensionIdentifierWithVersion(t.identifier,t.manifest.version).equals(new d.ExtensionIdentifierWithVersion(e.identifier,e.version))));await Promise.all(t.map(e=>this.uninstall(e)))}async uninstall(e){this.logService.trace("ExtensionManagementService#uninstall",e.identifier.id);const t=await this.getInstalled(1),i=t.find(t=>d.areSameExtensions(t.identifier,e.identifier));if(!i)throw new Error(r.localize(11,null,e.manifest.displayName||e.manifest.name));try{await this.checkForDependenciesAndUninstall(i,t)}catch(e){throw this.joinErrors(e)}}async updateMetadata(e,t){return this.logService.trace("ExtensionManagementService#updateMetadata",e.identifier.id),e=await this.extensionsScanner.saveMetadataForLocalExtension(e,Object.assign(Object.assign({},t),{isMachineScoped:e.isMachineScoped})),
this.manifestCache.invalidate(),e}async getGalleryMetadata(e){const t=await this.findGalleryExtensionByName(e);return t?{id:t.identifier.uuid,publisherDisplayName:t.publisherDisplayName,publisherId:t.publisherId}:void 0}async findGalleryExtension(e){if(e.identifier.uuid){const t=await this.findGalleryExtensionById(e.identifier.uuid);return t||this.findGalleryExtensionByName(e.identifier.id)}return this.findGalleryExtensionByName(e.identifier.id)}async findGalleryExtensionById(e){return(await this.galleryService.query({ids:[e],pageSize:1},O.CancellationToken.None)).firstPage[0]}async findGalleryExtensionByName(e){return(await this.galleryService.query({names:[e],pageSize:1},O.CancellationToken.None)).firstPage[0]}joinErrors(e){const t=Array.isArray(e)?e:[e];return 1===t.length?t[0]instanceof Error?t[0]:new Error(t[0]):t.reduce((e,t)=>new Error(`${e.message}${e.message?",":""}${t instanceof Error?t.message:t}`),new Error(""))}async checkForDependenciesAndUninstall(e,t){try{await this.preUninstallExtension(e)
;const i=this.getAllPackExtensionsToUninstall(e,t);i.length?await this.uninstallExtensions(e,i,t):await this.uninstallExtensions(e,[],t)}catch(t){throw await this.postUninstallExtension(e,new u.ExtensionManagementError(t instanceof Error?t.message:t,"local")),t}await this.postUninstallExtension(e)}async uninstallExtensions(e,t,i){const n=[e,...t];for(const t of n)this.checkForDependents(t,n,i,e);await Promise.all([this.uninstallExtension(e),...t.map(e=>this.doUninstall(e))])}checkForDependents(e,t,i,n){const r=this.getDependents(e,i);if(r.length){const i=r.filter(e=>-1===t.indexOf(e));if(i.length)throw new Error(this.getDependentsErrorMessage(e,i,n))}}getDependentsErrorMessage(e,t,i){
return i===e?1===t.length?r.localize(12,null,i.manifest.displayName||i.manifest.name,t[0].manifest.displayName||t[0].manifest.name):2===t.length?r.localize(13,null,i.manifest.displayName||i.manifest.name,t[0].manifest.displayName||t[0].manifest.name,t[1].manifest.displayName||t[1].manifest.name):r.localize(14,null,i.manifest.displayName||i.manifest.name,t[0].manifest.displayName||t[0].manifest.name,t[1].manifest.displayName||t[1].manifest.name):1===t.length?r.localize(15,null,i.manifest.displayName||i.manifest.name,e.manifest.displayName||e.manifest.name,t[0].manifest.displayName||t[0].manifest.name):2===t.length?r.localize(16,null,i.manifest.displayName||i.manifest.name,e.manifest.displayName||e.manifest.name,t[0].manifest.displayName||t[0].manifest.name,t[1].manifest.displayName||t[1].manifest.name):r.localize(17,null,i.manifest.displayName||i.manifest.name,e.manifest.displayName||e.manifest.name,t[0].manifest.displayName||t[0].manifest.name,t[1].manifest.displayName||t[1].manifest.name)}
getAllPackExtensionsToUninstall(e,t,i=[]){if(-1!==i.indexOf(e))return[];i.push(e);const n=e.manifest.extensionPack?e.manifest.extensionPack:[];if(n.length){const e=t.filter(e=>n.some(t=>d.areSameExtensions({id:t},e.identifier))),r=[];for(const n of e)r.push(...this.getAllPackExtensionsToUninstall(n,t,i));return[...e,...r]}return[]}getDependents(e,t){return t.filter(t=>t.manifest.extensionDependencies&&t.manifest.extensionDependencies.some(t=>d.areSameExtensions({id:t},e.identifier)))}async doUninstall(e){try{await this.preUninstallExtension(e),await this.uninstallExtension(e)}catch(t){throw await this.postUninstallExtension(e,new u.ExtensionManagementError(t instanceof Error?t.message:t,"local")),t}await this.postUninstallExtension(e)}async preUninstallExtension(e){if(!await o.exists(e.location.fsPath))throw new Error(r.localize(18,null));this.logService.info("Uninstalling extension:",e.identifier.id),this._onUninstallExtension.fire(e.identifier)}async uninstallExtension(e){
let t=this.uninstallingExtensions.get(e.identifier.id);return t||(t=f.createCancelablePromise(async()=>{const t=await this.extensionsScanner.scanUserExtensions(!1);await this.setUninstalled(...t.filter(t=>d.areSameExtensions(t.identifier,e.identifier)))}),this.uninstallingExtensions.set(e.identifier.id,t),t.finally(()=>this.uninstallingExtensions.delete(e.identifier.id))),t}async postUninstallExtension(e,t){if(t)this.logService.error("Failed to uninstall extension:",e.identifier.id,t.message);else if(this.logService.info("Successfully uninstalled extension:",e.identifier.id),e.identifier.uuid)try{await this.galleryService.reportStatistic(e.manifest.publisher,e.manifest.name,e.manifest.version,"uninstall")}catch(t){}this.reportTelemetry("extensionGallery:uninstall",d.getLocalExtensionTelemetryData(e),void 0,t);const i=t?t instanceof u.ExtensionManagementError?t.code:"unknown":void 0;this._onDidUninstallExtension.fire({identifier:e.identifier,error:i})}getInstalled(e=null){
return this.extensionsScanner.scanExtensions(e)}removeDeprecatedExtensions(){return this.extensionsScanner.cleanUp()}async isUninstalled(e){return 1===(await this.filterUninstalled(e)).length}filterUninstalled(...e){return this.extensionsScanner.withUninstalledExtensions(t=>{const i=[];for(const n of e)t[n.key()]&&i.push(n.key());return i})}setUninstalled(...e){const t=e.map(e=>new d.ExtensionIdentifierWithVersion(e.identifier,e.manifest.version));return this.extensionsScanner.withUninstalledExtensions(e=>(t.forEach(t=>e[t.key()]=!0),e))}unsetUninstalled(e){return this.extensionsScanner.withUninstalledExtensions(t=>delete t[e.key()])}getExtensionsReport(){const e=(new Date).getTime();return(!this.reportedExtensions||e-this.lastReportTimestamp>3e5)&&(this.reportedExtensions=this.updateReportCache(),this.lastReportTimestamp=e),this.reportedExtensions}async updateReportCache(){try{this.logService.trace("ExtensionManagementService.refreshReportedCache");const e=await this.galleryService.getExtensionsReport()
;return this.logService.trace(`ExtensionManagementService.refreshReportedCache - got ${e.length} reported extensions from service`),e}catch(e){return this.logService.trace("ExtensionManagementService.refreshReportedCache - failed to get extension report"),[]}}reportTelemetry(e,t,i,n){const r=n?n instanceof u.ExtensionManagementError?n.code:"unknown":void 0;this.telemetryService.publicLogError(e,Object.assign(Object.assign({},t),{success:!n,duration:i,errorcode:r}))}};T=i([n(0,h.INativeEnvironmentService),n(1,u.IExtensionGalleryService),n(2,S.ILogService),n(3,I.optional(_.IDownloadService)),n(4,b.ITelemetryService),n(5,I.IInstantiationService)],T),t.ExtensionManagementService=T})),define(e[116],t([0,1,124,104,2,8,20,103,27,7,15]),(function(e,t,r,s,o,a,l,c,u,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequestService=void 0;let f=class extends o.Disposable{constructor(e,t){super(),this.logService=t,this.configure(e.getValue()),
this._register(e.onDidChangeConfiguration(()=>this.configure(e.getValue()),this))}configure(e){this.proxyUrl=e.http&&e.http.proxy,this.strictSSL=!(!e.http||!e.http.proxyStrictSSL),this.authorization=e.http&&e.http.proxyAuthorization}async request(e,t){this.logService.trace("RequestService#request",e.url);const{proxyUrl:i,strictSSL:n}=this,r=e.agent?e.agent:await c.getProxyAgent(e.url||"",{proxyUrl:i,strictSSL:n});return e.agent=r,e.strictSSL=n,this.authorization&&(e.headers=Object.assign(Object.assign({},e.headers||{}),{"Proxy-Authorization":this.authorization})),this._request(e,t)}async getNodeRequest(t){return("https:"===s.parse(t.url).protocol?await new Promise((t,i)=>{e(["https"],t,i)}):await new Promise((t,i)=>{e(["http"],t,i)})).request}_request(e,t){return new Promise(async(i,n)=>{let o;const c=s.parse(e.url),u=e.getRawRequest?e.getRawRequest(e):await this.getNodeRequest(e),d={hostname:c.hostname,port:c.port?parseInt(c.port):"https:"===c.protocol?443:80,protocol:c.protocol,path:c.path,
method:e.type||"GET",headers:e.headers,agent:e.agent,rejectUnauthorized:!a.isBoolean(e.strictSSL)||e.strictSSL};e.user&&e.password&&(d.auth=e.user+":"+e.password),(o=u(d,s=>{const o=a.isNumber(e.followRedirects)?e.followRedirects:3;if(s.statusCode&&s.statusCode>=300&&s.statusCode<400&&o>0&&s.headers.location)this._request(Object.assign(Object.assign({},e),{url:s.headers.location,followRedirects:o-1}),t).then(i,n);else{let e=s;"gzip"===s.headers["content-encoding"]&&(e=s.pipe(r.createGunzip())),i({res:s,stream:h.streamToBufferReadableStream(e)})}})).on("error",n),e.timeout&&o.setTimeout(e.timeout),e.data&&"string"==typeof e.data&&o.write(e.data),o.end(),t.onCancellationRequested(()=>{o.abort(),n(l.canceled())})})}async resolveProxy(e){}};f=i([n(0,u.IConfigurationService),n(1,d.ILogService)],f),t.RequestService=f})),
define(e[125],t([0,1,5,12,49,3,47,44,4,88,19,98,24,115,109,37,51,110,112,50,116,27,102,111,10,39,106,107,7,20,25,13,52,34,28,95,9,97,113,92,26,94,2,36]),(function(e,t,r,s,o,a,l,c,u,d,h,f,g,p,m,v,y,S,E,w,b,C,x,P,_,I,D,O,L,R,F,k,T,A,M,U,j,N,z,V,B,W,$,q){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.main=t.Main=t.getIdAndVersion=void 0;const G=e=>r.localize(1,null,e),H=r.localize(2,null,"ms-dotnettools.csharp");function K(e,t){return t?`${e.publisher}.${e.name}@${e.version}`:`${e.publisher}.${e.name}`}const J=/^([^.]+\..+)@(\d+\.\d+\.\d+(-.*)?)$/;function X(e){const t=J.exec(e);return t&&t[1]?[F.adoptToGalleryExtensionId(t[1]),t[2]]:[F.adoptToGalleryExtensionId(e),void 0]}t.getIdAndVersion=X;let Q=class{constructor(e,t,i,n){this.instantiationService=e,this.environmentService=t,this.extensionManagementService=i,this.extensionGalleryService=n}async run(e){
e["install-source"]?await this.setInstallSource(e["install-source"]):e["list-extensions"]?await this.listExtensions(!!e["show-versions"],e.category):e["install-extension"]?await this.installExtensions(e["install-extension"],!!e.force):e["uninstall-extension"]?await this.uninstallExtension(e["uninstall-extension"]):e["locate-extension"]?await this.locateExtension(e["locate-extension"]):e.telemetry&&console.log(z.buildTelemetryMessage(this.environmentService.appRoot,this.environmentService.extensionsPath?this.environmentService.extensionsPath:void 0))}setInstallSource(e){return _.writeFile(this.environmentService.installSourcePath,e.slice(0,30))}async listExtensions(e,t){let i=await this.extensionManagementService.getInstalled(1);const n=A.EXTENSION_CATEGORIES.map(e=>e.toLowerCase());if(t&&""!==t){if(n.indexOf(t.toLowerCase())<0)return void console.log("Invalid category please enter a valid category. To list valid categories run --category without a category specified");i=i.filter(e=>{if(e.manifest.categories){
return e.manifest.categories.map(e=>e.toLowerCase()).indexOf(t.toLowerCase())>-1}return!1})}else if(""===t)return console.log("Possible Categories: "),void n.forEach(e=>{console.log(e)});i.forEach(t=>console.log(K(t.manifest,e)))}async installExtensions(e,t){const i=[],n=[];e.length&&console.log(r.localize(3,null));for(const r of e)try{const e=await this.installExtension(r,t);e&&n.push(e)}catch(e){console.error(e.message||e.stack||e),i.push(r)}return n.some(e=>A.isLanguagePackExtension(e))&&await this.updateLocalizationsCache(),i.length?Promise.reject(r.localize(4,null,i.join(", "))):Promise.resolve()}async installExtension(e,t){if(/\.vsix$/i.test(e)){e=a.isAbsolute(e)?e:a.join(process.cwd(),e);const i=await T.getManifest(e);return await this.validate(i,t)?this.extensionManagementService.install(k.URI.file(e)).then(t=>(console.log(r.localize(5,null,I.getBaseLabel(e))),i),t=>R.isPromiseCanceledError(t)?(console.log(r.localize(6,null,I.getBaseLabel(e))),null):Promise.reject(t)):null}const[i,n]=X(e)
;return this.extensionManagementService.getInstalled(1).then(e=>this.extensionGalleryService.getCompatibleExtension({id:i},n).then(null,e=>{if(e.responseText)try{const t=JSON.parse(e.responseText);return Promise.reject(t.message)}catch(e){}return Promise.reject(e)}).then(async s=>{if(!s)return Promise.reject(new Error(`${(e=>r.localize(0,null,e))(n?`${i}@${n}`:i)}\n${H}`));const o=await this.extensionGalleryService.getManifest(s,M.CancellationToken.None),[a]=e.filter(e=>F.areSameExtensions(e.identifier,{id:i}));if(a){if(s.version===a.manifest.version)return console.log(r.localize(7,null,n?`${i}@${n}`:i)),Promise.resolve(null);if(!n&&!t)return console.log(r.localize(8,null,i,a.manifest.version,s.version)),Promise.resolve(null);console.log(r.localize(9,null,i,s.version))}return await this.installFromGallery(i,s),o}))}async validate(t,i){if(!t)throw new Error("Invalid vsix");const n=await new Promise((t,i)=>{e(["semver-umd"],t,i)}),s={id:F.getGalleryExtensionId(t.publisher,t.name)
},o=(await this.extensionManagementService.getInstalled(1)).find(e=>F.areSameExtensions(s,e.identifier)&&n.gt(e.manifest.version,t.version));return!(o&&!i)||(console.log(r.localize(10,null,o.identifier.id,o.manifest.version,t.version)),!1)}async installFromGallery(e,t){console.log(r.localize(11,null,e,t.version));try{await this.extensionManagementService.installFromGallery(t),console.log(r.localize(12,null,e,t.version))}catch(t){if(!R.isPromiseCanceledError(t))throw t;console.log(r.localize(13,null,e))}}async uninstallExtension(e){async function t(e){if(!/\.vsix$/i.test(e))return e;const t=a.isAbsolute(e)?e:a.join(process.cwd(),e);return K(await T.getManifest(t))}const i=[];for(const n of e){const e=await t(n),s=await this.extensionManagementService.getInstalled(1),[o]=s.filter(t=>F.areSameExtensions(t.identifier,{id:e}));if(!o)return Promise.reject(new Error(`${G(e)}\n${H}`));console.log(r.localize(14,null,e)),await this.extensionManagementService.uninstall(o,!0),i.push(o),console.log(r.localize(15,null,e))}
i.some(e=>A.isLanguagePackExtension(e.manifest))&&await this.updateLocalizationsCache()}async locateExtension(e){const t=await this.extensionManagementService.getInstalled();e.forEach(e=>{t.forEach(t=>{t.identifier.id!==e||t.location.scheme!==j.Schemas.file||console.log(t.location.fsPath)})})}async updateLocalizationsCache(){const e=this.instantiationService.createInstance(U.LocalizationsService);await e.update(),e.dispose()}};Q=i([n(0,u.IInstantiationService),n(1,h.INativeEnvironmentService),n(2,g.IExtensionManagementService),n(3,g.IExtensionGalleryService)],Q),t.Main=Q;const Y="monacoworkbench";t.main=async function(e){const t=new l.ServiceCollection,i=new $.DisposableStore,n=new f.NativeEnvironmentService(e),r=new N.SpdLogService("cli",n.logsPath,L.getLogLevel(n));process.once("exit",()=>r.dispose()),r.info("main",e),await Promise.all([n.appSettingsHome.fsPath,n.extensionsPath].map(e=>e?_.mkdirp(e):void 0));const a=new V.FileService(r);i.add(a),t.set(B.IFileService,a)
;const u=new W.DiskFileSystemProvider(r);i.add(u),a.registerProvider(j.Schemas.file,u);const I=new x.ConfigurationService(n.settingsResource,a);i.add(I),await I.initialize(),t.set(h.IEnvironmentService,n),t.set(h.INativeEnvironmentService,n),t.set(L.ILogService,r),t.set(C.IConfigurationService,I),t.set(D.IStateService,new c.SyncDescriptor(O.StateService)),t.set(q.IProductService,Object.assign({_serviceBrand:void 0},o.default));const R=new d.InstantiationService(t);return R.invokeFunction(async t=>{const a=t.get(D.IStateService),{appRoot:u,extensionsPath:d,extensionDevelopmentLocationURI:h,isBuilt:f,installSourcePath:C}=n,x=new l.ServiceCollection;x.set(w.IRequestService,new c.SyncDescriptor(b.RequestService)),x.set(g.IExtensionManagementService,new c.SyncDescriptor(p.ExtensionManagementService)),x.set(g.IExtensionGalleryService,new c.SyncDescriptor(m.ExtensionGalleryService));const _=[];if(f&&!h&&!n.disableTelemetry&&o.default.enableTelemetry){
o.default.aiConfig&&o.default.aiConfig.asimovKey&&_.push(new P.AppInsightsAppender(Y,null,o.default.aiConfig.asimovKey,r));const e={appender:y.combinedAppender(..._),sendErrorTelemetry:!1,commonProperties:E.resolveCommonProperties(o.default.commit,o.default.version,a.getItem("telemetry.machineId"),o.default.msftInternalDomains,C),piiPaths:d?[u,d]:[u]};x.set(v.ITelemetryService,new c.SyncDescriptor(S.TelemetryService,[e]))}else x.set(v.ITelemetryService,y.NullTelemetryService);const I=R.createChild(x).createInstance(Q);try{await I.run(e),await s.raceTimeout(y.combinedAppender(..._).flush(),1e3)}finally{i.dispose()}})}}))}).call(this);
//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/93c2f0fbf16c5a4b10e4d5f89737d9c2c25488a3/core/vs/code/node/cliProcessMain.js.map
